/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/ScrollBar","sap/ui/core/ResizeHandler","sap/ui/core/delegate/ScrollEnablement","sap/ui/Device","sap/f/DynamicPageTitle","./DynamicPageRenderer"],function(e,t,i,r,a,s,o,n,l){"use strict";var h=i.extend("sap.f.DynamicPage",{metadata:{library:"sap.f",properties:{preserveHeaderStateOnScroll:{type:"boolean",group:"Behavior",defaultValue:false},headerExpanded:{type:"boolean",group:"Behavior",defaultValue:true},toggleHeaderOnTitleClick:{type:"boolean",group:"Behavior",defaultValue:true},showFooter:{type:"boolean",group:"Behavior",defaultValue:false},fitContent:{type:"boolean",group:"Behavior",defaultValue:false}},aggregations:{title:{type:"sap.f.DynamicPageTitle",multiple:false},header:{type:"sap.f.DynamicPageHeader",multiple:false},content:{type:"sap.ui.core.Control",multiple:false},footer:{type:"sap.m.IBar",multiple:false},_scrollBar:{type:"sap.ui.core.ScrollBar",multiple:false,visibility:"hidden"}},designtime:"sap/f/designtime/DynamicPage.designtime"}});function d(e){if(arguments.length===1){return e&&"length"in e?e.length>0:!!e}return Array.prototype.slice.call(arguments).every(function(e){return d(e)})}function p(e){var t;if(!e){return false}t=e.getBoundingClientRect();return!!(t.width&&t.height)}var g=sap.ui.getCore().getConfiguration().getAnimation();h.HEADER_MAX_ALLOWED_PINNED_PERCENTAGE=.6;h.HEADER_MAX_ALLOWED_NON_SROLLABLE_PERCENTAGE=.6;h.HEADER_MAX_ALLOWED_NON_SROLLABLE_ON_MOBILE=.3;h.FOOTER_ANIMATION_DURATION=350;h.BREAK_POINTS={TABLET:1024,PHONE:600};h.EVENTS={TITLE_PRESS:"_titlePress",TITLE_MOUSE_OVER:"_titleMouseOver",TITLE_MOUSE_OUT:"_titleMouseOut",PIN_UNPIN_PRESS:"_pinUnpinPress",VISUAL_INDICATOR_MOUSE_OVER:"_visualIndicatorMouseOver",VISUAL_INDICATOR_MOUSE_OUT:"_visualIndicatorMouseOut",HEADER_VISUAL_INDICATOR_PRESS:"_headerVisualIndicatorPress",TITLE_VISUAL_INDICATOR_PRESS:"_titleVisualIndicatorPress"};h.MEDIA={INVISIBLE:"sapUiHidden",PHONE:"sapFDynamicPage-Std-Phone",TABLET:"sapFDynamicPage-Std-Tablet",DESKTOP:"sapFDynamicPage-Std-Desktop"};h.RESIZE_HANDLER_ID={PAGE:"_sResizeHandlerId",TITLE:"_sTitleResizeHandlerId",CONTENT:"_sContentResizeHandlerId"};h.prototype.init=function(){this._bPinned=false;this._bHeaderInTitleArea=false;this._bExpandingWithAClick=false;this._bSuppressToggleHeaderOnce=false;this._headerBiggerThanAllowedHeight=false;this._bMSBrowser=o.browser.internet_explorer||o.browser.edge||false;this._oScrollHelper=new s(this,this.getId()+"-content",{horizontal:false,vertical:true})};h.prototype.onBeforeRendering=function(){var e=this.getTitle();if(!this._preserveHeaderStateOnScroll()){this._attachPinPressHandler()}if(d(e)){e._toggleFocusableState(this.getToggleHeaderOnTitleClick())}this._attachTitlePressHandler();this._attachVisualIndicatorsPressHandlers();this._attachVisualIndicatorMouseOverHandlers();this._attachTitleMouseOverHandlers();this._detachScrollHandler()};h.prototype.onAfterRendering=function(){var t;if(this._preserveHeaderStateOnScroll()){e.sap.delayedCall(0,this,this._overridePreserveHeaderStateOnScroll)}this._bPinned=false;this._cacheDomElements();this._detachResizeHandlers();this._attachResizeHandlers();this._updateMedia(this._getWidth(this));this._attachScrollHandler();this._updateScrollBar();this._attachPageChildrenAfterRenderingDelegates();this._resetPinButtonState();if(!this.getHeaderExpanded()){this._snapHeader(false);t=this.getHeader()&&!this.getPreserveHeaderStateOnScroll()&&this._canSnapHeaderOnScroll();if(t){this._setScrollPosition(this._getSnappingHeight())}else{this._toggleHeaderVisibility(false);this._moveHeaderToTitleArea()}}this._updateToggleHeaderVisualIndicators()};h.prototype.exit=function(){this._detachResizeHandlers();if(this._oScrollHelper){this._oScrollHelper.destroy()}};h.prototype.setShowFooter=function(e){var t=this.setProperty("showFooter",e,true);this._toggleFooter(e);return t};h.prototype.setHeaderExpanded=function(e){if(this._bPinned){return this}if(this.getHeaderExpanded()===e){return this}if(this.getDomRef()){this._titleExpandCollapseWhenAllowed()}this.setProperty("headerExpanded",e,true);return this};h.prototype.setToggleHeaderOnTitleClick=function(e){var t=this.getTitle(),i=this.getHeaderExpanded(),r=this.setProperty("toggleHeaderOnTitleClick",e,true);e=this.getProperty("toggleHeaderOnTitleClick");this.$().toggleClass("sapFDynamicPageTitleClickEnabled",e);this._updateToggleHeaderVisualIndicators();this._updateARIAStates(i);if(d(t)){t._toggleFocusableState(e)}return r};h.prototype.setFitContent=function(e){var t=this.setProperty("fitContent",e,true);if(d(this.$())){this._updateFitContainer()}return t};h.prototype.getScrollDelegate=function(){return this._oScrollHelper};h.prototype._overridePreserveHeaderStateOnScroll=function(){if(!this._shouldOverridePreserveHeaderStateOnScroll()){this._headerBiggerThanAllowedHeight=false;return}this._headerBiggerThanAllowedHeight=true;if(this.getHeaderExpanded()){this._moveHeaderToContentArea(true)}else{this._adjustSnap()}this._updateScrollBar()};h.prototype._shouldOverridePreserveHeaderStateOnScroll=function(){return!o.system.desktop&&this._headerBiggerThanAllowedToBeFixed()&&this._preserveHeaderStateOnScroll()};h.prototype._toggleFooter=function(t){var i=this.getFooter();if(!d(this.$())){return}if(!d(i)){return}i.toggleStyleClass("sapFDynamicPageActualFooterControlShow",t);i.toggleStyleClass("sapFDynamicPageActualFooterControlHide",!t);this._toggleFooterSpacer(t);if(g){if(!t){this._iFooterAnimationTimeout=e.sap.delayedCall(h.FOOTER_ANIMATION_DURATION,this,function(){this.$footerWrapper.toggleClass("sapUiHidden",!this.getShowFooter())})}else{if(this._iFooterAnimationTimeout){e.sap.clearDelayedCall(this._iFooterAnimationTimeout);this._iFooterAnimationTimeout=null}this.$footerWrapper.toggleClass("sapUiHidden",!this.getShowFooter())}e.sap.delayedCall(h.FOOTER_ANIMATION_DURATION,this,function(){i.removeStyleClass("sapFDynamicPageActualFooterControlShow")})}this._updateScrollBar()};h.prototype._toggleFooterSpacer=function(e){var t=this.$("spacer");if(d(t)){t.toggleClass("sapFDynamicPageContentWrapperSpacer",e)}if(d(this.$contentFitContainer)){this.$contentFitContainer.toggleClass("sapFDynamicPageContentFitContainerFooterVisible",e)}};h.prototype._toggleHeaderInTabChain=function(e){var t=this.getTitle(),i=this.getHeader();if(!d(t)||!d(i)){return}i.$().css("visibility",e?"visible":"hidden")};h.prototype._snapHeader=function(t,i){var r=this.getTitle();if(this._bPinned&&!i){e.sap.log.debug("DynamicPage :: aborted snapping, header is pinned",this);return}e.sap.log.debug("DynamicPage :: snapped header",this);if(this._bPinned&&i){this._unPin();this._togglePinButtonPressedState(false)}if(d(r)){r._toggleState(false,i);if(t&&this._bHeaderInTitleArea){this._moveHeaderToContentArea(true)}}if(!d(this.$titleArea)){e.sap.log.warning("DynamicPage :: couldn't snap header. There's no title.",this);return}this.setProperty("headerExpanded",false,true);if(this._hasVisibleTitleAndHeader()){this.$titleArea.addClass("sapFDynamicPageTitleSnapped");this._updateToggleHeaderVisualIndicators();this._togglePinButtonVisibility(false)}this._toggleHeaderInTabChain(false);this._updateARIAStates(false)};h.prototype._expandHeader=function(t,i){var r=this.getTitle();e.sap.log.debug("DynamicPage :: expand header",this);if(d(r)){r._toggleState(true,i);if(t){this._moveHeaderToTitleArea(true)}}if(!d(this.$titleArea)){e.sap.log.warning("DynamicPage :: couldn't expand header. There's no title.",this);return}this.setProperty("headerExpanded",true,true);if(this._hasVisibleTitleAndHeader()){this.$titleArea.removeClass("sapFDynamicPageTitleSnapped");this._updateToggleHeaderVisualIndicators();if(!this.getPreserveHeaderStateOnScroll()){this._togglePinButtonVisibility(true)}}this._toggleHeaderInTabChain(true);this._updateARIAStates(true)};h.prototype._toggleHeaderVisibility=function(t,i){var r=this.getHeaderExpanded(),a=this.getTitle(),s=this.getHeader();if(this._bPinned&&!i){e.sap.log.debug("DynamicPage :: header toggle aborted, header is pinned",this);return}if(d(a)){a._toggleState(r)}if(d(s)){s.$().toggleClass("sapFDynamicPageHeaderHidden",!t);this._updateScrollBar()}this._toggleHeaderInTabChain(t)};h.prototype._moveHeaderToContentArea=function(e){var t=this.getHeader();if(d(t)){t.$().prependTo(this.$wrapper);this._bHeaderInTitleArea=false;if(e){this._offsetContentOnMoveHeader()}}};h.prototype._moveHeaderToTitleArea=function(e){var t=this.getHeader();if(d(t)){t.$().appendTo(this.$titleArea);this._bHeaderInTitleArea=true;if(e){this._offsetContentOnMoveHeader()}}};h.prototype._offsetContentOnMoveHeader=function(){var e=Math.ceil(this._getHeaderHeight()),t=this._getScrollPosition(),i;if(!e){return}i=this._bHeaderInTitleArea?t-e:t+e;i=Math.max(i,0);this._setScrollPosition(i,true)};h.prototype._pin=function(){var e=this.$();if(this._bPinned){return}this._bPinned=true;if(!this._bHeaderInTitleArea){this._moveHeaderToTitleArea(true);this._updateScrollBar()}this._updateToggleHeaderVisualIndicators();this._togglePinButtonARIAState(this._bPinned);if(d(e)){e.addClass("sapFDynamicPageHeaderPinned")}};h.prototype._unPin=function(){var e=this.$();if(!this._bPinned){return}this._bPinned=false;this._updateToggleHeaderVisualIndicators();this._togglePinButtonARIAState(this._bPinned);if(d(e)){e.removeClass("sapFDynamicPageHeaderPinned")}};h.prototype._togglePinButtonVisibility=function(e){var t=this.getHeader();if(d(t)){t._setShowPinBtn(e)}};h.prototype._togglePinButtonPressedState=function(e){var t=this.getHeader();if(d(t)){t._togglePinButton(e)}};h.prototype._togglePinButtonARIAState=function(e){var t=this.getHeader();if(d(t)){t._updateARIAPinButtonState(e)}};h.prototype._resetPinButtonState=function(){if(this._preserveHeaderStateOnScroll()){this._togglePinButtonVisibility(false)}else{this._togglePinButtonPressedState(false);this._togglePinButtonARIAState(false)}};h.prototype._restorePinButtonFocus=function(){this.getHeader()._focusPinButton()};h.prototype._getScrollPosition=function(){return d(this.$wrapper)?Math.ceil(this.$wrapper.scrollTop()):0};h.prototype._setScrollPosition=function(e,t){if(!d(this.$wrapper)){return}if(this._getScrollPosition()===e){return}if(t){this._bSuppressToggleHeaderOnce=true}if(!this.getScrollDelegate()._$Container){this.getScrollDelegate()._$Container=this.$wrapper}this.getScrollDelegate().scrollTo(0,e)};h.prototype._shouldSnap=function(){return!this._preserveHeaderStateOnScroll()&&this._getScrollPosition()>=this._getSnappingHeight()&&this.getHeaderExpanded()&&!this._bPinned};h.prototype._shouldExpand=function(){return!this._preserveHeaderStateOnScroll()&&this._getScrollPosition()<this._getSnappingHeight()&&!this.getHeaderExpanded()&&!this._bPinned};h.prototype._headerScrolledOut=function(){return this._getScrollPosition()>=this._getSnappingHeight()};h.prototype._headerSnapAllowed=function(){return!this._preserveHeaderStateOnScroll()&&this.getHeaderExpanded()&&!this._bPinned};h.prototype._canSnapHeaderOnScroll=function(){var e=this._getMaxScrollPosition(),t=this._bMSBrowser?1:0;if(this._bHeaderInTitleArea){e+=this._getHeaderHeight();e-=t}return e>this._getSnappingHeight()};h.prototype._getSnappingHeight=function(){return Math.ceil(this._getHeaderHeight()||this._getTitleHeight())};h.prototype._getMaxScrollPosition=function(){var e;if(d(this.$wrapper)){e=this.$wrapper[0];return e.scrollHeight-e.clientHeight}return 0};h.prototype._needsVerticalScrollBar=function(){var e=this._bMSBrowser?1:0;return this._getMaxScrollPosition()>e};h.prototype._getOwnHeight=function(){return this._getHeight(this)};h.prototype._getEntireHeaderHeight=function(){var e=0,t=0,i=this.getTitle(),r=this.getHeader();if(d(i)){e=i.$().outerHeight()}if(d(r)){t=r.$().outerHeight()}return e+t};h.prototype._headerBiggerThanAllowedToPin=function(e){if(!(typeof e==="number"&&!isNaN(parseInt(e,10)))){e=this._getOwnHeight()}return this._getEntireHeaderHeight()>h.HEADER_MAX_ALLOWED_PINNED_PERCENTAGE*e};h.prototype._headerBiggerThanAllowedToBeFixed=function(){var e=this._getOwnHeight();return this._getEntireHeaderHeight()>h.HEADER_MAX_ALLOWED_NON_SROLLABLE_PERCENTAGE*e};h.prototype._headerBiggerThanAllowedToBeExpandedInTitleArea=function(){var e=this._getEntireHeaderHeight(),t=this._getOwnHeight();return o.system.phone?e>=h.HEADER_MAX_ALLOWED_NON_SROLLABLE_ON_MOBILE*t:e>=t};h.prototype._measureScrollBarOffsetHeight=function(){var t=0,i=!this.getHeaderExpanded(),r=this._bHeaderInTitleArea;if(this._preserveHeaderStateOnScroll()||this._bPinned||!i&&this._bHeaderInTitleArea){t=this._getTitleAreaHeight();e.sap.log.debug("DynamicPage :: preserveHeaderState is enabled or header pinned :: title area height"+t,this);return t}if(i||!d(this.getTitle())||!this._canSnapHeaderOnScroll()){t=this._getTitleHeight();e.sap.log.debug("DynamicPage :: header snapped :: title height "+t,this);return t}this._snapHeader(true);t=this._getTitleHeight();if(!i){this._expandHeader(r)}e.sap.log.debug("DynamicPage :: snapped mode :: title height "+t,this);return t};h.prototype._updateScrollBar=function(){var t,i,r;if(!o.system.desktop||!d(this.$wrapper)){return}t=this._getScrollBar();t.setContentSize(this._measureScrollBarOffsetHeight()+this.$wrapper[0].scrollHeight+"px");i=this._needsVerticalScrollBar();r=this.bHasScrollbar!==i;if(r){t.toggleStyleClass("sapUiHidden",!i);this.toggleStyleClass("sapFDynamicPageWithScroll",i);this.bHasScrollbar=i}e.sap.delayedCall(0,this,this._updateFitContainer);e.sap.delayedCall(0,this,this._updateScrollBarOffset)};h.prototype._updateFitContainer=function(e){var t=typeof e!=="undefined"?!e:!this._needsVerticalScrollBar(),i=this.getFitContent(),r=i||t;this.$contentFitContainer.toggleClass("sapFDynamicPageContentFitContainer",r)};h.prototype._updateScrollBarOffset=function(){var t=sap.ui.getCore().getConfiguration().getRTL()?"left":"right",i=this._needsVerticalScrollBar()?e.sap.scrollbarSize().width+"px":0,r=this.getFooter();this.$titleArea.css("padding-"+t,i);if(d(r)){r.$().css(t,i)}};h.prototype._updateHeaderARIAState=function(e){var t=this.getHeader();if(d(t)){t._updateARIAState(e)}};h.prototype._updateTitleARIAState=function(e){var t=this.getTitle(),i=this.getToggleHeaderOnTitleClick();if(d(t)){t._updateARIAState(e,i)}};h.prototype._updateARIAStates=function(e){this._updateHeaderARIAState(e);this._updateTitleARIAState(e)};h.prototype._updateMedia=function(e){if(e===0){this._updateMediaStyle(h.MEDIA.INVISIBLE)}else if(e<=h.BREAK_POINTS.PHONE){this._updateMediaStyle(h.MEDIA.PHONE)}else if(e<=h.BREAK_POINTS.TABLET){this._updateMediaStyle(h.MEDIA.TABLET)}else{this._updateMediaStyle(h.MEDIA.DESKTOP)}};h.prototype._updateMediaStyle=function(e){Object.keys(h.MEDIA).forEach(function(t){var i=e===h.MEDIA[t];this.toggleStyleClass(h.MEDIA[t],i)},this)};h.prototype._toggleExpandVisualIndicator=function(e){var t=this.getTitle();if(d(t)){t._toggleExpandButton(e)}};h.prototype._focusExpandVisualIndicator=function(){var e=this.getTitle();if(d(e)){e._focusExpandButton()}};h.prototype._toggleCollapseVisualIndicator=function(e){var t=this.getHeader();if(d(t)){t._toggleCollapseButton(e)}};h.prototype._focusCollapseVisualIndicator=function(){var e=this.getHeader();if(d(e)){e._focusCollapseButton()}};h.prototype._updateToggleHeaderVisualIndicators=function(){var e,t,i,r=this._hasVisibleTitleAndHeader();if(!this.getToggleHeaderOnTitleClick()||!r){t=false;i=false}else{e=this.getHeaderExpanded();t=e;i=!e}this._toggleCollapseVisualIndicator(t);this._toggleExpandVisualIndicator(i)};h.prototype._scrollBellowCollapseVisualIndicator=function(){var e=this.getHeader(),t,i,r,a;if(d(e)){t=this.getHeader()._getCollapseButton().getDomRef();i=t.getBoundingClientRect().height;r=this.$wrapper[0].getBoundingClientRect().height;a=t.offsetTop+i-r;this._setScrollPosition(a)}};h.prototype._hasVisibleTitleAndHeader=function(){var e=this.getTitle(),t=this.getHeader();return d(e)&&e.getVisible()&&d(t)&&t.getVisible()&&d(t.getContent())};h.prototype._getHeight=function(e){var t;if(!(e instanceof i)){return 0}t=e.getDomRef();return t?t.getBoundingClientRect().height:0};h.prototype._getWidth=function(e){return!(e instanceof i)?0:e.$().outerWidth()||0};h.prototype._getTitleAreaHeight=function(){return d(this.$titleArea)?this.$titleArea.outerHeight()||0:0};h.prototype._getTitleHeight=function(){return this._getHeight(this.getTitle())};h.prototype._getHeaderHeight=function(){return this._getHeight(this.getHeader())};h.prototype._preserveHeaderStateOnScroll=function(){return this.getPreserveHeaderStateOnScroll()&&!this._headerBiggerThanAllowedHeight};h.prototype._getScrollBar=function(){if(!d(this.getAggregation("_scrollBar"))){var e=new r(this.getId()+"-vertSB",{vertical:true,size:"100%",scrollPosition:0,scroll:this._onScrollBarScroll.bind(this)});this.setAggregation("_scrollBar",e,true)}return this.getAggregation("_scrollBar")};h.prototype._cacheDomElements=function(){var e=this.getFooter();if(d(e)){this.$footer=e.$();this.$footerWrapper=this.$("footerWrapper")}this.$wrapper=this.$("contentWrapper");this.$contentFitContainer=this.$("contentFitContainer");this.$titleArea=this.$("header");this._cacheTitleDom()};h.prototype._cacheTitleDom=function(){var e=this.getTitle();if(d(e)){this.$title=e.$()}};h.prototype._adjustSnap=function(){var e,t,i,r,a=this.$();if(!d(a)){return}if(!p(a[0])){return}e=this.getHeader();t=!this.getHeaderExpanded();if(!e||!t){return}i=!this._preserveHeaderStateOnScroll()&&this._canSnapHeaderOnScroll();r=t&&e.$().hasClass("sapFDynamicPageHeaderHidden");if(i&&r){this._toggleHeaderVisibility(true);this._moveHeaderToContentArea(true)}else if(!i&&!r){this._moveHeaderToTitleArea(true);this._toggleHeaderVisibility(false)}};h.prototype.ontouchmove=function(e){e.setMarked()};h.prototype._onChildControlAfterRendering=function(t){if(t.srcControl instanceof n){this._cacheTitleDom();this._deRegisterResizeHandler(h.RESIZE_HANDLER_ID.TITLE);this._registerResizeHandler(h.RESIZE_HANDLER_ID.TITLE,this.$title[0],this._onChildControlsHeightChange.bind(this))}e.sap.delayedCall(0,this,this._updateScrollBar)};h.prototype._onChildControlsHeightChange=function(){var e=this._needsVerticalScrollBar();if(e){this._updateFitContainer(e)}this._adjustSnap();if(!this._bExpandingWithAClick){this._updateScrollBar()}this._bExpandingWithAClick=false};h.prototype._onResize=function(e){var t=this.getTitle(),i=this.getHeader(),r=e.size.width;if(!this._preserveHeaderStateOnScroll()&&i){if(this._headerBiggerThanAllowedToPin(e.size.height)||o.system.phone){this._unPin();this._togglePinButtonVisibility(false);this._togglePinButtonPressedState(false)}else{this._togglePinButtonVisibility(true)}if(this._bHeaderInTitleArea&&this._headerBiggerThanAllowedToBeExpandedInTitleArea()){this._expandHeader(false);this._setScrollPosition(0)}}if(d(t)){t._onResize(r)}this._adjustSnap();this._updateScrollBar();this._updateMedia(r)};h.prototype._onWrapperScroll=function(e){var t=Math.max(e.target.scrollTop,0);if(o.system.desktop){if(this.allowCustomScroll===true){this.allowCustomScroll=false;return}this.allowInnerDiv=true;this._getScrollBar().setScrollPosition(t);this.toggleStyleClass("sapFDynamicPageWithScroll",this._needsVerticalScrollBar())}};h.prototype._toggleHeaderOnScroll=function(){if(this._bSuppressToggleHeaderOnce){this._bSuppressToggleHeaderOnce=false;return}if(o.system.desktop&&this._bExpandingWithAClick){return}if(this._preserveHeaderStateOnScroll()){return}if(this._shouldSnap()){this._snapHeader(true,true)}else if(this._shouldExpand()){this._expandHeader(false,true);this._toggleHeaderVisibility(true)}else if(!this._bPinned&&this._bHeaderInTitleArea){var e=this._getScrollPosition()>=this._getSnappingHeight();this._moveHeaderToContentArea(e)}};h.prototype._onScrollBarScroll=function(){if(this.allowInnerDiv===true){this.allowInnerDiv=false;return}this.allowCustomScroll=true;this._setScrollPosition(this._getScrollBar().getScrollPosition())};h.prototype._onTitlePress=function(){if(this.getToggleHeaderOnTitleClick()){this._titleExpandCollapseWhenAllowed(true)}};h.prototype._onExpandHeaderVisualIndicatorPress=function(){this._onTitlePress();if(this._headerBiggerThanAllowedToBeExpandedInTitleArea()){this._scrollBellowCollapseVisualIndicator()}this._focusCollapseVisualIndicator()};h.prototype._onCollapseHeaderVisualIndicatorPress=function(){this._onTitlePress();this._focusExpandVisualIndicator()};h.prototype._onVisualIndicatorMouseOver=function(){var e=this.$();if(d(e)){e.addClass("sapFDynamicPageTitleForceHovered")}};h.prototype._onVisualIndicatorMouseOut=function(){var e=this.$();if(d(e)){e.removeClass("sapFDynamicPageTitleForceHovered")}};h.prototype._onTitleMouseOver=h.prototype._onVisualIndicatorMouseOver;h.prototype._onTitleMouseOut=h.prototype._onVisualIndicatorMouseOut;h.prototype._titleExpandCollapseWhenAllowed=function(t){var i;if(this._bPinned&&!t){return this}this._bSuppressToggleHeaderOnce=true;if(this._preserveHeaderStateOnScroll()||!this._canSnapHeaderOnScroll()||!this.getHeader()){if(!this.getHeaderExpanded()){this._expandHeader(false,t);this._toggleHeaderVisibility(true,t)}else{this._snapHeader(false,t);this._toggleHeaderVisibility(false,t)}}else if(!this.getHeaderExpanded()){i=!this._headerBiggerThanAllowedToBeExpandedInTitleArea();this._bExpandingWithAClick=true;this._expandHeader(i,t);this.getHeader().$().removeClass("sapFDynamicPageHeaderHidden");if(!i){this._setScrollPosition(0)}this._bExpandingWithAClick=false}else{var r=this._bHeaderInTitleArea;this._snapHeader(r,t);if(!r){this._setScrollPosition(this._getSnappingHeight())}}e.sap.delayedCall(0,this,function(){this._bSuppressToggleHeaderOnce=false}.bind(this))};h.prototype._onPinUnpinButtonPress=function(){if(this._bPinned){this._unPin()}else{this._pin();this._restorePinButtonFocus()}};h.prototype._attachResizeHandlers=function(){var e=this._onChildControlsHeightChange.bind(this);this._registerResizeHandler(h.RESIZE_HANDLER_ID.PAGE,this,this._onResize.bind(this));if(d(this.$title)){this._registerResizeHandler(h.RESIZE_HANDLER_ID.TITLE,this.$title[0],e)}if(d(this.$contentFitContainer)){this._registerResizeHandler(h.RESIZE_HANDLER_ID.CONTENT,this.$contentFitContainer[0],e)}};h.prototype._registerResizeHandler=function(e,t,i){if(!this[e]){this[e]=a.register(t,i)}};h.prototype._detachResizeHandlers=function(){this._deRegisterResizeHandler(h.RESIZE_HANDLER_ID.PAGE);this._deRegisterResizeHandler(h.RESIZE_HANDLER_ID.TITLE);this._deRegisterResizeHandler(h.RESIZE_HANDLER_ID.CONTENT)};h.prototype._deRegisterResizeHandler=function(e){if(this[e]){a.deregister(this[e]);this[e]=null}};h.prototype._attachPageChildrenAfterRenderingDelegates=function(){var e=this.getTitle(),t=this.getHeader(),i=this.getContent(),r={onAfterRendering:this._onChildControlAfterRendering.bind(this)};if(d(e)){e.addEventDelegate(r)}if(d(i)){i.addEventDelegate(r)}if(d(t)){t.addEventDelegate(r)}};h.prototype._attachTitlePressHandler=function(){var e=this.getTitle();if(d(e)&&!this._bAlreadyAttachedTitlePressHandler){e.attachEvent(h.EVENTS.TITLE_PRESS,this._onTitlePress,this);this._bAlreadyAttachedTitlePressHandler=true}};h.prototype._attachPinPressHandler=function(){var e=this.getHeader();if(d(e)&&!this._bAlreadyAttachedPinPressHandler){e.attachEvent(h.EVENTS.PIN_UNPIN_PRESS,this._onPinUnpinButtonPress,this);this._bAlreadyAttachedPinPressHandler=true}};h.prototype._attachVisualIndicatorsPressHandlers=function(){var e=this.getTitle(),t=this.getHeader();if(d(e)&&!this._bAlreadyAttachedTitleIndicatorPressHandler){e.attachEvent(h.EVENTS.TITLE_VISUAL_INDICATOR_PRESS,this._onExpandHeaderVisualIndicatorPress,this);this._bAlreadyAttachedTitleIndicatorPressHandler=true}if(d(t)&&!this._bAlreadyAttachedHeaderIndicatorPressHandler){t.attachEvent(h.EVENTS.HEADER_VISUAL_INDICATOR_PRESS,this._onCollapseHeaderVisualIndicatorPress,this);this._bAlreadyAttachedHeaderIndicatorPressHandler=true}};h.prototype._attachVisualIndicatorMouseOverHandlers=function(){var e=this.getHeader();if(d(e)&&!this._bAlreadyAttachedVisualIndicatorMouseOverOutHandler){e.attachEvent(h.EVENTS.VISUAL_INDICATOR_MOUSE_OVER,this._onVisualIndicatorMouseOver,this);e.attachEvent(h.EVENTS.VISUAL_INDICATOR_MOUSE_OUT,this._onVisualIndicatorMouseOut,this);this._bAlreadyAttachedVisualIndicatorMouseOverOutHandler=true}};h.prototype._attachTitleMouseOverHandlers=function(){var e=this.getTitle();if(d(e)&&!this._bAlreadyAttachedTitleMouseOverOutHandler){e.attachEvent(h.EVENTS.TITLE_MOUSE_OVER,this._onTitleMouseOver,this);e.attachEvent(h.EVENTS.TITLE_MOUSE_OUT,this._onTitleMouseOut,this);this._bAlreadyAttachedTitleMouseOverOutHandler=true}};h.prototype._attachScrollHandler=function(){this._onWrapperScrollReference=this._onWrapperScroll.bind(this);this._toggleHeaderOnScrollReference=this._toggleHeaderOnScroll.bind(this);this.$wrapper.on("scroll",this._onWrapperScrollReference);this.$wrapper.on("scroll",this._toggleHeaderOnScrollReference)};h.prototype._detachScrollHandler=function(){if(this.$wrapper){this.$wrapper.off("scroll",this._onWrapperScrollReference);this.$wrapper.off("scroll",this._toggleHeaderOnScrollReference)}};return h});