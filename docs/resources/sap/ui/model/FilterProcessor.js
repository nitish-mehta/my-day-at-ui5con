/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Filter","jquery.sap.global","jquery.sap.unicode"],function(e,r){"use strict";var t={};t.apply=function(e,t,n){if(!e){return[]}else if(!t||t.length==0){return e.slice()}var i=this,a={},f,s=[],u=false,l=true;r.each(t,function(e,r){if(r.sPath!==undefined){f=a[r.sPath];if(!f){f=a[r.sPath]=[]}}else{f=a["__multiFilter"];if(!f){f=a["__multiFilter"]=[]}}f.push(r)});r.each(e,function(e,t){l=true;r.each(a,function(e,a){if(e!=="__multiFilter"){u=false;r.each(a,function(r,a){var f=n(t,e),s=i.getFilterFunction(a);if(!a.fnCompare){f=i.normalizeFilterValue(f,a.bCaseSensitive)}if(f!==undefined&&s(f)){u=true;return false}})}else{u=false;r.each(a,function(e,r){u=i._resolveMultiFilter(r,t,n);if(u){return false}})}if(!u){l=false;return false}});if(l){s.push(t)}});return s};t.normalizeFilterValue=function(e,r){if(typeof e=="string"){if(r===undefined){r=false}if(!r){if(String.prototype.normalize&&(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge)){e=e.normalize("NFKD")}e=e.toUpperCase()}if(String.prototype.normalize){e=e.normalize("NFC")}return e}if(e instanceof Date){return e.getTime()}return e};t._resolveMultiFilter=function(e,t,n){var i=this,a=!!e.bAnd,f=e.aFilters;if(f){r.each(f,function(e,r){var f=false;if(r._bMultiFilter){f=i._resolveMultiFilter(r,t,n)}else if(r.sPath!==undefined){var s=n(t,r.sPath),u=i.getFilterFunction(r);if(!r.fnCompare){s=i.normalizeFilterValue(s,r.bCaseSensitive)}if(s!==undefined&&u(s)){f=true}}if(f!==a){a=f;return false}})}return a};t.getFilterFunction=function(t){if(t.fnTest){return t.fnTest}var n=t.oValue1,i=t.oValue2,a=t.fnCompare||e.defaultComparator;if(!t.fnCompare){n=this.normalizeFilterValue(n,t.bCaseSensitive);i=this.normalizeFilterValue(i,t.bCaseSensitive)}switch(t.sOperator){case"EQ":t.fnTest=function(e){return a(e,n)===0};break;case"NE":t.fnTest=function(e){return a(e,n)!==0};break;case"LT":t.fnTest=function(e){return a(e,n)<0};break;case"LE":t.fnTest=function(e){return a(e,n)<=0};break;case"GT":t.fnTest=function(e){return a(e,n)>0};break;case"GE":t.fnTest=function(e){return a(e,n)>=0};break;case"BT":t.fnTest=function(e){return a(e,n)>=0&&a(e,i)<=0};break;case"Contains":t.fnTest=function(e){if(e==null){return false}if(typeof e!="string"){throw new Error('Only "String" values are supported for the FilterOperator: "Contains".')}return e.indexOf(n)!=-1};break;case"StartsWith":t.fnTest=function(e){if(e==null){return false}if(typeof e!="string"){throw new Error('Only "String" values are supported for the FilterOperator: "StartsWith".')}return e.indexOf(n)==0};break;case"EndsWith":t.fnTest=function(e){if(e==null){return false}if(typeof e!="string"){throw new Error('Only "String" values are supported for the FilterOperator: "EndsWith".')}var r=e.lastIndexOf(n);if(r==-1){return false}return r==e.length-new String(t.oValue1).length};break;default:r.sap.log.error('The filter operator "'+t.sOperator+'" is unknown, filter will be ignored.');t.fnTest=function(e){return true}}return t.fnTest};return t});