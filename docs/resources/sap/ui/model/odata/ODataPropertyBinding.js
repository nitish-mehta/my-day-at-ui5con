/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/model/Context","sap/ui/model/ChangeReason","sap/ui/model/PropertyBinding","sap/ui/model/ChangeReason"],function(t,e,a,i){"use strict";var s=i.extend("sap.ui.model.odata.ODataPropertyBinding",{constructor:function(t,e,a,s){i.apply(this,arguments);this.bInitial=true;this.oValue=this._getValue();this.vOriginalValue;this.getDataState().setValue(this.oValue)}});s.prototype.initialize=function(){if(this.oModel.oMetadata.isLoaded()&&this.bInitial){this.checkUpdate(true);this.bInitial=false}};s.prototype.getValue=function(){return this.oValue};s.prototype._getValue=function(){return this.oModel._getObject(this.sPath,this.oContext)};s.prototype.setValue=function(e){if(this.bSuspended){return}if(!t.sap.equal(e,this.oValue)&&this.oModel.setProperty(this.sPath,e,this.oContext,true)){this.oValue=e;var i=this.getDataState();i.setValue(this.oValue);this.oModel.firePropertyChange({reason:a.Binding,path:this.sPath,context:this.oContext,value:e})}};s.prototype.setContext=function(t){if(t&&t.isPreliminary()){return}if(e.hasChanged(this.oContext,t)){sap.ui.getCore().getMessageManager().removeMessages(this.getDataState().getControlMessages(),true);this.oContext=t;if(this.isRelative()){this.checkUpdate()}}};s.prototype.checkUpdate=function(e){if(this.bSuspended&&!e){return}var i=this.getDataState();var s=false;var o=this.oModel.getOriginalProperty(this.sPath,this.oContext);if(e||!t.sap.equal(o,this.vOriginalValue)){this.vOriginalValue=o;i.setOriginalValue(o);s=true}var n=this._getValue();if(e||!t.sap.equal(n,this.oValue)){this.oValue=n;i.setValue(this.oValue);this._fireChange({reason:a.Change});s=true}if(s){this.checkDataState()}};s.prototype.checkDataState=function(t){var e=this.oModel.resolve(this.sPath,this.oContext,true);if(!t||e&&e in t){var a=this.getDataState();a.setLaundering(!!t&&!!(e in t));i.prototype.checkDataState.apply(this,arguments);a.setModelMessages(this.oModel.getMessagesByPath(e))}};return s});