/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./_Helper","./_MetadataConverter"],function(t,e,s){"use strict";function o(){this.enumType=null;this.enumTypeMemberCounter=0;this.navigationProperty=null;s.call(this)}o.prototype=Object.create(s.prototype);o.prototype.finalize=function(){if(this.result.$Version!=="4.0"){throw new Error(this.url+": Unsupported OData version "+this.result.$Version)}};o.prototype.processActionOrFunction=function(t){var e=t.localName,s=this.namespace+t.getAttribute("Name"),o={$kind:e};this.processAttributes(t,o,{IsBound:this.setIfTrue,EntitySetPath:this.setValue,IsComposable:this.setIfTrue});this.getOrCreateArray(this.result,s).push(o);this.oOperation=o;this.annotatable(o)};o.prototype.processComplexType=function(t){this.processType(t,{$kind:"ComplexType"})};o.prototype.processEdmx=function(t){this.processAttributes(t,this.result,{Version:this.setValue})};o.prototype.processElement=function(t,e){if(e){e.call(this,t)}};o.prototype.processEntityContainer=function(t){var e=this.namespace+t.getAttribute("Name");this.result[e]=this.entityContainer={$kind:"EntityContainer"};this.result.$EntityContainer=e;this.annotatable(e)};o.prototype.processEntitySet=function(t){var e=t.getAttribute("Name");this.entityContainer[e]=this.entitySet={$kind:"EntitySet",$Type:this.resolveAlias(t.getAttribute("EntityType"))};this.processAttributes(t,this.entitySet,{IncludeInServiceDocument:this.setIfFalse});this.annotatable(e)};o.prototype.processEntityType=function(t){this.processType(t,{$kind:"EntityType"})};o.prototype.processEntityTypeKeyPropertyRef=function(t){var e=t.getAttribute("Alias"),s,o=t.getAttribute("Name");if(e){s={};s[e]=o}else{s=o}this.getOrCreateArray(this.type,"$Key").push(s)};o.prototype.processEnumType=function(t){var e=this.namespace+t.getAttribute("Name"),s={$kind:"EnumType"};this.processAttributes(t,s,{IsFlags:this.setIfTrue,UnderlyingType:function(t){return t!=="Edm.Int32"?t:undefined}});this.result[e]=this.enumType=s;this.enumTypeMemberCounter=0;this.annotatable(e)};o.prototype.processEnumTypeMember=function(t){var s=t.getAttribute("Name"),o=t.getAttribute("Value"),i;if(o){i=parseInt(o,10);if(!e.isSafeInteger(i)){i=o}}else{i=this.enumTypeMemberCounter;this.enumTypeMemberCounter++}this.enumType[s]=i;this.annotatable(s)};o.prototype.processFacetAttributes=function(t,e){var s=this;this.processAttributes(t,e,{MaxLength:function(t){return t==="max"?undefined:s.setNumber(t)},Precision:this.setNumber,Scale:function(t){return t==="variable"?t:s.setNumber(t)},SRID:this.setValue,Unicode:this.setIfFalse})};o.prototype.processImport=function(t){var e=t.localName,s={$kind:e},o=t.getAttribute("Name"),i=this;e=e.replace("Import","");s["$"+e]=this.resolveAlias(t.getAttribute(e));this.processAttributes(t,s,{EntitySet:function(t){return i.resolveTargetPath(t)},IncludeInServiceDocument:this.setIfTrue});this.entityContainer[o]=s;this.annotatable(o)};o.prototype.processNavigationPropertyBinding=function(t){var e=this.getOrCreateObject(this.entitySet,"$NavigationPropertyBinding");e[t.getAttribute("Path")]=this.resolveTargetPath(t.getAttribute("Target"))};o.prototype.processParameter=function(t){var e=this.oOperation,s={};this.processTypedCollection(t.getAttribute("Type"),s);this.processAttributes(t,s,{Name:this.setValue,Nullable:this.setIfFalse});this.processFacetAttributes(t,s);this.getOrCreateArray(e,"$Parameter").push(s);this.annotatable(s)};o.prototype.processReturnType=function(t){var e=this.oOperation,s={};this.processTypedCollection(t.getAttribute("Type"),s);this.processAttributes(t,s,{Nullable:this.setIfFalse});this.processFacetAttributes(t,s);e.$ReturnType=s;this.annotatable(s)};o.prototype.processSchema=function(t){this.namespace=t.getAttribute("Namespace")+".";this.result[this.namespace]=this.schema={$kind:"Schema"};this.annotatable(this.schema)};o.prototype.processSingleton=function(t){var e=t.getAttribute("Name");this.entityContainer[e]=this.entitySet={$kind:"Singleton",$Type:this.resolveAlias(t.getAttribute("Type"))};this.annotatable(e)};o.prototype.processTerm=function(t){var e=this.namespace+t.getAttribute("Name"),s={$kind:"Term"},o=this;this.processTypedCollection(t.getAttribute("Type"),s);this.processAttributes(t,s,{Nullable:this.setIfFalse,BaseTerm:function(t){return t?o.resolveAlias(t):undefined}});this.processFacetAttributes(t,s);this.result[e]=s;this.annotatable(e)};o.prototype.processType=function(t,e){var s=this.namespace+t.getAttribute("Name"),o=this;this.processAttributes(t,e,{OpenType:o.setIfTrue,HasStream:o.setIfTrue,Abstract:o.setIfTrue,BaseType:function(t){return t?o.resolveAlias(t):undefined}});this.result[s]=this.type=e;this.annotatable(s)};o.prototype.processTypedCollection=function(t,e){var s=this.rCollection.exec(t);if(s){e.$isCollection=true;t=s[1]}e.$Type=this.resolveAlias(t)};o.prototype.processTypeDefinition=function(t){var e=this.namespace+t.getAttribute("Name"),s={$kind:"TypeDefinition",$UnderlyingType:t.getAttribute("UnderlyingType")};this.result[e]=s;this.processFacetAttributes(t,s);this.annotatable(e)};o.prototype.processTypeNavigationProperty=function(t){var e=t.getAttribute("Name"),s={$kind:"NavigationProperty"};this.processTypedCollection(t.getAttribute("Type"),s);this.processAttributes(t,s,{Nullable:this.setIfFalse,Partner:this.setValue,ContainsTarget:this.setIfTrue});this.type[e]=this.navigationProperty=s;this.annotatable(e)};o.prototype.processTypeNavigationPropertyOnDelete=function(t){this.navigationProperty.$OnDelete=t.getAttribute("Action");this.annotatable(this.navigationProperty,"$OnDelete")};o.prototype.processTypeNavigationPropertyReferentialConstraint=function(t){var e=t.getAttribute("Property"),s=this.getOrCreateObject(this.navigationProperty,"$ReferentialConstraint");s[e]=t.getAttribute("ReferencedProperty");this.annotatable(s,e)};o.prototype.processTypeProperty=function(t){var e=t.getAttribute("Name"),s={$kind:"Property"};this.processTypedCollection(t.getAttribute("Type"),s);this.processAttributes(t,s,{Nullable:this.setIfFalse,DefaultValue:this.setValue});this.processFacetAttributes(t,s);this.type[e]=s;this.annotatable(e)};o.prototype.resolveTargetPath=function(t){var e;if(!t){return t}t=this.resolveAliasInPath(t);e=t.indexOf("/");if(e>=0&&t.indexOf("/",e+1)<0){if(t.slice(0,e)===this.result.$EntityContainer){return t.slice(e+1)}}return t};(function(t){var e,s,o;t.sRootNamespace=t.sEdmxNamespace;t.oAliasConfig={__xmlns:t.sEdmxNamespace,Reference:{Include:{__processor:t.processAlias}},DataServices:{Schema:{__xmlns:t.sEdmNamespace,__processor:t.processAlias}}};o={Property:{__processor:t.processTypeProperty,__include:[t.oAnnotationConfig]},NavigationProperty:{__processor:t.processTypeNavigationProperty,__include:[t.oAnnotationConfig],OnDelete:{__processor:t.processTypeNavigationPropertyOnDelete,__include:[t.oAnnotationConfig]},ReferentialConstraint:{__processor:t.processTypeNavigationPropertyReferentialConstraint,__include:[t.oAnnotationConfig]}}};s={NavigationPropertyBinding:{__processor:t.processNavigationPropertyBinding}};e={Parameter:{__processor:t.processParameter,__include:[t.oAnnotationConfig]},ReturnType:{__processor:t.processReturnType,__include:[t.oAnnotationConfig]}};t.oFullConfig={__xmlns:t.sEdmxNamespace,__processor:t.processEdmx,__include:[t.oReferenceInclude],DataServices:{Schema:{__xmlns:t.sEdmNamespace,__processor:t.processSchema,__include:[t.oAnnotationsConfig,t.oAnnotationConfig],Action:{__processor:t.processActionOrFunction,__include:[e,t.oAnnotationConfig]},Function:{__processor:t.processActionOrFunction,__include:[e,t.oAnnotationConfig]},EntityType:{__processor:t.processEntityType,__include:[o,t.oAnnotationConfig],Key:{PropertyRef:{__processor:t.processEntityTypeKeyPropertyRef}}},ComplexType:{__processor:t.processComplexType,__include:[o,t.oAnnotationConfig]},EntityContainer:{__processor:t.processEntityContainer,__include:[t.oAnnotationConfig],ActionImport:{__processor:t.processImport,__include:[t.oAnnotationConfig]},EntitySet:{__processor:t.processEntitySet,__include:[s,t.oAnnotationConfig]},FunctionImport:{__processor:t.processImport,__include:[t.oAnnotationConfig]},Singleton:{__processor:t.processSingleton,__include:[s,t.oAnnotationConfig]}},EnumType:{__processor:t.processEnumType,__include:[t.oAnnotationConfig],Member:{__processor:t.processEnumTypeMember,__include:[t.oAnnotationConfig]}},Term:{__processor:t.processTerm,__include:[t.oAnnotationConfig]},TypeDefinition:{__processor:t.processTypeDefinition,__include:[t.oAnnotationConfig]}}}}})(o.prototype);return o},false);