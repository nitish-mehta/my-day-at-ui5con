/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/model/TreeBinding","./v2/ODataTreeBinding","sap/ui/model/TreeBindingAdapter","sap/ui/model/TreeAutoExpandMode","sap/ui/model/ChangeReason","./OperationMode"],function(e,t,r,i,a,s,o){"use strict";var n=function(){if(!(this instanceof t)||this._bIsAdapted){return}i.apply(this);for(var e in n.prototype){if(n.prototype.hasOwnProperty(e)){this[e]=n.prototype[e]}}this.mParameters=this.mParameters||{};this._aRowIndexMap=[];this._iThreshold=0;this._iPageSize=0;this.setAutoExpandMode(this.mParameters.autoExpandMode||a.Sequential);if(this.mParameters.collapseRecursive===undefined){this.bCollapseRecursive=true}else{this.bCollapseRecursive=!!this.mParameters.collapseRecursive}this._createTreeState();if(this.mParameters.treeState&&this.sOperationMode==o.Client){this.setTreeState(this.mParameters.treeState)}};n.prototype.nodeHasChildren=function(t){e.sap.assert(t,"ODataTreeBindingAdapter.nodeHasChildren: No node given!");if(!t){return false}else if(t.isArtificial){return true}else{return r.prototype.hasChildren.call(this,t.context)}};n.prototype._calculateGroupID=function(e){var t="";var r="";var i;if(e.context===null){return"/"}if(e.parent){t=e.parent.groupID;t=t[t.length-1]!=="/"?t+"/":t;if(this.bHasTreeAnnotations){i=(e.context.getProperty(this.oTreeProperties["hierarchy-node-for"])+"").replace(/\//g,"%2F");r=i+"/"}else{r=e.context.sPath.substring(1)+"/"}}else{if(this.bHasTreeAnnotations){t="/";i=(e.context.getProperty(this.oTreeProperties["hierarchy-node-for"])+"").replace(/\//g,"%2F");r=i+"/"}else{t="/";r=e.context.sPath[0]==="/"?e.context.sPath.substring(1):e.context.sPath}}var a=t+r;return a};n.prototype.resetData=function(e,t){var i=r.prototype.resetData.call(this,e,t);this._aRowIndexMap=[];this._oRootNode=undefined;this._iPageSize=0;this._iThreshold=0;if(!t||t.reason!==s.Sort){this.clearSelection();this._createTreeState(true)}return i};return n},true);