/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/format/NumberFormat","sap/ui/model/FormatException","sap/ui/model/odata/type/ODataType","sap/ui/model/ParseException","sap/ui/model/ValidateException"],function(e,t,a,n,o,r){"use strict";function i(){return sap.ui.getCore().getLibraryResourceBundle().getText("EnterNumber")}function l(a){var n;if(!a.oFormat){n=e.extend({groupingEnabled:true},a.oFormatOptions);a.oFormat=t.getFloatInstance(n)}return a.oFormat}function u(e){return!e.oConstraints||e.oConstraints.nullable!==false}function s(t,a){var n;t.oConstraints=undefined;if(a){n=a.nullable;if(n===false||n==="false"){t.oConstraints={nullable:false}}else if(n!==undefined&&n!==true&&n!=="true"){e.sap.log.warning("Illegal nullable: "+n,null,t.getName())}}t._handleLocalizationChange()}var p=n.extend("sap.ui.model.odata.type.Double",{constructor:function(e,t){n.apply(this,arguments);this.oFormatOptions=e;s(this,t)}});p.prototype.formatValue=function(e,t){var n,o;if(e===null||e===undefined){return null}if(typeof e==="number"){o=e}else if(typeof e==="string"){o=parseFloat(e)}else if(t!=="any"){throw new a("Illegal "+this.getName()+" value: "+e)}switch(this.getPrimitiveType(t)){case"any":return e;case"float":return o;case"int":return Math.floor(o);case"string":if(o&&(Math.abs(o)>=1e15||Math.abs(o)<1e-4)){n=l(this).oFormatOptions;return o.toExponential().replace("e","Â E").replace(".",n.decimalSeparator).replace("+",n.plusSign).replace("-",n.minusSign)}return l(this).format(o);default:throw new a("Don't know how to format "+this.getName()+" to "+t)}};p.prototype.parseValue=function(e,t){var a;if(e===null||e===""){return null}switch(this.getPrimitiveType(t)){case"string":a=l(this).parse(e);if(isNaN(a)){throw new o(i())}break;case"int":case"float":a=e;break;default:throw new o("Don't know how to parse "+this.getName()+" from "+t)}return a};p.prototype._handleLocalizationChange=function(){this.oFormat=null};p.prototype.validateValue=function(e){if(e===null&&u(this)){return}if(typeof e==="number"){return}throw new r(i())};p.prototype.getName=function(){return"sap.ui.model.odata.type.Double"};return p});