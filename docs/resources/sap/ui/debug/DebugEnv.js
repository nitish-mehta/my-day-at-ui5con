/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define("sap/ui/debug/DebugEnv",["jquery.sap.global","sap/ui/base/Interface","./ControlTree","./LogViewer","./PropertyList"],function(t,o,e,i,s){"use strict";var r=function(){};r.prototype.startPlugin=function(o,e){this.oCore=o;this.oWindow=window;try{this.bRunsEmbedded=typeof window.top.testfwk=="undefined";t.sap.log.info("Starting DebugEnv plugin ("+(this.bRunsEmbedded?"embedded":"testsuite")+")");if(!this.bRunsEmbedded||o.getConfiguration().getInspect()){this.init(e)}if(!this.bRunsEmbedded||o.getConfiguration().getTrace()){this.initLogger(t.sap.log,e)}}catch(o){t.sap.log.warning("DebugEnv plugin can not be started outside the Testsuite.")}};r.prototype.stopPlugin=function(){t.sap.log.info("Stopping DebugEnv plugin.");this.oCore=null};r.prototype.init=function(o){this.oControlTreeWindow=this.bRunsEmbedded?this.oWindow:top.frames["sap-ui-ControlTreeWindow"]||top;this.oPropertyListWindow=this.bRunsEmbedded?this.oWindow:top.frames["sap-ui-PropertyListWindow"]||top;var i=sap.ui.getCore().getConfiguration().getRTL();var r=this.oControlTreeWindow.document.getElementById("sap-ui-ControlTreeRoot"),n=this.oPropertyListWindow.document.getElementById("sap-ui-PropertyWindowRoot");if(!r){r=this.oControlTreeWindow.document.createElement("DIV");r.setAttribute("id","sap-ui-ControlTreeRoot");r.setAttribute("tabindex",-1);r.style.position="absolute";r.style.fontFamily="Arial";r.style.fontSize="8pt";r.style.backgroundColor="white";r.style.color="black";r.style.border="1px solid gray";r.style.overflow="auto";r.style.zIndex="999999";r.style.top="1px";if(i){r.style.left="1px"}else{r.style.right="1px"}r.style.height="49%";r.style.width="200px";this.oControlTreeWindow.document.body.appendChild(r)}else{r.innerHTML=""}this.oControlTreeRoot=r;if(!n){n=this.oPropertyListWindow.document.createElement("DIV");n.setAttribute("id","sap-ui-PropertyWindowRoot");n.setAttribute("tabindex",-1);n.style.position="absolute";n.style.fontFamily="Arial";n.style.fontSize="8pt";n.style.backgroundColor="white";n.style.color="black";n.style.border="1px solid gray";n.style.overflow="auto";n.style.zIndex="99999";n.style.width="196px";n.style.height="49%";if(i){n.style.left="1px"}else{n.style.right="1px"}n.style.bottom="1px";this.oPropertyListWindow.document.body.appendChild(n)}else{n.innerHTML=""}this.oPropertyWindowRoot=n;this.oControlTree=new e(this.oCore,this.oWindow,r,this.bRunsEmbedded);this.oPropertyList=new s(this.oCore,this.oWindow,n);this.oControlTree.attachEvent(e.M_EVENTS.SELECT,this.oPropertyList.update,this.oPropertyList);if(!o){this.oControlTree.renderDelayed()}t(window).unload(t.proxy(function(t){this.oControlTree.exit();this.oPropertyList.exit()},this))};r.prototype.initLogger=function(t,o){this.oLogger=t;if(!this.bRunsEmbedded){this.oTraceWindow=top.frames["sap-ui-TraceWindow"];this.oTraceViewer=this.oTraceWindow.oLogViewer=new i(this.oTraceWindow,"sap-ui-TraceWindowRoot");this.oTraceViewer.sLogEntryClassPrefix="lvl";this.oTraceViewer.lock()}else{this.oTraceWindow=this.oWindow;this.oTraceViewer=new i(this.oTraceWindow,"sap-ui-TraceWindowRoot")}this.oLogger.addLogListener(this.oTraceViewer);this.oCore.attachUIUpdated(this.enableLogViewer,this);if(!o){var e=this;this.oTimer=setTimeout(function(){e.enableLogViewer()},0)}};r.prototype.enableLogViewer=function(){if(this.oTimer){clearTimeout(this.oTimer);this.oTimer=undefined}this.oCore.detachUIUpdated(this.enableLogViewer,this);if(this.oTraceViewer){this.oTraceViewer.unlock()}};r.prototype.isRunningEmbedded=function(){return this.bRunsEmbedded};r.prototype.isControlTreeShown=function(){return t(this.oControlTreeRoot).css("visibility")==="visible"||t(this.oControlTreeRoot).css("visibility")==="inherit"};r.prototype.showControlTree=function(){if(!this.oControlTreeRoot){this.init(false)}t(this.oControlTreeRoot).css("visibility","visible")};r.prototype.hideControlTree=function(){t(this.oControlTreeRoot).css("visibility","hidden")};r.prototype.isTraceWindowShown=function(){var o=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");return o&&(t(o).css("visibility")==="visible"||t(o).css("visibility")==="inherit")};r.prototype.showTraceWindow=function(){if(!this.oTraceWindow&&t&&t.sap&&t.sap.log){this.initLogger(t.sap.log,false)}var o=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");if(o){t(o).css("visibility","visible")}};r.prototype.hideTraceWindow=function(){var o=this.oTraceWindow&&this.oTraceWindow.document.getElementById("sap-ui-TraceWindowRoot");if(o){t(o).css("visibility","hidden")}};r.prototype.isPropertyListShown=function(){return t(this.oPropertyWindowRoot).css("visibility")==="visible"||t(this.oPropertyWindowRoot).css("visibility")==="inherit"};r.prototype.showPropertyList=function(){if(!this.oPropertyWindowRoot){this.init(false)}t(this.oPropertyWindowRoot).css("visibility","visible")};r.prototype.hidePropertyList=function(){t(this.oPropertyWindowRoot).css("visibility","hidden")};(function(){var e=new r;sap.ui.getCore().registerPlugin(e);r.getInstance=t.sap.getter(new o(e,["isRunningEmbedded","isControlTreeShown","showControlTree","hideControlTree","isTraceWindowShown","showTraceWindow","hideTraceWindow","isPropertyListShown","showPropertyList","hidePropertyList"]))})();return r},true);