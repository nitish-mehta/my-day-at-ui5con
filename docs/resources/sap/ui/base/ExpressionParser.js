/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/thirdparty/URI","jquery.sap.strings"],function(n,e){"use strict";
//License granted by Douglas Crockford to SAP, Apache License 2.0
//    (http://www.apache.org/licenses/LICENSE-2.0)
var t=x.bind(null,undefined),r={Array:Array,Boolean:Boolean,Date:Date,encodeURIComponent:encodeURIComponent,Infinity:Infinity,isFinite:isFinite,isNaN:isNaN,JSON:JSON,Math:Math,NaN:NaN,Number:Number,Object:Object,odata:{compare:function(){var n;n=sap.ui.requireSync("sap/ui/model/odata/v4/ODataUtils");return n.compare.apply(n,arguments)},fillUriTemplate:function(){if(!e.expand){sap.ui.requireSync("sap/ui/thirdparty/URITemplate")}return e.expand.apply(e,arguments).toString()},uriEncode:function(){var n;n=sap.ui.requireSync("sap/ui/model/odata/ODataUtils");return n.formatValue.apply(n,arguments)}},parseFloat:parseFloat,parseInt:parseInt,RegExp:RegExp,String:String,undefined:undefined},u=/\d/,i="sap.ui.base.ExpressionParser",a=/[a-z_$][a-z0-9_$]*/i,s=/[a-z_$]/i,l=[i],o=i+"#parse",d={BINDING:{led:w,nud:function(n,e){return v.bind(null,n.value)}},ERROR:{lbp:Infinity,led:function(n,e,t){T(n.value.message,n.value.text,n.value.at)},nud:function(n,e){T(n.value.message,n.value.text,n.value.at)}},IDENTIFIER:{led:w,nud:function(e,t){if(!(e.value in t.globals)){n.sap.log.warning("Unsupported global identifier '"+e.value+"' in expression parser input '"+t.input+"'",undefined,i)}return x.bind(null,t.globals[e.value])}},CONSTANT:{led:w,nud:function(n,e){return x.bind(null,n.value)}},".":{lbp:18,led:function(n,e,t){return g.bind(null,t,e.advance("IDENTIFIER").value)},nud:w},"(":{lbp:17,led:function(n,e,t){var r=[],u=true;while(e.current().id!==")"){if(u){u=false}else{e.advance(",")}r.push(e.expression(0))}e.advance(")");return h.bind(null,t,r)},nud:function(n,e){var t=e.expression(0);e.advance(")");return t}},"[":{lbp:18,led:function(n,e,t){var r=e.expression(0);e.advance("]");return y.bind(null,t,r)},nud:function(n,e){var r=[],u=true;while(e.current().id!=="]"){if(u){u=false}else{e.advance(",")}r.push(e.current().id===","?t:e.expression(0))}e.advance("]");return p.bind(null,r)}},"!":{lbp:15,led:w,nud:function(n,e){return m.bind(null,e.expression(this.lbp),function(n){return!n})}},typeof:{lbp:15,led:w,nud:function(n,e){return m.bind(null,e.expression(this.lbp),function(n){return typeof n})}},"?":{lbp:4,led:function(n,e,t){var r,u;u=e.expression(this.lbp-1);e.advance(":");r=e.expression(this.lbp-1);return b.bind(null,t,u,r)},nud:w},")":{led:w,nud:w},"]":{led:w,nud:w},"{":{led:w,nud:function(n,e){var t=true,r,u={},i;while(e.current().id!=="}"){if(t){t=false}else{e.advance(",")}if(e.current()&&e.current().id==="CONSTANT"&&typeof e.current().value==="string"){r=e.advance().value}else{r=e.advance("IDENTIFIER").value}e.advance(":");i=e.expression(0);u[r]=i}e.advance("}");return N.bind(null,u)}},"}":{lbp:-1,led:w,nud:w},",":{led:w,nud:w},":":{led:w,nud:w}},f=["===","!==","!","||","&&",".","(",")","{","}",":",",","?","*","/","%","+","-","<=","<",">=",">","[","]"],c;f.forEach(function(e,t){f[t]=n.sap.escapeRegExp(e)});c=new RegExp(f.join("|"),"g");E("*",14,function(n,e){return n*e});E("/",14,function(n,e){return n/e});E("%",14,function(n,e){return n%e});E("+",13,function(n,e){return n+e}).nud=function(n,e){return m.bind(null,e.expression(this.lbp),function(n){return+n})};E("-",13,function(n,e){return n-e}).nud=function(n,e){return m.bind(null,e.expression(this.lbp),function(n){return-n})};E("<=",11,function(n,e){return n<=e});E("<",11,function(n,e){return n<e});E(">=",11,function(n,e){return n>=e});E(">",11,function(n,e){return n>e});E("in",11,function(n,e){return n in e});E("===",10,function(n,e){return n===e});E("!==",10,function(n,e){return n!==e});E("&&",7,function(n,e){return n&&e()},true);E("||",6,function(n,e){return n||e()},true);function p(n,e){return n.map(function(n){return n(e)})}function v(n,e){return e[n]}function b(n,e,t,r){return n(r)?e(r):t(r)}function x(n){return n}function g(n,e,t,r){var u=n(t),i=u[e];if(r){r.base=u}return i}function h(n,e,t){var r={};return n(t,r).apply(r.base,e.map(function(n){return n(t)}))}function I(n,e,t,r,u){return t(n(u),r?e.bind(null,u):e(u))}function N(n,e){var t,r={};for(t in n){r[t]=n[t](e)}return r}function y(n,e,t,r){var u=n(t),i=e(t),a=u[i];if(r){r.base=u}return a}function m(n,e,t){return e(n(t))}function E(n,e,t,r){d[n]={lbp:e,led:function(n,e,u){var i=r?this.lbp-1:this.lbp;return I.bind(null,u,e.expression(i),t,r)},nud:w};return d[n]}function T(e,t,r){var u=new SyntaxError(e);u.at=r;u.text=t;if(r!==undefined){e+=" at position "+r}n.sap.log.error(e,t,i);throw u}function w(n){T("Unexpected "+n.id,n.input,n.start+1)}function R(e,t,r){var i=[],l=[],o=[],d=n.sap._createJSTokenizer();function f(e,r,u){var a=false,s,o,d;function f(n){if(u){if(n.parts){n.parts.forEach(f)}else{n.targetType=n.targetType||"any"}}}for(s in e){switch(typeof e[s]){case"boolean":case"number":case"string":case"undefined":break;default:a=true}}f(e);if(a){o=n.sap.parseJS(t,r).result;f(o)}else{o=e}for(d=0;d<i.length;d+=1){if(n.sap.equal(l[d],o)){return d}}l[d]=o;i[d]=e;return d}function p(){var n,r,i,l,p;d.white();n=d.getCh();i=d.getIndex();if((n==="$"||n==="%")&&t[i+1]==="{"){r=e(t,i+1);p={id:"BINDING",value:f(r.result,i+1,n==="%")};d.setIndex(r.at)}else if(s.test(n)){l=a.exec(t.slice(i));switch(l[0]){case"false":case"null":case"true":p={id:"CONSTANT",value:d.word()};break;case"in":case"typeof":p={id:l[0]};d.setIndex(i+l[0].length);break;default:p={id:"IDENTIFIER",value:l[0]};d.setIndex(i+l[0].length)}}else if(u.test(n)||n==="."&&u.test(t[i+1])){p={id:"CONSTANT",value:d.number()}}else if(n==="'"||n==='"'){p={id:"CONSTANT",value:d.string()}}else{c.lastIndex=i;l=c.exec(t);if(!l||l.index!==i){return false}p={id:l[0]};d.setIndex(i+l[0].length)}p.input=t;p.start=i;p.end=d.getIndex();o.push(p);return true}d.init(t,r);try{while(p()){}}catch(n){if(n.name==="SyntaxError"){o.push({id:"ERROR",value:n})}else{throw n}}return{at:d.getIndex(),parts:i,tokens:o}}function S(e,t){return function(){try{return e.apply(this,arguments)}catch(e){n.sap.log.warning(String(e),t,i)}}}function O(n,e,t){var r,u=0,i={advance:s,current:l,expression:o,globals:t,input:e},a;function s(t){var r=n[u];if(t){if(!r){T("Expected "+t+" but instead saw end of input",e)}else if(r.id!==t){T("Expected "+t+" but instead saw "+e.slice(r.start,r.end),e,r.start+1)}}u+=1;return r}function l(){return n[u]}function o(t){var r;a=s();if(!a){T("Expected expression but instead saw end of input",e)}r=d[a.id].nud(a,i);while(u<n.length){a=l();if(t>=(d[a.id].lbp||0)){break}s();r=d[a.id].led(a,i,r)}return r}r=o(0);return{at:l()&&l().start,formatter:S(r,e)}}return{parse:function(e,t,u,i){var a,s;n.sap.measure.average(o,"",l);s=R(e,t,u);a=O(s.tokens,t,i||r);n.sap.measure.end(o);if(!s.parts.length){return{constant:a.formatter(),at:a.at||s.at}}function d(){return a.formatter(arguments)}d.textFragments=true;return{result:{formatter:d,parts:s.parts},at:a.at||s.at}}}},true);