/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./BindingParser","./DataType","./EventProvider","./ManagedObjectMetadata","./Object","../model/BindingMode","../model/CompositeBinding","../model/Context","../model/FormatException","../model/ParseException","../model/Type","../model/ValidateException","jquery.sap.act","jquery.sap.script","jquery.sap.strings"],function(e,t,i,n,r,s,a,o,g,d,f,p,h){"use strict";var l;var u=n.extend("sap.ui.base.ManagedObject",{metadata:{abstract:true,publicMethods:["getId","getMetadata","getModel","setModel","hasModel","bindProperty","unbindProperty","bindAggregation","unbindAggregation","bindObject","unbindObject","getObjectBinding"],library:"sap.ui.core",properties:{},aggregations:{},associations:{},events:{validationSuccess:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"}}},validationError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"},message:{type:"string"}}},parseError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"},message:{type:"string"}}},formatError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"}}},modelContextChange:{}},specialSettings:{id:"sap.ui.core.ID",models:"object",bindingContexts:"object",objectBindings:"object",metadataContexts:"object",Type:{type:"string",visibility:"hidden"}}},constructor:function(e,t,r){var s=this;n.call(this);if(typeof e!=="string"&&e!==undefined){r=t;t=e;e=t&&t.id}if(!e){e=this.getMetadata().uid()}else{var a=u._fnIdPreprocessor;e=a?a.call(this,e):e;var o=l||(l=i.getType("sap.ui.core.ID"));if(!o.isValid(e)){throw new Error('"'+e+'" is not a valid ID.')}}this.sId=e;this.mProperties=this.getMetadata().createPropertyBag();this.mAggregations={};this.mAssociations={};this.oParent=null;this.aDelegates=[];this.aBeforeDelegates=[];this.iSuppressInvalidate=0;this.oPropagatedProperties=u._oEmptyPropagatedProperties;this.mSkipPropagation={};this.oModels={};this.aPropagationListeners=[];this.oBindingContexts={};this.mElementBindingContexts={};this.mBindingInfos={};this.mObjectBindingInfos={};this._oContextualSettings=u._defaultContextualSettings;this._sOwnerId=u._sOwnerId;(function(){var e=false;if(s.register){s.register()}try{if(s._initCompositeSupport){s._initCompositeSupport(t)}if(s.init){s.init()}s.applySettings(t,r);e=true}finally{if(!e&&s.deregister){s.deregister()}}})()}},r);u.create=function(t,i,n){if(!t||t instanceof u||typeof t!=="object"||t instanceof String){return t}function r(t){if(typeof t==="function"){return t}if(typeof t==="string"){return e.sap.getObject(t)}}var s=r(t.Type)||r(i&&i.type);if(typeof s==="function"){return new s(t,n)}var a="Don't know how to create a ManagedObject from "+t+" ("+typeof t+")";e.sap.log.fatal(a);throw new Error(a)};var c;function y(e){if(!c){c=sap.ui.require("sap/ui/core/StashedControlSupport")}if(c){return c.getStashedControls(e)}return[]}u._fnIdPreprocessor=null;u._fnSettingsPreprocessor=null;u.runWithPreprocessors=function(t,i,n){e.sap.assert(typeof t==="function","fn must be a function");e.sap.assert(!i||typeof i==="object","oPreprocessors must be an object");var r={id:this._fnIdPreprocessor,settings:this._fnSettingsPreprocessor};i=i||{};this._fnIdPreprocessor=i.id;this._fnSettingsPreprocessor=i.settings;try{return t.call(n)}finally{this._fnIdPreprocessor=r.id;this._fnSettingsPreprocessor=r.settings}};u.prototype.applySettings=function(t,i){if(!t||e.isEmptyObject(t)){return this}var n=this,r=this.getMetadata(),a=r.getJSONKeys(),o=u.create,d=u._fnSettingsPreprocessor,f,p,h;function l(e){for(var t=0,r=e.length;t<r;t++){var s=e[t];if(Array.isArray(s)){l(s)}else{n[h._sMutator](o(s,h,i))}}}d&&d.call(this,t);if(t.metadataContexts&&this._processMetadataContexts){this._processMetadataContexts(t.metadataContexts,t)}if(t.models){if(typeof t.models!=="object"){throw new Error("models must be a simple object")}if(s.isA(t.models,"sap.ui.model.Model")){this.setModel(t.models)}else{for(f in t.models){this.setModel(t.models[f],f==="undefined"?undefined:f)}}}if(t.bindingContexts){if(typeof t.bindingContexts!=="object"){throw new Error("bindingContexts must be a simple object")}if(t.bindingContexts instanceof g){this.setBindingContext(t.bindingContexts)}else{for(f in t.bindingContexts){this.setBindingContext(t.bindingContexts[f],f==="undefined"?undefined:f)}}}if(t.objectBindings){if(typeof t.objectBindings!=="string"&&typeof t.objectBindings!=="object"){throw new Error("binding must be a string or simple object")}if(typeof t.objectBindings==="string"||t.objectBindings.path){this.bindObject(t.objectBindings)}else{for(var f in t.objectBindings){t.objectBindings.model=f;this.bindObject(t.objectBindings[f])}}}for(f in t){p=t[f];if((h=a[f])!==undefined){var c;switch(h._iKind){case 0:c=this.extractBindingInfo(p,i);if(c&&typeof c==="object"){this.bindProperty(f,c)}else{this[h._sMutator](c||p)}break;case 1:c=h.altTypes&&this.extractBindingInfo(p,i);if(c&&typeof c==="object"){this.bindProperty(f,c)}else{if(Array.isArray(p)){if(p.length>1){e.sap.log.error("Tried to add an array of controls to a single aggregation")}p=p[0]}this[h._sMutator](o(c||p,h,i))}break;case 2:c=this.extractBindingInfo(p,i);if(c&&typeof c==="object"){this.bindAggregation(f,c)}else{p=c||p;if(p){if(Array.isArray(p)){l(p)}else{n[h._sMutator](o(p,h,i))}}}break;case 3:this[h._sMutator](p);break;case 4:if(p){if(Array.isArray(p)){for(var y=0,m=p.length;y<m;y++){this[h._sMutator](p[y])}}else{this[h._sMutator](p)}}break;case 5:if(typeof p=="function"){this[h._sMutator](p)}else{this[h._sMutator](p[0],p[1],p[2])}break;case-1:default:break}}else{e.sap.assert(false,"ManagedObject.apply: encountered unknown setting '"+f+"' for class '"+r.getName()+"' (value:'"+p+"')")}}return this};u.escapeSettingsValue=function(e){return typeof e==="string"?u.bindingParser.escape(e):e};u.prototype.toString=function(){return"ManagedObject "+this.getMetadata().getName()+"#"+this.getId()};u.prototype.getId=function(){return this.sId};u.prototype.setProperty=function(t,i,r){var s=this.mProperties[t];i=this.validateProperty(t,i);if(e.sap.equal(s,i)){this.mProperties[t]=i;return this}if(r){e.sap.act.refresh();this.iSuppressInvalidate++}this.mProperties[t]=i;if(!this.isInvalidateSuppressed()){this.invalidate()}this.updateModelProperty(t,i,s);if(this.mEventRegistry["_change"]){n.prototype.fireEvent.call(this,"_change",{id:this.getId(),name:t,oldValue:s,newValue:i})}if(this._observer){this._observer.propertyChange(this,t,s,i)}if(r){this.iSuppressInvalidate--}return this};u.prototype.getProperty=function(e){var t=this.mProperties[e],n=this.getMetadata().getProperty(e),r;if(!n){throw new Error('Property "'+e+'" does not exist in '+this)}r=i.getType(n.type);if(r instanceof i&&r.isArrayType()&&Array.isArray(t)){t=t.slice(0)}if(t instanceof String){t=t.valueOf()}return t};u.prototype.validateProperty=function(e,t){var n=this.getMetadata().getProperty(e),r;if(!n){throw new Error('Property "'+e+'" does not exist in '+this)}r=i.getType(n.type);if(r instanceof i&&r.isArrayType()&&Array.isArray(t)){t=t.slice(0)}if(t==null){t=n.getDefaultValue()}else if(r instanceof i){if(r.getName()=="string"){if(!(typeof t=="string"||t instanceof String)){t=""+t}}else if(r.getName()=="string[]"){if(typeof t=="string"){t=[t]}if(!Array.isArray(t)){throw new Error('"'+t+'" is of type '+typeof t+", expected string[]"+' for property "'+e+'" of '+this)}for(var s=0;s<t.length;s++){if(typeof t[s]!=="string"){t[s]=""+t[s]}}}else if(!r.isValid(t)){throw new Error('"'+t+'" is of type '+typeof t+", expected "+r.getName()+' for property "'+e+'" of '+this)}}if(r&&r.normalize&&typeof r.normalize==="function"){t=r.normalize(t)}return t};u.prototype.isPropertyInitial=function(e){return!Object.prototype.hasOwnProperty.call(this.mProperties,e)&&!this.isBound(e)};u.prototype.resetProperty=function(e){if(this.mProperties.hasOwnProperty(e)){var t=this.getMetadata().getProperty(e);this[t._sMutator](null);if(this.mProperties[e]===t.getDefaultValue()){delete this.mProperties[e]}}return this};u.prototype.getOriginInfo=function(e){var t=this.mProperties[e];if(!(t instanceof String&&t.originInfo)){return null}return t.originInfo};u.prototype.setAssociation=function(t,i,n){if(i instanceof u){i=i.getId()}else if(i!=null&&typeof i!=="string"){e.sap.assert(false,"setAssociation(): sId must be a string, an instance of sap.ui.base.ManagedObject or null");return this}if(this.mAssociations[t]===i){return this}if(n){this.iSuppressInvalidate++}if(this._observer&&this.mAssociations[t]!=null){this._observer.associationChange(this,t,"remove",this.mAssociations[t])}this.mAssociations[t]=i;if(this._observer&&this.mAssociations[t]!=null){this._observer.associationChange(this,t,"insert",i)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(n){this.iSuppressInvalidate--}return this};u.prototype.getAssociation=function(e,t){var i=this.mAssociations[e];if(!i){i=this.mAssociations[e]=t||null}else{if(typeof i.length==="number"&&!i.propertyIsEnumerable("length")){return i.slice()}return i}return i};u.prototype.addAssociation=function(t,i,n){if(i instanceof u){i=i.getId()}else if(typeof i!=="string"){e.sap.assert(false,"addAssociation(): sId must be a string or an instance of sap.ui.base.ManagedObject");return this}if(n){this.iSuppressInvalidate++}var r=this.mAssociations[t];if(!r){r=this.mAssociations[t]=[i]}else{r.push(i)}if(this._observer){this._observer.associationChange(this,t,"insert",i)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(n){this.iSuppressInvalidate--}return this};u.prototype.removeAssociation=function(t,i,n){var r=this.mAssociations[t];var s=null;if(!r){return null}if(n){this.iSuppressInvalidate++}if(typeof i=="object"&&i.getId){i=i.getId()}if(typeof i=="string"){for(var a=0;a<r.length;a++){if(r[a]==i){i=a;break}}}if(typeof i=="number"){if(i<0||i>=r.length){e.sap.log.warning("ManagedObject.removeAssociation called with invalid index: "+t+", "+i)}else{s=r[i];r.splice(i,1);if(this._observer){this._observer.associationChange(this,t,"remove",s)}if(!this.isInvalidateSuppressed()){this.invalidate()}}}if(n){this.iSuppressInvalidate--}return s};u.prototype.removeAllAssociation=function(e,t){var i=this.mAssociations[e];if(!i){return[]}if(t){this.iSuppressInvalidate++}delete this.mAssociations[e];if(this._observer){this._observer.associationChange(this,e,"remove",i)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(t){this.iSuppressInvalidate--}return i};u.prototype.validateAggregation=function(t,n,r,a){var o=this.getMetadata(),g=o.getManagedAggregation(t),d,f,p,h;if(!g){throw new Error('Aggregation "'+t+'" does not exist in '+this)}if(g.multiple!==r){throw new Error("Aggregation '"+t+"' of "+this+" used with wrong cardinality (declared as "+(g.multiple?"0..n":"0..1")+")")}var l=o.getAggregationForwarder(t);if(l&&!a){l.getTarget(this).validateAggregation(l.targetAggregationName,n,r)}if(!g.multiple&&!n){return n}if(n instanceof s&&n.isA(g.type)){return n}d=g.altTypes;if(d&&d.length){if(n==null){return n}for(p=0;p<d.length;p++){f=i.getType(d[p]);if(f instanceof i){if(f.isValid(n)){return n}}}}f=e.sap.getObject(g.type);if(typeof f==="function"&&n instanceof f){return n}h='"'+n+'" is not valid for aggregation "'+t+'" of '+this;if(i.isInterfaceType(g.type)){e.sap.assert(false,h);return n}else{throw new Error(h)}};u.prototype.setAggregation=function(e,t,i){var n=this.getMetadata().getAggregationForwarder(e);if(n){t=this.validateAggregation(e,t,false,true);return n.set(this,t)}var r=this.mAggregations[e];if(r===t){return this}t=this.validateAggregation(e,t,false);if(i){this.iSuppressInvalidate++}this.mAggregations[e]=null;if(r instanceof u){r.setParent(null)}else{if(this._observer!=null&&r!=null){this._observer.aggregationChange(this,e,"remove",r)}}this.mAggregations[e]=t;if(t instanceof u){t.setParent(this,e,i)}else{if(!this.isInvalidateSuppressed()){this.invalidate()}if(this._observer!=null&&t!=null){this._observer.aggregationChange(this,e,"insert",t)}}if(i){this.iSuppressInvalidate--}return this};u.prototype.getAggregation=function(e,t){var i=this.getMetadata().getAggregationForwarder(e);if(i){return i.get(this)}var n=this.mAggregations[e];if(!n){n=this.mAggregations[e]=t||null}if(n){if(typeof n.length==="number"&&!n.propertyIsEnumerable("length")){return n.slice()}return n}else{return null}};u.prototype.indexOfAggregation=function(e,t){var i=this.getMetadata().getAggregationForwarder(e);if(i){return i.indexOf(this,t)}var n=this.mAggregations[e];if(n){if(n.length==undefined){return-2}for(var r=0;r<n.length;r++){if(n[r]==t){return r}}}return-1};u.prototype.insertAggregation=function(t,i,n,r){if(!i){return this}i=this.validateAggregation(t,i,true,true);var s=this.getMetadata().getAggregationForwarder(t);if(s){return s.insert(this,i,n)}var a=this.mAggregations[t]||(this.mAggregations[t]=[]);var o;if(n<0){o=0}else if(n>a.length){o=a.length}else{o=n}if(o!==n){e.sap.log.warning("ManagedObject.insertAggregation: index '"+n+"' out of range [0,"+a.length+"], forced to "+o)}a.splice(o,0,i);i.setParent(this,t,r);return this};u.prototype.addAggregation=function(e,t,i){if(!t){return this}t=this.validateAggregation(e,t,true,true);var n=this.getMetadata().getAggregationForwarder(e);if(n){return n.add(this,t)}var r=this.mAggregations[e];if(!r){r=this.mAggregations[e]=[t]}else{r.push(t)}t.setParent(this,e,i);return this};u.prototype.removeAggregation=function(t,i,n){var r=this.getMetadata().getAggregationForwarder(t);if(r){return r.remove(this,i)}var s=this.mAggregations[t],a=null,o;if(!s){return null}if(n){this.iSuppressInvalidate++}if(typeof i=="string"){for(o=0;o<s.length;o++){if(s[o]&&s[o].getId()===i){i=o;break}}}if(typeof i=="object"){for(o=0;o<s.length;o++){if(s[o]==i){i=o;break}}}if(typeof i=="number"){if(i<0||i>=s.length){e.sap.log.warning("ManagedObject.removeAggregation called with invalid index: "+t+", "+i)}else{a=s[i];s.splice(i,1);a.setParent(null);if(!this.isInvalidateSuppressed()){this.invalidate()}}}if(n){this.iSuppressInvalidate--}return a};u.prototype.removeAllAggregation=function(e,t){var i=this.getMetadata().getAggregationForwarder(e);if(i){return i.removeAll(this)}var n=this.mAggregations[e];if(!n){return[]}if(t){this.iSuppressInvalidate++}delete this.mAggregations[e];for(var r=0;r<n.length;r++){n[r].setParent(null)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(t){this.iSuppressInvalidate--}return n};u.prototype.destroyAggregation=function(e,t){var i=this.getMetadata().getAggregationForwarder(e);if(i){return i.destroy(this)}var n=this.mAggregations[e],r,s;y(this.getId()).forEach(function(t){if(t.sParentAggregationName===e){t.destroy()}});if(!n){return this}if(t){this.iSuppressInvalidate++}delete this.mAggregations[e];if(n instanceof u){n.destroy(t);if(this._observer){this._observer.aggregationChange(this,e,"remove",n)}}else if(Array.isArray(n)){for(r=n.length-1;r>=0;r--){s=n[r];if(s){s.destroy(t);if(this._observer){this._observer.aggregationChange(this,e,"remove",s)}}}}if(!this.isInvalidateSuppressed()){this.invalidate()}if(t){this.iSuppressInvalidate--}return this};u.prototype.invalidate=function(){if(this.oParent){this.oParent.invalidate(this)}};u.prototype.isInvalidateSuppressed=function(){var e=this.iSuppressInvalidate>0;if(this.oParent&&this.oParent instanceof u){e=e||this.oParent.isInvalidateSuppressed()}return e};u.prototype._removeChild=function(t,i,n){if(!i){e.sap.log.error("Cannot remove aggregated child without aggregation name.",null,this)}else{if(n){this.iSuppressInvalidate++}var r=this.indexOfAggregation(i,t);var s=this.getMetadata().getAggregation(i);if(r==-2){if(s&&this[s._sMutator]){this[s._sMutator](null)}else{this.setAggregation(i,null,n)}}else if(r>-1){if(s&&this[s._sRemoveMutator]){this[s._sRemoveMutator](r)}else{this.removeAggregation(i,r,n)}}if(n){this.iSuppressInvalidate--}}};function m(e,t){while(e&&e!==t){e=e.oParent}return!!e}u.prototype.setParent=function(t,i,n){e.sap.assert(t==null||t instanceof u,"oParent either must be null, undefined or a ManagedObject");if(!t){if(this.oParent){if(this.oParent._observer){this.oParent._observer.aggregationChange(this.oParent,this.sParentAggregationName,"remove",this)}}this.oParent=null;this.sParentAggregationName=null;var r=u._oEmptyPropagatedProperties;if(r!==this.oPropagatedProperties){this.oPropagatedProperties=r;if(!this._bIsBeingDestroyed){setTimeout(function(){if(!this.oParent){this.updateBindings(true,null);this.updateBindingContext(false,undefined,true);this.propagateProperties(true);this.fireModelContextChange()}}.bind(this),0)}}this._oContextualSettings=u._defaultContextualSettings;if(!this._bIsBeingDestroyed){setTimeout(function(){if(!this.oParent){this._propagateContextualSettings()}}.bind(this),0)}e.sap.act.refresh();return}if(m(t,this)){throw new Error("Cycle detected: new parent '"+t+"' is already a descendant of (or equal to) '"+this+"'")}if(n){e.sap.act.refresh();this.iSuppressInvalidate++}var s=this.getParent();if(s){s._removeChild(this,this.sParentAggregationName);if(this.aAPIParentInfos&&this.aAPIParentInfos.length){var a=this.aAPIParentInfos[this.aAPIParentInfos.length-1];if(a&&!m(t,a.parent)){delete this.aAPIParentInfos}}}this.oParent=t;this.sParentAggregationName=i;var r=t._getPropertiesToPropagate();if(r!==this.oPropagatedProperties){this.oPropagatedProperties=r;if(this.hasModel()){this.updateBindings(true,null);this.updateBindingContext(false,undefined,true);this.propagateProperties(true)}this._callPropagationListener();this.fireModelContextChange()}this._applyContextualSettings(t._oContextualSettings);if(t&&!this.isInvalidateSuppressed()){t.invalidate(this)}if(n){this.iSuppressInvalidate--}if(t._observer){t._observer.aggregationChange(t,i,"insert",this)}return this};u.prototype._applyContextualSettings=function(e){if(this._oContextualSettings!==e){this._oContextualSettings=e;this._propagateContextualSettings();this._onContextualSettingsChanged()}};u.prototype._onContextualSettingsChanged=function(){};u.prototype._propagateContextualSettings=function(){var e=this._oContextualSettings,t,i,n;for(t in this.mAggregations){i=this.mAggregations[t];if(i instanceof u){i._applyContextualSettings(e)}else if(i instanceof Array){for(n=0;n<i.length;n++){if(i[n]instanceof u){i[n]._applyContextualSettings(e)}}}}};u.prototype._getContextualSettings=function(){return this._oContextualSettings};u.prototype.getParent=function(){return this.oParent};u.prototype.destroy=function(t){if(this.bIsDestroyed){return}var i=this;this._bIsBeingDestroyed=true;if(t){this.iSuppressInvalidate++}if(this.exit){this.exit()}if(this._exitCompositeSupport){this._exitCompositeSupport()}for(var r in this.mAggregations){this.destroyAggregation(r,t)}y(this.getId()).forEach(function(e){e.destroy()});if(this.deregister){this.deregister()}if(this.oParent&&this.sParentAggregationName){this.oParent._removeChild(this,this.sParentAggregationName,t)}delete this.oParent;e.each(this.mBindingInfos,function(e,t){if(t.factory){i.unbindAggregation(e,true)}else{i.unbindProperty(e,true)}});e.each(this.mObjectBindingInfos,function(e,t){i.unbindObject(e,true)});if(t){this.iSuppressInvalidate--}if(this._observer){this._observer.objectDestroyed(this)}if(this.aAPIParentInfos){this.aAPIParentInfos=null}n.prototype.destroy.apply(this,arguments);this.setParent=function(){throw Error("The object with ID "+i.getId()+" was destroyed and cannot be used anymore.")};this.bIsDestroyed=true};u.bindingParser=t.simpleParser;u.prototype.isBinding=function(e,t){return typeof this.extractBindingInfo(e)==="object"};u.prototype.extractBindingInfo=function(e,t){if(e&&typeof e==="object"){if(e.ui5object){delete e.ui5object}else if(e.path!=undefined||e.parts){if(e.template){e.template=u.create(e.template)}return e}}if(typeof e==="string"){return u.bindingParser(e,t,true)}};u.prototype.getBindingInfo=function(e){var t=this.getMetadata().getAggregationForwarder(e);if(t&&t.forwardBinding){return t.getTarget(this).getBindingInfo(t.targetAggregationName)}return this.mBindingInfos[e]};u.prototype.bindObject=function(e){var t,i,n;if(typeof e=="string"){i=e;e={path:i,parameters:arguments[1]}}else{i=e.path}n=i.indexOf(">");if(n>0){e.model=i.substr(0,n);e.path=i.substr(n+1)}t=e.model;if(this.mObjectBindingInfos[t]){this.unbindObject(t,true)}this.mObjectBindingInfos[t]=e;if(this.getModel(t)){this._bindObject(e)}return this};u.prototype._bindObject=function(e){var t,i,n,r,s=this;var a=function(e){s.setElementBindingContext(t.getBoundContext(),n)};var o=function(e){var i=t.getDataState();if(!i){return}if(s.refreshDataState){s.refreshDataState("",i)}};n=e.model;r=this.getModel(n);i=this.getBindingContext(n);t=r.bindContext(e.path,i,e.parameters);if(e.suspended){t.suspend(true)}t.attachChange(a);e.binding=t;e.modelChangeHandler=a;e.dataStateChangeHandler=o;t.attachEvents(e.events);if(this.refreshDataState){t.attachAggregatedDataStateChange(o)}t.initialize()};u.prototype.bindContext=function(e){return this.bindObject(e)};u.prototype.unbindContext=function(e){return this.unbindObject(e)};u.prototype.unbindObject=function(e,t){var i=this.mObjectBindingInfos[e];if(i){if(i.binding){i.binding.detachChange(i.modelChangeHandler);i.binding.detachEvents(i.events);if(this.refreshDataState){i.binding.detachAggregatedDataStateChange(i.dataStateChangeHandler)}i.binding.destroy()}delete this.mObjectBindingInfos[e];delete this.mElementBindingContexts[e];if(!t){this.updateBindingContext(false,e);this.propagateProperties(e);this.fireModelContextChange()}}return this};u.prototype.bindProperty=function(e,t,i,n){var r,s=true,o=this.getMetadata().getPropertyLikeSetting(e);if(!o){throw new Error('Property "'+e+'" does not exist in '+this)}if(typeof t=="string"){t={parts:[{path:t,type:i instanceof p?i:undefined,mode:n}],formatter:typeof i==="function"?i:undefined}}if(!t.parts){t.parts=[];t.parts[0]={path:t.path,targetType:t.targetType,type:t.type,suspended:t.suspended,formatOptions:t.formatOptions,constraints:t.constraints,model:t.model,mode:t.mode};delete t.path;delete t.targetType;delete t.mode;delete t.model}for(var g=0;g<t.parts.length;g++){var d=t.parts[g];if(typeof d=="string"){d={path:d};t.parts[g]=d}r=d.path.indexOf(">");if(r>0){d.model=d.path.substr(0,r);d.path=d.path.substr(r+1)}if(t.formatter&&d.mode!=a.OneWay&&d.mode!=a.OneTime){d.mode=a.OneWay}if(!this.getModel(d.model)){s=false}}if(this.isBound(e)){this.unbindProperty(e,true)}this.mBindingInfos[e]=t;if(this._observer){this._observer.bindingChange(this,e,"prepare",t,"property")}if(s){this._bindProperty(e,t)}return this};u.prototype._bindProperty=function(t,i){var n,r,s,g,d=a.TwoWay,f,p,h=this.getMetadata().getPropertyLikeSetting(t),l=h._iKind===0?h.type:h.altTypes[0],u=this,c=[],y=function(e){u.updateProperty(t);var n=s.getDataState();if(n){var r=n.getControlMessages();if(r&&r.length>0){var o=sap.ui.getCore().getMessageManager();n.setControlMessages([]);if(r){o.removeMessages(r)}}n.setInvalidValue(undefined)}if(s.getBindingMode()===a.OneTime&&s.isResolved()){s.detachChange(y);s.detachEvents(i.events);if(this.refreshDataState){s.detachAggregatedDataStateChange(m)}s.destroy()}},m=function(){var e=s.getDataState();if(!e){return}if(u.refreshDataState){u.refreshDataState(t,e)}};i.parts.forEach(function(t){r=u.getBindingContext(t.model);n=u.getModel(t.model);f=t.type;if(typeof f=="string"){p=e.sap.getObject(f);if(typeof p!=="function"){throw new Error('Cannot find type "'+f+'" used in control "'+u.getId()+'"!')}f=new p(t.formatOptions,t.constraints)}s=n.bindProperty(t.path,r,i.parameters);s.setType(f,t.targetType||l);s.setFormatter(t.formatter);if(t.suspended){s.suspend(true)}g=t.mode||n.getDefaultBindingMode();s.setBindingMode(g);if(g!=a.TwoWay){d=a.OneWay}c.push(s)});if(c.length>1||i.formatter&&i.formatter.textFragments){f=i.type;if(typeof f=="string"){p=e.sap.getObject(f);f=new p(i.formatOptions,i.constraints)}s=new o(c,i.useRawValues,i.useInternalValues);s.setType(f,i.targetType||l);s.setBindingMode(i.mode||d)}else{s=c[0]}s.attachChange(y);if(this.refreshDataState){s.attachAggregatedDataStateChange(m)}s.setFormatter(e.proxy(i.formatter,this));i.binding=s;i.modelChangeHandler=y;i.dataStateChangeHandler=m;s.attachEvents(i.events);s.initialize();if(this._observer){this._observer.bindingChange(this,t,"ready",i,"property")}};u.prototype.unbindProperty=function(e,t){var i=this.mBindingInfos[e];if(i){if(i.binding){i.binding.detachChange(i.modelChangeHandler);if(this.refreshDataState){i.binding.detachAggregatedDataStateChange(i.dataStateChangeHandler)}i.binding.detachEvents(i.events);i.binding.destroy()}if(this._observer){this._observer.bindingChange(this,e,"remove",this.mBindingInfos[e],"property")}delete this.mBindingInfos[e];if(!t){this.resetProperty(e)}}return this};u.prototype.updateProperty=function(e){var t=this.mBindingInfos[e],i=t.binding,n=this.getMetadata().getPropertyLikeSetting(e);if(t.skipPropertyUpdate){return}try{var r=i.getExternalValue();t.skipModelUpdate=true;this[n._sMutator](r);t.skipModelUpdate=false}catch(r){t.skipModelUpdate=false;if(r instanceof d){this.fireFormatError({element:this,property:e,type:i.getType(),newValue:i.getValue(),oldValue:this[n._sGetter](),exception:r,message:r.message},false,true);t.skipModelUpdate=true;this.resetProperty(e);t.skipModelUpdate=false}else{throw r}}};u.prototype.updateModelProperty=function(e,t,i){if(this.isBound(e)){var n=this.mBindingInfos[e],r=n.binding;if(n.skipModelUpdate||r&&r.isSuspended()){return}if(r&&r.getBindingMode()==a.TwoWay){try{n.skipPropertyUpdate=true;r.setExternalValue(t);n.skipPropertyUpdate=false;var s=r.getExternalValue();if(t!=s){this.updateProperty(e)}if(r.hasValidation()){this.fireValidationSuccess({element:this,property:e,type:r.getType(),newValue:t,oldValue:i},false,true)}}catch(s){n.skipPropertyUpdate=false;if(s instanceof f){this.fireParseError({element:this,property:e,type:r.getType(),newValue:t,oldValue:i,exception:s,message:s.message},false,true)}else if(s instanceof h){this.fireValidationError({element:this,property:e,type:r.getType(),newValue:t,oldValue:i,exception:s,message:s.message},false,true)}else{throw s}}}}};var b=1;u.prototype.bindAggregation=function(t,i){var n,r,s,a,o=this.getMetadata(),g=o.getAggregation(t);if(!g){throw new Error('Aggregation "'+t+'" does not exist in '+this)}if(!g.multiple){e.sap.log.error('Binding of single aggregation "'+t+'" of '+this+" is not supported!")}if(typeof i=="string"){n=arguments[1];r=arguments[2];s=arguments[3];a=arguments[4];i={path:n,sorter:s,filters:a};if(r instanceof u){i.template=r}else if(typeof r==="function"){i.factory=r}}var d=o.getAggregationForwarder(t);if(d&&d.forwardBinding){return d.getTarget(this).bindAggregation(d.targetAggregationName,i)}if(this.isBound(t)){this.unbindAggregation(t)}if(!(i.template||i.factory)){if(g._doesNotRequireFactory){i.factory=function(){throw new Error("dummy factory called unexpectedly ")}}else{throw new Error("Missing template or factory function for aggregation "+t+" of "+this+" !")}}if(i.template){if(i.template._sapui_candidateForDestroy){e.sap.log.warning("A binding template that is marked as 'candidate for destroy' is reused in a binding. "+"You can use 'templateShareable:true' to fix this issue for all bindings that are affected "+"(The template is used in aggregation '"+t+"' of object '"+this.getId()+"'). "+"For more information, see documentation under 'Aggregation Binding'.");delete i.template._sapui_candidateForDestroy}if(i.templateShareable===undefined){i.templateShareable=b}i.factory=function(e){return i.template.clone(e)}}var f=i.path.indexOf(">");if(f>0){i.model=i.path.substr(0,f);i.path=i.path.substr(f+1)}this.mBindingInfos[t]=i;if(this._observer){this._observer.bindingChange(this,t,"prepare",i,"aggregation")}if(this.getModel(i.model)){this._bindAggregation(t,i)}return this};u.prototype._bindAggregation=function(e,t){var i=this,n,r=function(t){var n="update"+e.substr(0,1).toUpperCase()+e.substr(1);if(i[n]){var r=t&&t.getParameter("reason");if(r){i[n](r)}else{i[n]()}}else{i.updateAggregation(e)}},s=function(t){var n="refresh"+e.substr(0,1).toUpperCase()+e.substr(1);if(i[n]){i[n](t.getParameter("reason"))}else{r(t)}},a=function(t){var r=n.getDataState();if(!r){return}if(i.refreshDataState){i.refreshDataState(e,r)}};var o=this.getModel(t.model);if(this.isTreeBinding(e)){n=o.bindTree(t.path,this.getBindingContext(t.model),t.filters,t.parameters,t.sorter)}else{n=o.bindList(t.path,this.getBindingContext(t.model),t.sorter,t.filters,t.parameters);if(this.bUseExtendedChangeDetection){n.enableExtendedChangeDetection(!t.template,t.key)}}if(t.suspended){n.suspend(true)}t.binding=n;t.modelChangeHandler=r;t.modelRefreshHandler=s;t.dataStateChangeHandler=a;n.attachChange(r);n.attachRefresh(s);n.attachEvents(t.events);if(this.refreshDataState){n.attachAggregatedDataStateChange(a)}n.initialize();if(this._observer){this._observer.bindingChange(this,e,"ready",t,"aggregation")}};u.prototype.unbindAggregation=function(e,t){var i=this.getMetadata().getAggregationForwarder(e);if(i&&i.forwardBinding){return i.getTarget(this).unbindAggregation(i.targetAggregationName,t)}var n=this.mBindingInfos[e],r=this.getMetadata().getAggregation(e);if(n){if(n.binding){n.binding.detachChange(n.modelChangeHandler);n.binding.detachRefresh(n.modelRefreshHandler);n.binding.detachEvents(n.events);if(this.refreshDataState){n.binding.detachAggregatedDataStateChange(n.dataStateChangeHandler)}n.binding.destroy()}if(n.template){if(!n.templateShareable&&n.template.destroy){n.template.destroy()}if(n.templateShareable===b){n.template._sapui_candidateForDestroy=true}}if(this._observer){this._observer.bindingChange(this,e,"remove",this.mBindingInfos[e],"aggregation")}delete this.mBindingInfos[e];if(!t){this[r._sDestructor]()}}return this};u.prototype.updateAggregation=function(t){var i=this.mBindingInfos[t],n=i.binding,a=i.factory,o=this.getMetadata().getAggregation(t),g,d,f,p=o._sMutator+"Group",h=this;function l(e,t){if(h.bUseExtendedChangeDetection){return r.uid("clone")}else{return e.getId()+"-"+t}}function u(e,t,n,r){var s=e[o._sGetter]()||[],g,d;if(s.length>t.length){for(var f=t.length;f<s.length;f++){d=s[f];e[o._sRemoveMutator](d);d.destroy("KeepDom")}}for(var f=0;f<t.length;f++){g=t[f];d=s[f];if(n){n(g)}if(d){d.setBindingContext(g,i.model)}else{d=a(l(e,f),g);d.setBindingContext(g,i.model);e[o._sMutator](d)}if(r){r(g,d)}}}function c(t,n){var r=n.diff,s=t[o._sGetter]()||[],g,d,f,p;if(!r||s.length===0){u(t,n);return}for(p=0;p<r.length;p++){g=r[p];switch(g.type){case"insert":f=n[g.index];d=a(l(t,g.index),f);d.setBindingContext(f,i.model);t[o._sInsertMutator](d,g.index);break;case"delete":d=t[o._sRemoveMutator](g.index);d.destroy("KeepDom");break;default:e.sap.log.error('Unknown diff type "'+g.type+'"')}}s=t[o._sGetter]()||[];for(p=0;p<s.length;p++){s[p].setBindingContext(n[p])}}function y(e){var t=n.getGroup(e);if(t.key!==g){var r;if(i.groupHeaderFactory){r=i.groupHeaderFactory(t)}h[p](t,r);g=t.key}}function m(e,t){u(e,t,null,function(e,t){m(t,n.getNodeContexts(e))})}if(s.isA(n,"sap.ui.model.ListBinding")){f=n.getContexts(i.startIndex,i.length);d=n.isGrouped()&&h[p];if(d||n.bWasGrouped){this[o._sDestructor]();u(this,f,d?y:undefined)}else if(this.bUseExtendedChangeDetection){c(this,f)}else{if(!i.template){this[o._sDestructor]()}u(this,f)}n.bWasGrouped=d}else if(s.isA(n,"sap.ui.model.TreeBinding")){if(!i.template){this[o._sDestructor]()}m(this,n.getRootContexts())}};u.prototype.refreshAggregation=function(e){var t=this.mBindingInfos[e],i=t.binding;i.getContexts(t.startIndex,t.length)};u.prototype.propagateMessages=function(t,i){e.sap.log.warning("Message for "+this+", Property "+t)};u.prototype.isTreeBinding=function(e){return false};u.prototype.updateBindings=function(e,t){var i=this,n,r;function s(n){var r=n.parts,s;if(r){if(r.length==1){return(e||r[0].model==t)&&!n.binding.updateRequired(i.getModel(r[0].model))}else{for(s=0;s<r.length;s++){if((e||r[s].model==t)&&!n.binding.aBindings[s].updateRequired(i.getModel(r[s].model))){return true}}}}else{return(e||n.model==t)&&!n.binding.updateRequired(i.getModel(n.model))}}function a(e){var t=e.parts,n;if(t){for(n=0;n<t.length;n++){if(!i.getModel(t[n].model)){return false}}return true}else{return!!i.getModel(e.model)}}function o(e){if(i.refreshDataState){i.refreshDataState(n,e.binding.getDataState())}e.binding.detachChange(e.modelChangeHandler);if(e.modelRefreshHandler){e.binding.detachRefresh(e.modelRefreshHandler)}e.binding.detachEvents(e.events);e.binding.destroy();delete e.binding;delete e.modelChangeHandler;delete e.dataStateChangeHandler;delete e.modelRefreshHandler}for(n in this.mObjectBindingInfos){r=this.mObjectBindingInfos[n];if(r.binding&&s(r)){o(r)}if(!r.binding&&a(r)){this._bindObject(r)}}for(n in this.mBindingInfos){r=this.mBindingInfos[n];if(r.binding&&s(r)){if(this._observer){var g=r.factory?"aggregation":"property";this._observer.bindingChange(this,n,"remove",r,g)}o(r)}if(!r.binding&&a(r)){if(r.factory){this._bindAggregation(n,r)}else{this._bindProperty(n,r)}}}};u.prototype.isBound=function(e){return!!this.getBindingInfo(e)};u.prototype.getObjectBinding=function(e){return this.mObjectBindingInfos[e]&&this.mObjectBindingInfos[e].binding};u.prototype.getEventingParent=function(){return this.oParent};u.prototype.getBinding=function(e){var t=this.getBindingInfo(e);return t&&t.binding};u.prototype.getBindingPath=function(e){var t=this.getBindingInfo(e);return t&&(t.path||t.parts&&t.parts[0]&&t.parts[0].path)};u.prototype.setBindingContext=function(t,i){e.sap.assert(i===undefined||typeof i==="string"&&!/^(undefined|null)?$/.test(i),"sModelName must be a string or omitted");var n=this.oBindingContexts[i];if(g.hasChanged(n,t)){if(t===undefined){delete this.oBindingContexts[i]}else{this.oBindingContexts[i]=t}this.updateBindingContext(false,i);this.propagateProperties(i);this.fireModelContextChange()}return this};u.prototype.setElementBindingContext=function(t,i){e.sap.assert(i===undefined||typeof i==="string"&&!/^(undefined|null)?$/.test(i),"sModelName must be a string or omitted");var n=this.mElementBindingContexts[i];if(g.hasChanged(n,t)){if(t===undefined){delete this.mElementBindingContexts[i]}else{this.mElementBindingContexts[i]=t}this.updateBindingContext(true,i);this.propagateProperties(i);this.fireModelContextChange()}return this};u.prototype.updateBindingContext=function(e,t,i){var n,r={},s,a,o,d,f;if(i){for(s in this.oModels){if(this.oModels.hasOwnProperty(s)){r[s]=s}}for(s in this.oPropagatedProperties.oModels){if(this.oPropagatedProperties.oModels.hasOwnProperty(s)){r[s]=s}}}else{r[t]=t}for(s in r){if(r.hasOwnProperty(s)){s=s==="undefined"?undefined:s;n=this.getModel(s);d=this.mObjectBindingInfos[s];if(n&&d&&!e){if(!d.binding){this._bindObject(d)}else{a=this._getBindingContext(s);if(g.hasChanged(d.binding.getContext(),a)){d.binding.setContext(a)}}continue}a=this.getBindingContext(s);for(o in this.mBindingInfos){var d=this.mBindingInfos[o],p=d.binding,h=d.parts;if(!p){continue}if(h&&h.length>1){for(f=0;f<h.length;f++){if(h[f].model==s){p.aBindings[f].setContext(a)}}}else if(d.factory){if(d.model==s){p.setContext(a)}}else{if(h[0].model==s){p.setContext(a)}}}}}};u.prototype.getBindingContext=function(e){var t=this.getModel(e),i=this.mElementBindingContexts[e];if(i&&!t){return i}else if(i&&t&&i.getModel()===t){return i}else if(i===null){return i}else{return this._getBindingContext(e)}};u.prototype._getBindingContext=function(e){var t=this.getModel(e),i=this.oBindingContexts[e],n=this.oPropagatedProperties.oBindingContexts[e];if(i&&!t){return this.oBindingContexts[e]}else if(i&&t&&i.getModel()===t){return this.oBindingContexts[e]}else if(i===null){return i}else if(n&&t&&n.getModel()!==t){return undefined}else{return n}};u.prototype.setModel=function(t,i){e.sap.assert(t==null||s.isA(t,"sap.ui.model.Model"),"oModel must be an instance of sap.ui.model.Model, null or undefined");e.sap.assert(i===undefined||typeof i==="string"&&!/^(undefined|null)?$/.test(i),"sName must be a string or omitted");if(!t&&this.oModels[i]){delete this.oModels[i];this.propagateProperties(i);this.updateBindings(false,i);this.fireModelContextChange()}else if(t&&t!==this.oModels[i]){this.oModels[i]=t;this.propagateProperties(i);this.updateBindingContext(false,i);this.updateBindings(false,i);this.fireModelContextChange()}return this};u.prototype.addPropagationListener=function(t){e.sap.assert(typeof t==="function","listener must be a function");this.aPropagationListeners.push(t);this.propagateProperties(false);this._callPropagationListener(t);return this};u.prototype.removePropagationListener=function(t){e.sap.assert(typeof t==="function","listener must be a function");var i=this.aPropagationListeners;var n=i.indexOf(t);if(n>=0){i.splice(n,1);this.propagateProperties(false)}return this};u.prototype.getPropagationListeners=function(){return this.oPropagatedProperties.aPropagationListeners.concat(this.aPropagationListeners)};u.prototype._callPropagationListener=function(e){var t;if(e){e(this)}else{t=this.getPropagationListeners();for(var i=0;i<t.length;i++){e=t[i];e(this)}}return this};u._oEmptyPropagatedProperties={oModels:{},oBindingContexts:{},aPropagationListeners:[]};u.prototype.propagateProperties=function(e){var t=this._getPropertiesToPropagate(),i=e===true,n=e===false,r=i?undefined:e,s,a,o;for(s in this.mAggregations){if(this.mSkipPropagation[s]){continue}a=this.mAggregations[s];if(a instanceof u){this._propagateProperties(e,a,t,i,r,n)}else if(a instanceof Array){for(o=0;o<a.length;o++){if(a[o]instanceof u){this._propagateProperties(e,a[o],t,i,r,n)}}}}};u.prototype._propagateProperties=function(e,t,i,n,r,s){if(!i){i=this._getPropertiesToPropagate();n=e===true;s=e===false;r=n?undefined:e}if(t.oPropagatedProperties!==i){t.oPropagatedProperties=i;if(s!==true){t.updateBindings(n,r);t.updateBindingContext(false,r,n)}t.propagateProperties(e);if(s||n){t._callPropagationListener()}t.fireModelContextChange()}};u.prototype._getPropertiesToPropagate=function(){var t=e.isEmptyObject(this.oModels),i=e.isEmptyObject(this.oBindingContexts),n=this.aPropagationListeners.length===0,r=e.isEmptyObject(this.mElementBindingContexts);function s(t,i,n,r){return t?i:e.extend({},i,n,r)}function a(e,t,i){return e?t:t.concat(i)}if(i&&t&&r&&n){return this.oPropagatedProperties}else{return{oModels:s(t,this.oPropagatedProperties.oModels,this.oModels),oBindingContexts:s(i&&r,this.oPropagatedProperties.oBindingContexts,this.oBindingContexts,this.mElementBindingContexts),aPropagationListeners:a(n,this.oPropagatedProperties.aPropagationListeners,this.aPropagationListeners)}}};u.prototype.getModel=function(t){e.sap.assert(t===undefined||typeof t==="string"&&!/^(undefined|null)?$/.test(t),"sModelName must be a string or omitted");return this.oModels[t]||this.oPropagatedProperties.oModels[t]};u.prototype.hasModel=function(){return!(e.isEmptyObject(this.oModels)&&e.isEmptyObject(this.oPropagatedProperties.oModels))};u.prototype.clone=function(t,i,n){var s=true,a=true;if(n){s=!!n.cloneChildren;a=!!n.cloneBindings}if(!t){t=r.uid("clone")||e.sap.uid()}if(!i&&s){i=this.findAggregatedObjects(true).map(function(e){return e.getId()})}var o=this.getMetadata(),g=o._oClass,d=this.getId()+"-"+t,f={},p=this.mProperties,h,l,c,m=u.bindingParser.escape,v;var P=Object.keys(p);v=P.length;while(v>0){h=P[--v];if(!(this.isBound(h)&&a)){if(typeof p[h]==="string"){f[h]=m(p[h])}else{f[h]=p[h]}}}f["models"]=this.oModels;f["bindingContexts"]=this.oBindingContexts;if(s){for(l in this.mAggregations){var C=this.mAggregations[l];if(o.hasAggregation(l)&&!(this.isBound(l)&&a)){if(C instanceof u){f[l]=C.clone(t,i)}else if(Array.isArray(C)){f[l]=[];for(var v=0;v<C.length;v++){f[l].push(C[v].clone(t,i))}}else{f[l]=C}}}var A=y(this.getId());for(var v=0,x=A.length;v<x;v++){var _=A[v].clone(t);_.sParentId=d;_.sParentAggregationName=A[v].sParentAggregationName}for(l in this.mAssociations){var I=this.mAssociations[l];if(Array.isArray(I)){I=I.slice(0);for(var v=0;v<I.length;v++){if(i.indexOf(I[v])>=0){I[v]+="-"+t}}}else if(i.indexOf(I)>=0){I+="-"+t}f[l]=I}}c=new g(d,f);for(l in this.mObjectBindingInfos){c.mObjectBindingInfos[l]=e.extend({},this.mObjectBindingInfos[l])}for(l in this.mEventRegistry){c.mEventRegistry[l]=this.mEventRegistry[l].slice()}if(a){for(l in this.mBindingInfos){var B=this.mBindingInfos[l];var M=e.extend({},B);if(!B.templateShareable&&B.template&&B.template.clone){M.template=B.template.clone(t,i);delete M.factory}else if(B.templateShareable===b){B.templateShareable=M.templateShareable=true;e.sap.log.error("During a clone operation, a template was found that neither was marked with 'templateShareable:true' nor 'templateShareable:false'. "+"The framework won't destroy the template. This could cause errors (e.g. duplicate IDs) or memory leaks "+"(The template is used in aggregation '"+l+"' of object '"+this.getId()+"')."+"For more information, see documentation under 'Aggregation Binding'.")}delete M.binding;delete M.modelChangeHandler;delete M.dataStateChangeHandler;delete M.modelRefreshHandler;if(B.factory||B.template){c.bindAggregation(l,M)}else{c.bindProperty(l,M)}}}if(u._supportInfo){u._supportInfo.addSupportInfo(c.getId(),u._supportInfo.byId(this.getId()))}if(this._cloneMetadataContexts){this._cloneMetadataContexts(c)}return c};u._handleLocalizationChange=function(t){var i;if(t===1){e.each(this.oModels,function(e,t){if(t&&t._handleLocalizationChange){t._handleLocalizationChange()}})}else if(t===2){e.each(this.mBindingInfos,function(e,t){var n=t.parts;if(n){for(i=0;i<n.length;i++){if(t.type&&t.type._handleLocalizationChange){t.type._handleLocalizationChange()}}if(t.modelChangeHandler){t.modelChangeHandler()}}})}};u.prototype.findAggregatedObjects=function(e,t){var i=[];if(t&&typeof t!=="function"){t=null}function n(r){var s,a,o;for(o in r.mAggregations){s=r.mAggregations[o];if(Array.isArray(s)){for(a=0;a<s.length;a++){if(!t||t(s[a])){i.push(s[a])}if(e){n(s[a])}}}else if(s instanceof u){if(!t||t(s)){i.push(s)}if(e){n(s)}}}}n(this);return i};u._defaultContextualSettings={};return u});