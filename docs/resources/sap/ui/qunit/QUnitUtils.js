/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define("sap/ui/qunit/QUnitUtils",["jquery.sap.global","sap/ui/Device","sap/ui/base/DataType","jquery.sap.script","jquery.sap.keycodes"],function(e,t,r){"use strict";if(typeof QUnit!=="undefined"){var n=!(parseFloat(QUnit.version)>=2);var a=e.sap.getUriParameters();if(n){QUnit.equals=window.equals=window.equal}var i=a.get("sap-ui-qunittimeout");if(!i||isNaN(i)){i="30000"}QUnit.config.testTimeout=parseInt(i,10);if(n){QUnit.config.reorder=false}if(window["sap-ui-qunit-coverage"]!=="client"&&/x|true/i.test(a.get("coverage-report"))){QUnit.done(function(e,t){if(window._$blanket){var r=window.QUnit;window.QUnit=undefined;sap.ui.requireSync("sap/ui/thirdparty/blanket");window.QUnit=r;window.blanket.report({})}})}}e.now=function(){return Date.now()};if(t.browser.phantomJS){var o=e.fn.is;e.fn.is=function(e){if(e===":focus"){return this.get(0)===document.activeElement}return o.apply(this,arguments)};var s=Date,u=s.parse;Date=function(e){if(arguments.length===1&&typeof e==="string"){return new s(Date.parse(e))}var t=Array.prototype.slice.call(arguments);t.unshift(window);if(this instanceof s){return new(Function.prototype.bind.apply(s,t))}else{return s.apply(window,t)}};var f=function(e){var t=u.apply(Date,arguments);if(e&&typeof e==="string"){var r=/^(\d{4})(?:-(\d+)?-(\d+))(?:[T ](\d+):(\d+)(?::(\d+)(?:\.(\d+))?)?)?(?:Z(-?\d*))?$/.exec(e);if(r&&parseInt(r[1],10)>=2034){t+=24*60*60*1e3}}return t};Object.defineProperties(Date,{parse:{value:f,enumerable:false},toString:{value:function(){return s.toString.call(this)},enumerable:false},now:{value:s.now,enumerable:false},UTC:{value:s.UTC,enumerable:false},prototype:{value:s.prototype,enumerable:false}})}var l={};l.delayTestStart=function(t){QUnit.config.autostart=false;if(t){window.setTimeout(function(){QUnit.start()},t)}else{e(function(){QUnit.start()})}};var v=e.noop;try{new e.Event({type:"mousedown"}).preventDefault()}catch(t){v=function(t){if(t){t.preventDefault=t.preventDefault||e.noop;t.stopPropagation=t.stopPropagation||e.noop;t.stopImmediatePropagation=t.stopImmediatePropagation||e.noop}};var p=e.Event;e.Event=function(e,t){var r=new p(e,t);v(r.originalEvent);return r};e.Event.prototype=p.prototype}function c(t,r,n){var a=e.Event({type:t});if(r!=null){a.target=r}if(n){for(var i in n){a[i]=n[i];if(i==="originalEvent"){v(a[i])}else{a.originalEvent[i]=n[i]}}}return a}l.triggerEvent=function(t,r,n){if(typeof r=="string"){r=r?document.getElementById(r):null}var a=c(t,null,n);e(r).trigger(a)};l.triggerTouchEvent=function(t,r,n,a){if(typeof r=="string"){r=r?document.getElementById(r):null}var i=c(t,r,n),o=e(r).control(0),s=(a==null?"on":a)+t;if(o&&o[s]){o[s].call(o,i)}};l.triggerKeyEvent=function(t,r,n,a,i,o){var s={};s.keyCode=isNaN(n)?e.sap.KeyCodes[n]:n;s.which=s.keyCode;s.shiftKey=a;s.altKey=i;s.metaKey=o;s.ctrlKey=o;l.triggerEvent(t,r,s)};l.triggerKeydown=function(e,t,r,n,a){l.triggerKeyEvent("keydown",e,t,r,n,a)};l.triggerKeyup=function(e,t,r,n,a){l.triggerKeyEvent("keyup",e,t,r,n,a)};l.triggerKeyboardEvent=function(e,t,r,n,a){l.triggerKeydown(e,t,r,n,a)};l.triggerKeypress=function(t,r,n,a,i){var o=r&&r.toUpperCase();if(e.sap.KeyCodes[o]===null){QUnit.ok(false,"Invalid character for triggerKeypress: '"+r+"'")}var s=r.charCodeAt(0);var u={};u.charCode=s;u.which=s;u.shiftKey=!!n;u.altKey=!!a;u.metaKey=!!i;u.ctrlKey=!!i;l.triggerEvent("keypress",t,u)};l.triggerCharacterInput=function(t,r){l.triggerKeypress(t,r);if(typeof t=="string"){t=t?document.getElementById(t):null}var n=e(t);n.val(n.val()+r)};l.triggerMouseEvent=function(e,t,r,n,a,i,o){var s={};s.offsetX=r;s.offsetY=n;s.pageX=a;s.pageY=i;s.button=o;l.triggerEvent(t,e,s)};var g={normal:400,bold:700};e.fn.extend({_sapTest_dataEvents:function(){var t=this[0];return t?e._data(t,"events"):null},_sapTest_cssFontWeight:function(){var e=this.css("font-weight");return e?g[e]||e:e}});(function(){function t(t){e.sap.log.info(t)}var n={boolean:[false,true],int:[0,1,5,10,100],float:[NaN,0,.01,3.14,97.7],string:["","some","very long otherwise not normal and so on whatever","<"+"script>alert('XSS attack!');</"+"script>"]};var a=Object.create(n);function i(e){return e&&!(e instanceof Array)?[e]:e}l.resetDefaultTestValues=function(e){if(typeof e==="string"){delete a[e]}else{a=Object.create(n)}};l.setDefaultTestValues=function(t,r){if(typeof t==="string"){a[t]=i(r)}else if(typeof t==="object"){e.extend(a,t)}};l.createSettingsDomain=function(t,n){function o(t){if(a[t]){return a[t]}try{e.sap.require(t)}catch(e){}var n=e.sap.getObject(t);if(!(n instanceof r)){var i=[];for(var o in n){i.push(n[o])}a[t]=i;return i}return[]}var t=(new t).getMetadata().getClass();var n=n||{};var s={};var u=t.getMetadata().getAllProperties();for(var f in u){s[f]=i(n[f])||o(u[f].type)}return s};l.genericTest=function(e,r,n){if(n&&n.skip===true){return}var e=(new e).getMetadata().getClass();var n=n||{};var a=l.createSettingsDomain(e,n.allPairTestValues||{});t("domain");for(var i in a){var o=a[i].length;var s=[];s.push("  ",i,":","[");for(var u=0;u<o;u++){s.push(a[i][u],",")}s.push("]");t(s.join(""))}function f(e,t){return e+t.substring(0,1).toUpperCase()+t.substring(1)}function v(e,t){var r={};for(var n in t){if(e[f("get",n)]){r[n]=e[f("get",n)]()}}return r}var p;var c;var g=new l.AllPairsGenerator(a);var d=[];while(g.hasNext()){d.push(g.next())}var y=0;function h(){t("testNextCombination("+y+")");if(y>=d.length){t("last combination -> done");QUnit.start();return}p=new e(c);var n=v(p,c);QUnit.deepEqual(n,c,"settings");p.placeAt(r);t("before explicit rerender");p.getUIArea().rerender();t("after explicit rerender");t("info");setTimeout(w,0)}QUnit.stop(15e3);h();function w(){t("continueAfterRendering("+y+")");var e=d[d.length-y-1];for(var r in e){var n=p[f("set",r)](e[r]);QUnit.equal(p[f("get",r)](),e[r],"setter for property '"+r+"'");QUnit.ok(n==p,"setter for property '"+r+"' supports chaining (after rendering)")}y=y+1;setTimeout(h,0)}};l.suppressErrors=function(e){if(e!==false){t("suppress global errors")}else{t("reenable global errors")}};l.RandomPairsGenerator=function(e){var t=0;for(var r in e){if(e[r]&&!(e[r]instanceof Array)){e[r]=[e[r]]}if(e[r]&&e[r].length>0){if(t==0){t=e[r].length}else{t=t*e[r].length}}}function n(t){var r={};for(var n in e){var a=e[n]&&e[n].length;if(a==1){r[n]=e[n][0]}else if(a>1){var i=t%a;r[n]=e[n][i];t=(t-i)/a}}return r}this.hasNext=function(){return true};this.next=function(){return n(Math.floor(100*t*Math.random()))}};l.AllPairsGenerator=function(e){var t=[];for(var r in e){t.push({name:r,n:e[r].length,values:e[r]})}var n=t.length;var a=[];var i=[];var o=0;for(var s=0;s<n-1;s++){var u=t[s];for(var f=s+1;f<n;f++){var l=t[f];i[s*n+f]=o;for(var v=u.n*l.n;v>0;v--){a[o++]=0}}}function p(e,r,a,o){return i[e*n+r]+a*t[r].n+o}function c(){var e=[];function r(r,i){var o={va:i,pairs:0,redundant:0};for(var s=0;s<n;s++){var u;if(s<r){u=a[p(s,r,e[s],i)]}else if(s>r){var f=p(r,s,i,0),l=f+t[s].n;for(u=a[f];u>0&&v<l;f++){if(a[f]<u){u=a[f]}}}o.redundant=o.redundant+u;if(u==0){o.pairs++}}return o}for(var i=0;i<n;i++){var o=t[i];var s=r(i,0);for(var u=1;u<o.n;u++){var f=r(i,u);if(f.pairs>s.pairs||f.pairs==s.pairs&&f.redundant<s.redundant){s=f}}e[i]=s.va}return e}this.hasNext=function(){return o>0};var g;var d=-1;this.next=function(){g=c();d=0;var e={};for(var r=0;r<n;r++){for(var i=r+1;i<n;i++){var s=p(r,i,g[r],g[i]);if(a[s]==0){o--;d++}a[s]++}e[t[r].name]=t[r].values[g[r]]}return e};this.lastPairs=function(){return d}}})();e.sap.setObject("sap.ui.test.qunit",l);window.qutils=l;return l},true);