/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Control","sap/ui/core/format/NumberFormat","./CurrencyRenderer"],function(e,t,r,i){"use strict";var s=t.extend("sap.ui.unified.Currency",{metadata:{library:"sap.ui.unified",properties:{value:{type:"float",group:"Appearance",defaultValue:0},stringValue:{type:"string",group:"Appearance",defaultValue:null},currency:{type:"string",group:"Appearance",defaultValue:null},maxPrecision:{type:"int",group:"Appearance",defaultValue:3},useSymbol:{type:"boolean",group:"Appearance",defaultValue:true}},designtime:"sap/ui/unified/designtime/Currency.designtime"}});s.FIGURE_SPACE=" ";s.PUNCTUATION_SPACE=" ";s.prototype.init=function(){this._oFormat=r.getCurrencyInstance({showMeasure:false})};s.prototype.exit=function(){this._oFormat=null;this._$Value=null;this._$Currency=null;this._sLastCurrency=null;this._iLastCurrencyDigits=null;this._bRenderNoValClass=null};s.prototype.onAfterRendering=function(){if(this.$()){this._$Value=this.$().find(".sapUiUfdCurrencyValue");this._$Currency=this.$().find(".sapUiUfdCurrencyCurrency")}};s.prototype.setValue=function(e){if(this.isBound("value")){this._bRenderNoValClass=e==null;if(this.$()){this.$().toggleClass("sapUiUfdCurrencyNoVal",this._bRenderNoValClass)}}this.setProperty("value",e,true);this._renderValue();return this};s.prototype.unbindProperty=function(e){t.prototype.unbindProperty.apply(this,arguments);if(e==="value"){this._bRenderNoValClass=false;if(this.$()){this.$().toggleClass("sapUiUfdCurrencyNoVal",false)}}};s.prototype.setCurrency=function(t){var r,i;this.setProperty("currency",t,true);this._renderCurrency();r=this._oFormat.oLocaleData.getCurrencyDigits(t);if(e.isNumeric(this._iLastCurrencyDigits)&&this._iLastCurrencyDigits!==r){i=true}this._iLastCurrencyDigits=r;if(this._sLastCurrency==="*"||t==="*"){i=true}this._sLastCurrency=t;if(i){this._renderValue();if(t==="*"&&this.$()){this._bRenderNoValClass=false;this.$().toggleClass("sapUiUfdCurrencyNoVal",false)}}return this};s.prototype.setUseSymbol=function(e){this.setProperty("useSymbol",e,true);this._renderCurrency();return this};s.prototype.setMaxPrecision=function(e){this.setProperty("maxPrecision",e,true);this._renderValue();return this};s.prototype._renderValue=function(){if(this._$Value){this._$Value.text(this.getFormattedValue())}};s.prototype._renderCurrency=function(){if(this._$Currency){this._$Currency.text(this._getCurrency())}};s.prototype._getCurrency=function(){return this.getUseSymbol()?this.getCurrencySymbol():this.getCurrency()};s.prototype.getFormattedValue=function(){var t=this.getCurrency(),r,i,n,u;if(t==="*"){return""}n=this._oFormat.oLocaleData.getCurrencyDigits(t);r=this.getMaxPrecision();r=r<=0&&n>0?r-1:r;i=r-n;u=this._oFormat.format(this.getStringValue()||this.getValue(),t);if(i==r&&r>0){u+=s.PUNCTUATION_SPACE}if(i>0){u=e.sap.padRight(u,s.FIGURE_SPACE,u.length+i)}else if(i<0){u=u.substr(0,u.length+i)}return u};s.prototype.getCurrencySymbol=function(){return this._oFormat.oLocaleData.getCurrencySymbol(this.getCurrency())};s.prototype.getAccessibilityInfo=function(){if(this._bRenderNoValClass){return{}}return{description:(this.getFormattedValue()||"")+" "+(this.getCurrency()||"").trim()}};return s});