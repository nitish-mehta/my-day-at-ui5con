/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/unified/calendar/CalendarUtils","sap/ui/unified/calendar/CalendarDate","./library","sap/ui/unified/CalendarDateInterval","sap/ui/unified/CalendarDateIntervalRenderer","sap/ui/unified/calendar/OneMonthDatesRow","sap/ui/core/Renderer","sap/ui/unified/Calendar","sap/ui/unified/CalendarRenderer","./CalendarOneMonthIntervalRenderer"],function(t,e,a,n,o,i,s,r,h,c,u){"use strict";var d=o.extend("sap.ui.unified.CalendarOneMonthInterval",{});d.prototype.init=function(){o.prototype.init.apply(this,arguments);this._bShowOneMonth=true};d.prototype._getCalendarPicker=function(){var a=this.getAggregation("calendarPicker");if(!a){a=new g(this.getId()+"--Cal");a.setPopupMode(true);a.attachEvent("select",function(){var t=this._getCalendarPicker(),a=t._getFocusedDate(),n=e._getFirstDateOfMonth(a);this._setStartDate(n);this._adjustSelectedDate(n,false);this._oFocusDateOneMonth=n;this._closeCalendarPicker(true);this._focusDate(a,false,true)},this);a.attachEvent("cancel",function(e){var a=this._getCalendarPicker(),n=a._getFocusedDate();this._closeCalendarPicker(true);this._oFocusDateOneMonth=n;this._focusDate(n,true);t.sap.focus(this.getAggregation("header").getDomRef("B1"))},this);this.setAggregation("calendarPicker",a)}return a};d.prototype._createMonth=function(t){return new s(t)};d.prototype._handleFocus=function(t){var n=!!t.getParameter("_outsideBorder"),i=t.getParameter("date"),s=a.fromLocalJSDate(i),r=a.fromLocalJSDate(this.getStartDate()),h=!e._isSameMonthAndYear(s,r),c,u,d;if(n||h){if(e._isLastDateInMonth(s)){this._oFocusDateOneMonth=s}else{this._oFocusDateOneMonth=e._getFirstDateOfMonth(s)}c=s.isBefore(r)?-1:1;u=new a(this._getFocusedDate(),this.getPrimaryCalendarType());d=new a(this._getStartDate(),this.getPrimaryCalendarType());o.prototype._shiftStartFocusDates.call(this,u,d,c)}return o.prototype._handleFocus.apply(this,arguments)};d.prototype._focusDateExtend=function(t,e,a){var n,i;if(!this._oFocusDateOneMonth){return o.prototype._focusDateExtend.apply(this,arguments)}n=this.getAggregation("month")[0];i=this._oFocusDateOneMonth.toLocalJSDate();this._setFocusedDate(this._oFocusDateOneMonth);n._bNoRangeCheck=true;n.setDate(i);n._bNoRangeCheck=false;this._oFocusDateOneMonth=null;return!a};d.prototype._setDisplayMode=function(t){this.getAggregation("month")[0].setMode(t)};d.prototype._shiftStartFocusDates=function(t,e,a){var n=a,o=this.getAggregation("month")[0];if(n!==0){n=n>0?1:-1}t.setMonth(t.getMonth()+n);e.setYear(t.getYear());e.setMonth(t.getMonth());e.setDate(t.getDate());this._setFocusedDate(e);this._setStartDate(t,true);o.selectDate(t.toLocalJSDate())};d.prototype._adjustSelectedDate=function(t,a){var n=this.getAggregation("month")[0],o;o=a?e._getFirstDateOfMonth(t):t;if(n.getMode&&n.getMode()<2){this._selectDate(o)}};d.prototype._selectDate=function(t){var e=this.getAggregation("month")[0],a=t.toLocalJSDate();this.removeAllSelectedDates();this.addSelectedDate(new sap.ui.unified.DateRange({startDate:a}));e.selectDate(a);this._bDateRangeChanged=undefined};d.prototype._dateMatchesVisibleRange=function(t){return e._isSameMonthAndYear(a.fromLocalJSDate(this.getStartDate()),a.fromLocalJSDate(t))};var g=h.extend("CustomMonthPicker",{renderer:r.extend(c)});g.prototype._initializeHeader=function(){var t=new sap.ui.unified.calendar.Header(this.getId()+"--Head",{visibleButton1:false});t.attachEvent("pressPrevious",this._handlePrevious,this);t.attachEvent("pressNext",this._handleNext,this);t.attachEvent("pressButton2",this._handleButton2,this);this.setAggregation("header",t)};g.prototype._shouldFocusB2OnTabNext=function(e){return t.sap.containsOrEquals(this.getDomRef("content"),e.target)};g.prototype.onAfterRendering=function(){this._showMonthPicker()};g.prototype._selectYear=function(){var t=this.getAggregation("yearPicker");var e=this._getFocusedDate();e.setYear(t.getYear());this._focusDate(e,true);this._showMonthPicker()};g.prototype._selectMonth=function(){var t=this.getAggregation("monthPicker");var e=this.getSelectedDates()[0];var a=this._getFocusedDate();a.setMonth(t.getMonth());if(!e){e=new sap.ui.unified.DateRange}e.setStartDate(a.toLocalJSDate());this.addSelectedDate(e);this.fireSelect()};g.prototype.onsapescape=function(t){this.fireCancel()};return d});