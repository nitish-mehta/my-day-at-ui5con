/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/ValueStateSupport","./MenuItemBase","./library","sap/ui/core/library","sap/ui/Device","jquery.sap.events"],function(t,e,i,s,a,r){"use strict";var n=a.ValueState;var o=i.extend("sap.ui.unified.MenuTextFieldItem",{metadata:{library:"sap.ui.unified",properties:{label:{type:"string",group:"Appearance",defaultValue:null},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},value:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:n.None}}}});(function(){o.prototype.render=function(t,e,i,s){var a=t,r=i.checkEnabled(e),n=e.getId();var o="sapUiMnuItm sapUiMnuTfItm";if(s.iItemNo==1){o+=" sapUiMnuItmFirst"}else if(s.iItemNo==s.iTotalItems){o+=" sapUiMnuItmLast"}if(!i.checkEnabled(e)){o+=" sapUiMnuItmDsbl"}if(e.getStartsSection()){o+=" sapUiMnuItmSepBefore"}a.write("<li ");a.writeAttribute("class",o);a.writeElementData(e);if(s.bAccessible){a.writeAttribute("role","menuitem");a.writeAttribute("aria-disabled",!r);a.writeAttribute("aria-posinset",s.iItemNo);a.writeAttribute("aria-setsize",s.iTotalItems)}a.write('><div class="sapUiMnuItmL"></div>');a.write('<div class="sapUiMnuItmIco">');if(e.getIcon()){a.writeIcon(e.getIcon(),null,{title:null})}a.write("</div>");a.write('<div id="'+n+'-txt" class="sapUiMnuItmTxt">');a.write('<label id="'+n+'-lbl" class="sapUiMnuTfItemLbl">');a.writeEscaped(e.getLabel()||"");a.write("</label>");a.write('<div id="'+n+'-str" class="sapUiMnuTfItmStretch"></div>');a.write('<div class="sapUiMnuTfItemWrppr">');a.write('<input id="'+n+'-tf" tabindex="-1"');a.writeAttributeEscaped("value",e.getValue()||"");a.writeAttribute("class",r?"sapUiMnuTfItemTf sapUiMnuTfItemTfEnbl":"sapUiMnuTfItemTf sapUiMnuTfItemTfDsbl");if(!r){a.writeAttribute("disabled","disabled")}if(s.bAccessible){a.writeAccessibilityState(e,{role:"textbox",disabled:!r,multiline:false,autocomplete:"none",labelledby:{value:n+"-lbl",append:true}})}a.write("/></div></div>");a.write('<div class="sapUiMnuItmR"></div>');a.write("</li>")};o.prototype.hover=function(e,i){this.$().toggleClass("sapUiMnuItmHov",e);if(e&&i.checkEnabled(this)){i.closeSubmenu(false,true);if(r.browser.msie){t.sap.delayedCall(0,this,function(){this.$("tf").focus()}.bind(this))}else{this.$("tf").focus()}}};o.prototype.onAfterRendering=function(){this._adaptSizes();this.setValueState(this.getValueState())};o.prototype.onsapup=function(t){this.getParent().focus();this.getParent().onsapprevious(t)};o.prototype.onsapdown=function(t){this.getParent().focus();this.getParent().onsapnext(t)};o.prototype.onsaphome=function(t){if(this._checkCursorPosForNav(false)){this.getParent().focus();this.getParent().onsaphome(t)}};o.prototype.onsapend=function(t){if(this._checkCursorPosForNav(true)){this.getParent().focus();this.getParent().onsapend(t)}};o.prototype.onsappageup=function(t){this.getParent().focus();this.getParent().onsappageup(t)};o.prototype.onsappagedown=function(t){this.getParent().focus();this.getParent().onsappagedown(t)};o.prototype.onsapescape=function(t){this.getParent().onsapescape(t)};o.prototype.onkeydown=function(t){t.stopPropagation()};o.prototype.onclick=function(t){this.getParent().closeSubmenu(false,true);if(!r.system.desktop&&this.getParent().checkEnabled(this)){this.focus()}t.stopPropagation()};o.prototype.onkeyup=function(e){if(!t.sap.PseudoEvents.sapenter.fnCheck(e)){return}var i=this.$("tf").val();this.setValue(i);this.getParent().selectItem(this);e.preventDefault();e.stopPropagation()};o.prototype.setSubmenu=function(e){t.sap.log.warning("The aggregation 'submenu' is not supported for this type of menu item.","","sap.ui.unified.MenuTextFieldItem");return this};o.prototype.setLabel=function(t){this.setProperty("label",t,true);this.$("lbl").text(t);this._adaptSizes();return this};o.prototype.setValue=function(t){this.setProperty("value",t,true);this.$("tf").val(t);return this};o.prototype.setValueState=function(t){this.setProperty("valueState",t,true);var i=this.$("tf");i.toggleClass("sapUiMnuTfItemTfErr",t==n.Error);i.toggleClass("sapUiMnuTfItemTfWarn",t==n.Warning);var s=e.enrichTooltip(this,this.getTooltip_AsString());this.$().attr("title",s?s:"");return this};o.prototype.getFocusDomRef=function(){var t=this.$("tf");return t.length?t.get(0):null};o.prototype._adaptSizes=function(){var t=this.$("tf");var e=this.$("lbl");var i=e.length?e.get(0).offsetLeft:0;if(sap.ui.getCore().getConfiguration().getRTL()){t.parent().css({width:"auto",right:this.$().outerWidth(true)-i+(e.outerWidth(true)-e.outerWidth())+"px"})}else{t.parent().css({width:"auto",left:i+e.outerWidth(true)+"px"})}};o.prototype._checkCursorPosForNav=function(t){var e=sap.ui.getCore().getConfiguration().getRTL();var i=t?e:!e;var s=this.$("tf");var a=s.cursorPos();var r=s.val().length;if(e){a=r-a}if(!i&&a!=r||i&&a!=0){return false}return true}})();return o});