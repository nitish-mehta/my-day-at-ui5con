/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global"],function(e){"use strict";return{display:function(e){var t=Promise.resolve();return this._display(e,t).catch(function(e){if(e instanceof Error){return Promise.reject(e)}else{return e}})},_display:function(e,t){if(this._oParent){t=this._oParent._display(e,t)}return this._place(e,t)},_place:function(t,n){if(t instanceof Promise){n=t;t=undefined}var r=this._oOptions,o=this,i,a,s,l;if(r.viewName){a=this._getEffectiveViewName(r.viewName);s={viewName:a,type:r.viewType,id:r.viewId,async:r.async};if(this._bUseRawViewId){i=this._oViews._getViewWithGlobalId(s)}else{i=this._oViews._getView(s)}n=n.then(function(e){return i.loaded().then(function(t){o._bindTitleInTitleProvider(t);o._addTitleProviderAsDependent(t);return{view:t,parentInfo:e||{}}},function(e){return Promise.reject({name:r.name,error:e})})}).then(function(n){var s=o._isValid(n.parentInfo);if(s!==true){l=s;return o._refuseInvalidTarget(r.name,l)}var d=n.parentInfo.view,f=n.parentInfo.control,u=Promise.resolve(f);i=n.view;if(!d&&r.rootView){d=sap.ui.getCore().byId(r.rootView);if(!d){l="Did not find the root view with the id "+r.rootView;return o._refuseInvalidTarget(r.name,l)}}if(r.controlId){if(d){u=d.loaded().then(function(e){return e.byId(r.controlId)})}u=u.then(function(e){if(!e){e=sap.ui.getCore().byId(r.controlId)}if(!e){l="Control with ID "+r.controlId+" could not be found";return o._refuseInvalidTarget(r.name,l)}else{return e}}).catch(function(){l="Something went wrong during loading the root view with id "+r.rootView;return o._refuseInvalidTarget(r.name,l)})}return u.then(function(n){if(n.error){return n}o._beforePlacingViewIntoContainer({container:n,view:i,data:t});var s=n.getMetadata().getJSONKeys()[r.controlAggregation];if(!s){l="Control "+r.controlId+" does not have an aggregation called "+r.controlAggregation;return o._refuseInvalidTarget(r.name,l)}if(r.clearControlAggregation===true){n[s._sRemoveAllMutator]()}e.sap.log.info("Did place the view '"+a+"' with the id '"+i.getId()+"' into the aggregation '"+r.controlAggregation+"' of a control with the id '"+n.getId()+"'",o);n[s._sMutator](i);o.fireDisplay({view:i,control:n,config:o._oOptions,data:t});return{name:r.name,view:i,control:n}})})}else{n=n.then(function(){return{name:r.name}})}return n},_isValid:function(t){var n=this._oOptions,r=t&&t.control,o=r||n.controlId,i=true,a="";if(!o){a="The target "+n.name+" has no controlId set and no parent so the target cannot be displayed.";i=false}if(!n.controlAggregation){a="The target "+n.name+" has a control id or a parent but no 'controlAggregation' was set, so the target could not be displayed.";i=false}if(a){e.sap.log.error(a,this)}return i||a},_refuseInvalidTarget:function(t,n){if(n){e.sap.log.error(n,this)}return{name:t,error:n}}}});