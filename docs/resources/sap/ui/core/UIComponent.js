/*
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","../base/ManagedObject","./Component","./library","./UIComponentMetadata","./mvc/Controller","./mvc/View"],function(t,e,o,i,n,r,s){"use strict";var a=i.mvc.ViewType;var u=o.extend("sap.ui.core.UIComponent",{constructor:function(t,e){var i=false;try{o.apply(this,arguments);i=true}finally{if(!i){this._destroyCreatedInstances()}}},metadata:{abstract:true,rootView:null,publicMethods:["render"],aggregations:{rootControl:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},designtime:"sap/ui/core/designtime/UIComponent.designtime",routing:{}}},n);u._fnOnInstanceInitialized=null;u._fnOnInstanceDestroy=null;u.prototype.init=function(){var t=this;var o={};if(this.getAutoPrefixId()){o.id=function(e){return t.createId(e)}}var i=this._getManifestEntry("/sap.ui5/routing",true)||{},n=i.config||{},r=i.routes;if(r){var a=sap.ui.requireSync("sap/ui/core/routing/Router");var g=f(this._getRouterClassName()||a);this._oRouter=new g(r,n,this,i.targets);this._oTargets=this._oRouter.getTargets();this._oViews=this._oRouter.getViews()}else if(i.targets){var p=sap.ui.requireSync("sap/ui/core/routing/Targets");var c=sap.ui.requireSync("sap/ui/core/routing/Views");this._oViews=new c({component:this});var d=f(n.targetsClass||p);this._oTargets=new d({targets:i.targets,config:n,views:this._oViews})}this.runAsOwner(function(){e.runWithPreprocessors(function(){t.setAggregation("rootControl",t.createContent())},o)});var l=this.getRootControl();if(l instanceof s){if(n.targetParent===undefined){n.targetParent=l.getId()}if(this._oTargets){this._oTargets._setRootViewId(l.getId())}}if(typeof u._fnOnInstanceInitialized==="function"){u._fnOnInstanceInitialized(this)}};function f(e){var o;if(typeof e==="string"){o=t.sap.getObject(e);if(!o){t.sap.log.error("The specified class for router or targets '"+e+"' is undefined.",this)}}else{o=e}return o}u.prototype.destroy=function(){if(typeof u._fnOnInstanceDestroy==="function"){u._fnOnInstanceDestroy(this)}this._destroyCreatedInstances();o.prototype.destroy.apply(this,arguments)};u.prototype._destroyCreatedInstances=function(){if(this._oRouter){this._oRouter.destroy();delete this._oRouter}if(this._oTargets){this._oTargets.destroy();this._oTargets=null}if(this._oViews){this._oViews.destroy();this._oViews=null}};u.getRouterFor=function(t){var e=t;if(e instanceof r){e=e.getView()}if(e instanceof s){var i=o.getOwnerComponentFor(e);if(i){return i.getRouter()}else{return undefined}}};u.prototype.getRouter=function(){return this._oRouter};u.prototype.getTargets=function(){return this._oTargets};u.prototype.getAutoPrefixId=function(){return!!this.getManifestObject().getEntry("/sap.ui5/autoPrefixId")};u.prototype.byId=function(t){return sap.ui.getCore().byId(this.createId(t))};u.prototype.createId=function(t){if(!this.isPrefixedId(t)){t=this.getId()+"---"+t}return t};u.prototype.getLocalId=function(t){var e=this.getId()+"---";return t&&t.indexOf(e)===0?t.slice(e.length):null};u.prototype.isPrefixedId=function(t){return!!(t&&t.indexOf(this.getId()+"---")===0)};u.prototype.createContent=function(){var t=this._getManifestEntry("/sap.ui5/rootView",true);if(t&&typeof t==="string"){return sap.ui.view({viewName:t,type:a.XML})}else if(t&&typeof t==="object"){if(t.id){t.id=this.createId(t.id)}return sap.ui.view(t)}else if(t){throw new Error("Configuration option 'rootView' of component '"+this.getMetadata().getName()+"' is invalid! 'rootView' must be type of string or object!")}return null};u.prototype.getRootControl=function(){return this.getAggregation("rootControl")};u.prototype.render=function(t){var e=this.getRootControl();if(e&&t){t.renderControl(e)}};u.prototype.getUIArea=function(){return this.oContainer?this.oContainer.getUIArea():null};u.prototype.getEventingParent=function(){return this.getUIArea()};u.prototype.setContainer=function(t){this.oContainer=t;if(t){this._applyContextualSettings(t._getContextualSettings())}else{this._oContextualSettings=e._defaultContextualSettings;if(!this._bIsBeingDestroyed){setTimeout(function(){if(!this.oContainer){this._propagateContextualSettings()}}.bind(this),0)}}return this};u.prototype.onBeforeRendering=function(){};u.prototype.onAfterRendering=function(){};u.prototype._getRouterClassName=function(){var t=this._getManifestEntry("/sap.ui5/routing",true)||{},e=t.config||{};return e.routerClass};return u});