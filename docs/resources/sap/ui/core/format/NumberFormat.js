/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/Object","sap/ui/core/Locale","sap/ui/core/LocaleData"],function(e,t,i,n){"use strict";var r=t.extend("sap.ui.core.format.NumberFormat",{constructor:function(e){throw new Error}});var a=/0+(\.0+)?/;var o={INTEGER:"integer",FLOAT:"float",CURRENCY:"currency",UNIT:"unit",PERCENT:"percent"};var s={FLOOR:"floor",CEILING:"ceiling",TOWARDS_ZERO:"towards_zero",AWAY_FROM_ZERO:"away_from_zero",HALF_FLOOR:"half_floor",HALF_CEILING:"half_ceiling",HALF_TOWARDS_ZERO:"half_towards_zero",HALF_AWAY_FROM_ZERO:"half_away_from_zero"};var u={};u[s.FLOOR]=Math.floor;u[s.CEILING]=Math.ceil;u[s.TOWARDS_ZERO]=function(e){return e>0?Math.floor(e):Math.ceil(e)};u[s.AWAY_FROM_ZERO]=function(e){return e>0?Math.ceil(e):Math.floor(e)};u[s.HALF_TOWARDS_ZERO]=function(e){return e>0?Math.ceil(e-.5):Math.floor(e+.5)};u[s.HALF_AWAY_FROM_ZERO]=function(e){return e>0?Math.floor(e+.5):Math.ceil(e-.5)};u[s.HALF_FLOOR]=function(e){return Math.ceil(e-.5)};u[s.HALF_CEILING]=Math.round;r.RoundingMode=s;r.oDefaultIntegerFormat={minIntegerDigits:1,maxIntegerDigits:99,minFractionDigits:0,maxFractionDigits:0,groupingEnabled:false,groupingSize:3,groupingSeparator:",",decimalSeparator:".",plusSign:"+",minusSign:"-",isInteger:true,type:o.INTEGER,showMeasure:false,style:"standard",parseAsString:false,roundingMode:r.RoundingMode.TOWARDS_ZERO,emptyString:NaN,showScale:true};r.oDefaultFloatFormat={minIntegerDigits:1,maxIntegerDigits:99,minFractionDigits:0,maxFractionDigits:99,groupingEnabled:true,groupingSize:3,groupingSeparator:",",decimalSeparator:".",plusSign:"+",minusSign:"-",isInteger:false,type:o.FLOAT,showMeasure:false,style:"standard",parseAsString:false,roundingMode:r.RoundingMode.HALF_AWAY_FROM_ZERO,emptyString:NaN,showScale:true};r.oDefaultPercentFormat={minIntegerDigits:1,maxIntegerDigits:99,minFractionDigits:0,maxFractionDigits:99,groupingEnabled:true,groupingSize:3,groupingSeparator:",",decimalSeparator:".",plusSign:"+",minusSign:"-",percentSign:"%",isInteger:false,type:o.PERCENT,showMeasure:false,style:"standard",parseAsString:false,roundingMode:r.RoundingMode.HALF_AWAY_FROM_ZERO,emptyString:NaN,showScale:true};r.oDefaultCurrencyFormat={minIntegerDigits:1,maxIntegerDigits:99,groupingEnabled:true,groupingSize:3,groupingSeparator:",",decimalSeparator:".",plusSign:"+",minusSign:"-",isInteger:false,type:o.CURRENCY,showMeasure:true,currencyCode:true,currencyContext:"standard",style:"standard",parseAsString:false,roundingMode:r.RoundingMode.HALF_AWAY_FROM_ZERO,emptyString:NaN,showScale:true};r.oDefaultUnitFormat={minIntegerDigits:1,maxIntegerDigits:99,groupingEnabled:true,groupingSize:3,groupingSeparator:",",decimalSeparator:".",plusSign:"+",minusSign:"-",isInteger:false,type:o.UNIT,showMeasure:true,style:"standard",customUnits:undefined,allowedUnits:undefined,parseAsString:false,roundingMode:r.RoundingMode.HALF_AWAY_FROM_ZERO,emptyString:NaN,showScale:true};r.getInstance=function(e,t){return this.getFloatInstance(e,t)};r.getFloatInstance=function(t,i){var n=this.createInstance(t,i),r=this.getLocaleFormatOptions(n.oLocaleData,o.FLOAT);n.oFormatOptions=e.extend(false,{},this.oDefaultFloatFormat,r,t);return n};r.getIntegerInstance=function(t,i){var n=this.createInstance(t,i),r=this.getLocaleFormatOptions(n.oLocaleData,o.INTEGER);n.oFormatOptions=e.extend(false,{},this.oDefaultIntegerFormat,r,t);return n};r.getCurrencyInstance=function(t,i){var n=this.createInstance(t,i),r=t&&t.currencyContext,a=this.getLocaleFormatOptions(n.oLocaleData,o.CURRENCY,r);n.oFormatOptions=e.extend(false,{},this.oDefaultCurrencyFormat,a,t);return n};r.getUnitInstance=function(t,i){var n=this.createInstance(t,i),r=this.getLocaleFormatOptions(n.oLocaleData,o.UNIT);n.oFormatOptions=e.extend(false,{},this.oDefaultUnitFormat,r,t);return n};r.getPercentInstance=function(t,i){var n=this.createInstance(t,i),r=this.getLocaleFormatOptions(n.oLocaleData,o.PERCENT);n.oFormatOptions=e.extend(false,{},this.oDefaultPercentFormat,r,t);return n};r.createInstance=function(t,r){var a=Object.create(this.prototype),o;if(t instanceof i){r=t;t=undefined}if(!r){r=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale()}a.oLocale=r;a.oLocaleData=n.getInstance(r);a.oOriginalFormatOptions=t;if(t){if(t.pattern){o=this.parseNumberPattern(t.pattern);e.each(o,function(e,i){t[e]=i})}if(t.emptyString!==undefined){e.sap.assert(typeof t.emptyString!=="string","The format option 'emptyString' can not be with type 'string'");e.sap.assert(t.emptyString===0||t.emptyString===null||t.emptyString!==t.emptyString,"The format option 'emptyString' must be either 0, null or NaN")}}return a};r.getLocaleFormatOptions=function(e,t,i){var n,r;switch(t){case o.PERCENT:r=e.getPercentPattern();break;case o.CURRENCY:r=e.getCurrencyPattern(i);break;case o.UNIT:r=e.getDecimalPattern();break;default:r=e.getDecimalPattern()}n=this.parseNumberPattern(r);n.plusSign=e.getNumberSymbol("plusSign");n.minusSign=e.getNumberSymbol("minusSign");n.decimalSeparator=e.getNumberSymbol("decimal");n.groupingSeparator=e.getNumberSymbol("group");n.percentSign=e.getNumberSymbol("percentSign");n.pattern=r;switch(t){case o.FLOAT:case o.PERCENT:n.minFractionDigits=0;n.maxFractionDigits=99;break;case o.INTEGER:n.minFractionDigits=0;n.maxFractionDigits=0;n.groupingEnabled=false;break;case o.CURRENCY:n.minFractionDigits=undefined;n.maxFractionDigits=undefined;break}return n};r.parseNumberPattern=function(e){var t=0,i=0,n=0,r=false,a=0,o=0,s=e.indexOf(";"),u={Integer:0,Fraction:1},g=u.Integer;if(s!==-1){e=e.substring(0,s)}for(var l=0;l<e.length;l++){var c=e[l];switch(c){case",":if(r){a=o;o=0}r=true;break;case".":g=u.Fraction;break;case"0":if(g===u.Integer){t++;if(r){o++}}else{i++;n++}break;case"#":if(g===u.Integer){if(r){o++}}else{n++}break}}if(!a){a=o;o=0}return{minIntegerDigits:t,minFractionDigits:i,maxFractionDigits:n,groupingEnabled:r,groupingSize:a,groupingBaseSize:o}};r.prototype.format=function(t,i){if(Array.isArray(t)){i=t[1];t=t[0]}var n="",a="",s="",u="",l="",f="",m=0,d=0,h=0,F=0,S=t<0,D=-1,y=e.extend({},this.oFormatOptions),R=this.oOriginalFormatOptions,b,E,O,N,C,I;if(t===y.emptyString||isNaN(t)&&isNaN(y.emptyString)){return""}if(y.type===o.UNIT){if(y.customUnits&&typeof y.customUnits==="object"){C=y.customUnits[i]}else{I=this.oLocaleData.getUnitFromMapping(i)||i;C=this.oLocaleData.getUnitFormat(I)}y.decimals=C&&(typeof C.decimals==="number"&&C.decimals>=0)?C.decimals:y.decimals;y.precision=C&&(typeof C.precision==="number"&&C.precision>=0)?C.precision:y.precision}if(y.decimals!==undefined){y.minFractionDigits=y.decimals;y.maxFractionDigits=y.decimals}if(y.shortLimit===undefined||Math.abs(t)>=y.shortLimit){O=y.shortRefNumber===undefined?t:y.shortRefNumber;E=g(O,y,this.oLocaleData);if(E&&E.formatString!="0"){t=t/E.magnitude;if(y.shortDecimals!==undefined){y.minFractionDigits=y.shortDecimals;y.maxFractionDigits=y.shortDecimals}else{if(R.minFractionDigits===undefined&&R.maxFractionDigits===undefined&&R.decimals===undefined&&R.precision===undefined&&R.pattern===undefined){y.precision=2}if(R.maxFractionDigits===undefined&&R.decimals===undefined){y.maxFractionDigits=99}}y.roundingMode=r.RoundingMode.HALF_AWAY_FROM_ZERO}}if(y.precision!==undefined){y.maxFractionDigits=Math.min(y.maxFractionDigits,p(t,y.precision));y.minFractionDigits=Math.min(y.minFractionDigits,y.maxFractionDigits)}if(y.type==o.PERCENT){t=r._shiftDecimalPoint(t,2)}if(y.type==o.CURRENCY){var L=this.oLocaleData.getCurrencyDigits(i);if(y.maxFractionDigits===undefined){y.maxFractionDigits=L}if(y.minFractionDigits===undefined){y.minFractionDigits=L}}if(typeof t==="number"){t=c(t,y.maxFractionDigits,y.roundingMode)}if(t==0){S=false}l=this.convertToDecimal(t);if(l=="NaN"){return l}if(S){l=l.substr(1)}D=l.indexOf(".");if(D>-1){n=l.substr(0,D);a=l.substr(D+1)}else{n=l}if(n.length<y.minIntegerDigits){n=e.sap.padLeft(n,"0",y.minIntegerDigits)}else if(n.length>y.maxIntegerDigits){n=e.sap.padLeft("","?",y.maxIntegerDigits)}if(a.length<y.minFractionDigits){a=e.sap.padRight(a,"0",y.minFractionDigits)}else if(a.length>y.maxFractionDigits){a=a.substr(0,y.maxFractionDigits)}d=n.length;if(y.groupingEnabled){h=y.groupingSize;F=y.groupingBaseSize||h;m=Math.max(d-F,0)%h||h;s=n.substr(0,m);while(d-m>=F){s+=y.groupingSeparator;s+=n.substr(m,h);m+=h}s+=n.substr(m)}else{s=n}if(S){u=y.minusSign}u+=s;if(a){u+=y.decimalSeparator+a}if(E&&E.formatString&&y.showScale&&y.type!==o.CURRENCY){N=this.oLocaleData.getPluralCategory(n+"."+a);E.formatString=this.oLocaleData.getDecimalFormat(y.style,E.key,N);u=E.formatString.replace(E.valueSubString,u);u=u.replace(/'.'/g,".")}if(y.type===o.CURRENCY){f=y.pattern;if(E&&E.formatString&&y.showScale){N=this.oLocaleData.getPluralCategory(n+"."+a);f=this.oLocaleData.getCurrencyFormat("short",E.key,N);f=f.replace(/'.'/g,".")}b=f.split(";");if(b.length===2){f=S?b[1]:b[0];if(S){u=u.substring(1)}}if(!y.currencyCode){i=this.oLocaleData.getCurrencySymbol(i)}u=this._composeCurrencyResult(f,u,i,{showMeasure:y.showMeasure,negative:S,minusSign:y.minusSign})}if(y.type===o.PERCENT){f=y.pattern;u=f.replace(/[0#.,]+/,u);u=u.replace(/%/,y.percentSign)}if(y.showMeasure&&y.type===o.UNIT){N=this.oLocaleData.getPluralCategory(n+"."+a);e.sap.assert(N,"Cannot find plural category for "+(n+"."+a));var M=!y.allowedUnits||y.allowedUnits.indexOf(i)>=0;if(!M){e.sap.assert(M,"The given unit '"+i+"' is not part of the allowed unit types: ["+y.allowedUnits.join(",")+"].");return""}if(C){f=C["unitPattern-count-"+N];if(!f){f=C["unitPattern-count-other"]}e.sap.assert(f,"Cannot find pattern 'unitPattern-count-"+N+"' in '"+i+"'");if(!f){return""}u=f.replace("{0}",u)}else{e.sap.assert(C,"Unit '"+i+"' is unknown");return""}}if(sap.ui.getCore().getConfiguration().getOriginInfo()){u=new String(u);u.originInfo={source:"Common Locale Data Repository",locale:this.oLocale.toString()}}return u};r.prototype._composeCurrencyResult=function(e,t,i,n){var r=n.minusSign;e=e.replace(/[0#.,]+/,t);if(n.showMeasure&&i){var a="¤",o={"[:digit:]":/\d/,"[:^S:]":/[^\$\xA2-\xA5\u058F\u060B\u09F2\u09F3\u09FB\u0AF1\u0BF9\u0E3F\u17DB\u20A0-\u20BD\uA838\uFDFC\uFE69\uFF04\uFFE0\uFFE1\uFFE5\uFFE6]/},s=e.indexOf(a),u=s<e.length/2?"after":"before",g=this.oLocaleData.getCurrencySpacing(u),l=u==="after"?i.charAt(i.length-1):i.charAt(0),c,f=o[g.currencyMatch],p=o[g.surroundingMatch],m;e=e.replace(a,i);c=u==="after"?e.charAt(s+i.length):e.charAt(s-1);if(f&&f.test(l)&&p&&p.test(c)){if(u==="after"){m=s+i.length}else{m=s}e=e.slice(0,m)+g.insertBetween+e.slice(m)}else if(n.negative&&u==="after"){r="\ufeff"+n.minusSign}}else{e=e.replace(/\s*\u00a4\s*/,"")}if(n.negative){e=e.replace(/-/,r)}return e};r.prototype.parse=function(t){var i=this.oFormatOptions,n=f(i.plusSign+i.minusSign),a=f(i.groupingSeparator),s=f(i.decimalSeparator),u="^\\s*(["+n+"]?(?:[0-9"+a+"]+|[0-9"+a+"]*"+s+"[0-9]*)(?:[eE][+-][0-9]+)?)\\s*$",g="^\\s*(["+n+"]?[0-9"+a+"]+)\\s*$",c=new RegExp(a,"g"),p=new RegExp(s,"g"),d=this.oLocaleData.getNumberSymbol("percentSign"),h,F,S,D,y,R,b,E=0,O,N;if(t===""){N=i.emptyString;if(i.parseAsString&&(i.emptyString===0||isNaN(i.emptyString))){N=i.emptyString+""}if(i.type===o.CURRENCY){return[N,undefined]}else{return N}}b=i.type===o.PERCENT?i.pattern:this.oLocaleData.getPercentPattern();if(b.charAt(0)==="%"){u=u.slice(0,1)+"%?"+u.slice(1)}else if(b.charAt(b.length-1)==="%"){u=u.slice(0,u.length-1)+"%?"+u.slice(u.length-1)}var C;if(i.type===o.UNIT){var I;if(i.customUnits&&typeof i.customUnits==="object"){I=i.customUnits}else{I=this.oLocaleData.getUnitFormats()}e.sap.assert(I,"Unit patterns cannot be loaded");if(i.allowedUnits){var L={};for(var M=0;M<i.allowedUnits.length;M++){var v=i.allowedUnits[M];L[v]=I[v]}I=L}var A=m(I,t);C=A.cldrCode;if(C.length===1){R=C[0]}else if(C.length===0){e.sap.assert(C.length===1,"Cannot find unit for input: '"+t+"'");return null}else{e.sap.assert(C.length===1,"Ambiguous unit ["+C.join(", ")+"] for input: '"+t+"'");R=undefined}t=A.numberValue||t}t=t.replace(/\s/g,"");O=l(t,this.oFormatOptions.style,this.oLocaleData);if(O){t=O.number;h=new RegExp(u)}else if(i.isInteger){h=new RegExp(g)}else if(i.type===o.CURRENCY){D="[^\\d\\s+-]*";S="(?:^("+D+")"+u.substring(1,u.length-1)+"$)|(?:^"+u.substring(1,u.length-1)+"("+D+")\\s*$)";h=new RegExp(S)}else{h=new RegExp(u)}if(!h.test(t)){return i.type===o.CURRENCY||i.type===o.UNIT?null:NaN}if(i.type===o.CURRENCY){y=h.exec(t);if(y[2]){t=y[2];R=y[1]||undefined}else{t=y[3];R=y[4]||undefined}if(R&&!i.showMeasure){return null}if(R){R=this.oLocaleData.getCurrencyCodeBySymbol(R)||R}}t=t.replace(c,"");t=t.replace(i.plusSign,"+");t=t.replace(i.minusSign,"-");t=t.replace(/^\+/,"");if(O){t=t.replace(p,".");t=r._shiftDecimalPoint(t,Math.round(Math.log(O.factor)/Math.LN10))}if(i.isInteger){E=i.parseAsString?t:parseInt(t,10)}else{t=t.replace(p,".");if(t.indexOf(d)!==-1){F=true;t=t.replace(d,"")}E=i.parseAsString?t:parseFloat(t);if(F){E=r._shiftDecimalPoint(E,-2)}}if(i.parseAsString){E=r._shiftDecimalPoint(t,0)}if(i.type===o.CURRENCY||i.type===o.UNIT){return[E,R]}return E};r.prototype.convertToDecimal=function(e){var t=""+e,i,n,r,a,o,s;if(t.indexOf("e")==-1&&t.indexOf("E")==-1){return t}var u=t.match(/^([+-]?)((\d+)(?:\.(\d+))?)[eE]([+-]?\d+)$/);i=u[1]=="-";n=u[2].replace(/\./g,"");r=u[3]?u[3].length:0;a=u[4]?u[4].length:0;o=parseInt(u[5],10);if(o>0){if(o<a){s=r+o;t=n.substr(0,s)+"."+n.substr(s)}else{t=n;o-=a;for(var g=0;g<o;g++){t+="0"}}}else{if(-o<r){s=r+o;t=n.substr(0,s)+"."+n.substr(s)}else{t=n;o+=r;for(var g=0;g>o;g--){t="0"+t}t="0."+t}}if(i){t="-"+t}return t};r.prototype.getScale=function(){if(this.oFormatOptions.style!=="short"&&this.oFormatOptions.style!=="long"||this.oFormatOptions.shortRefNumber===undefined){return}var e=g(this.oFormatOptions.shortRefNumber,this.oFormatOptions,this.oLocaleData),t;if(e&&e.formatString){t=e.formatString.replace(a,"").replace(/'.'/g,".").trim();if(t){return t}}};r._shiftDecimalPoint=function(t,i){if(typeof i!=="number"){return NaN}var n=t.toString().toLowerCase().split("e");if(typeof t==="number"){i=n[1]?+n[1]+i:i;return+(n[0]+"e"+i)}else if(typeof t==="string"){if(parseInt(t,10)===0&&i>=0){return t}t=n[0];var r=t.indexOf("."),a,o,s;if(r===-1){t=t+".";r=t.length-1}if(n[1]){r+=+n[1]}a=r+i;if(a<=0){t=e.sap.padLeft(t,"0",t.length-a+1);a=1}else if(a>=t.length-1){t=e.sap.padRight(t,"0",a+1);a=t.length-1}t=t.replace(".","");o=t.substring(0,a);s=t.substring(a);o=o.replace(/^(-?)0+(\d)/,"$1$2");return o+(s?"."+s:"")}else{return null}};function g(e,t,i){var n,r,o,s=t.style,u=t.precision!==undefined?t.precision:2;if(s!="short"&&s!="long"){return undefined}for(var g=0;g<14;g++){r=Math.pow(10,g);if(c(Math.abs(e)/r,u-1)<10){break}}o=r.toString();var l=i.getDecimalFormat(s,o,"other");if(!l||l=="0"){return undefined}else{n={};n.key=o;n.formatString=l;var f=l.match(a);if(f){n.valueSubString=f[0];var p=n.valueSubString.indexOf(".");if(p==-1){n.decimals=0;n.magnitude=r*Math.pow(10,1-n.valueSubString.length)}else{n.decimals=n.valueSubString.length-p-1;n.magnitude=r*Math.pow(10,1-p)}}else{return undefined}}return n}function l(e,t,i){if(t!="short"&&t!="long"){return}var n,r=1,o=10,s=i.getPluralCategories(),u,g={number:undefined,factor:r},l=function(o,s){u=i.getDecimalFormat(t,s.toString(),o);if(u){u=u.replace(/[\s\u00a0\u200F]/g,"");u=u.replace(/'.'/g,".");var l=u.match(a);if(l){var c=l[0];var f=u.replace(c,"");if(!f){return}var p=e.indexOf(f);if(p>=0){n=e.replace(f,"");n=n.replace(/\u200F/g,"");r=s;r*=Math.pow(10,1-c.length);if(g.number===undefined||n.length<g.number.length){g.number=n;g.factor=r}}}}};while(o<1e14){for(var c=0;c<s.length;c++){var f=s[c];l(f,o)}o=o*10}if(!n){return}return g}function c(e,t,i){if(typeof e!=="number"){return NaN}i=i||r.RoundingMode.HALF_AWAY_FROM_ZERO;t=parseInt(t,10);if(typeof i==="function"){e=i(e,t)}else{if(!t){return u[i](e)}e=r._shiftDecimalPoint(u[i](r._shiftDecimalPoint(e,t)),-t)}return e}function f(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function p(e,t){var i=Math.floor(Math.log(Math.abs(e))/Math.LN10);return Math.max(0,t-i-1)}function m(t,i){var n={numberValue:undefined,cldrCode:[]};var r;var a,o;for(a in t){for(o in t[a]){if(o.indexOf("unitPattern")===0){var s=t[a][o];var u=s.indexOf("{0}")>-1;if(u){s="^"+e.sap.escapeRegExp(s).replace("\\{0\\}","(.+)")+"$";var g=new RegExp(s);var l=g.exec(i);if(l&&l[1]){if(r===undefined||l[1].length<r){r=l[1].length;n.numberValue=l[1];n.cldrCode=[a]}else if(l[1].length===r&&n.cldrCode.indexOf(a)===-1){n.cldrCode.push(a)}}}else if(s===i){n.cldrCode=[a];var c;if(e.sap.endsWith(o,"-zero")){c="0"}else if(e.sap.endsWith(o,"-one")){c="1"}else if(e.sap.endsWith(o,"-two")){c="2"}n.numberValue=c;return n}}}}return n}return r});