/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","../base/Object","../base/ManagedObject","./ElementMetadata","../Device","jquery.sap.strings","jquery.sap.trace"],function(t,e,r,i,n){"use strict";var o=r.extend("sap.ui.core.Element",{metadata:{stereotype:"element",abstract:true,publicMethods:["getId","getMetadata","getTooltip_AsString","getTooltip_Text","getModel","setModel","hasModel","bindElement","unbindElement","getElementBinding","prop","getLayoutData","setLayoutData"],library:"sap.ui.core",aggregations:{tooltip:{name:"tooltip",type:"sap.ui.core.TooltipBase",altTypes:["string"],multiple:false},customData:{name:"customData",type:"sap.ui.core.CustomData",multiple:true,singularName:"customData"},layoutData:{name:"layoutData",type:"sap.ui.core.LayoutData",multiple:false,singularName:"layoutData"},dependents:{name:"dependents",type:"sap.ui.core.Element",multiple:true},dragDropConfig:{name:"dragDropConfig",type:"sap.ui.core.dnd.DragDropBase",multiple:true,singularName:"dragDropConfig"}}},constructor:function(t,e){r.apply(this,arguments)},renderer:null},i);o.defineClass=function(t,r,n){return e.defineClass(t,r,n||i)};o.prototype.getInterface=function(){return this};o.prototype._handleEvent=function(t){var e=this,r="on"+t.type;function i(i){var n,o,a;if(i&&(o=i.length)>0){i=o===1?i:i.slice();for(n=0;n<o;n++){if(t.isImmediateHandlerPropagationStopped()){return}a=i[n].oDelegate;if(a[r]){a[r].call(i[n].vThis===true?e:i[n].vThis||a,t)}}}}i(this.aBeforeDelegates);if(t.isImmediateHandlerPropagationStopped()){return}if(this[r]){this[r](t)}i(this.aDelegates)};o.prototype.init=function(){};o.prototype.exit=function(){};o.create=r.create;o.prototype.toString=function(){return"Element "+this.getMetadata().getName()+"#"+this.sId};o.prototype.getDomRef=function(e){return t.sap.domById(e?this.getId()+"-"+e:this.getId())};o.prototype.$=function(e){return t(this.getDomRef(e))};o.prototype.isActive=function(){return this.oParent&&this.oParent.isActive()};o.prototype.prop=function(t,e){var r=this.getMetadata().getAllSettings()[t];if(r){if(arguments.length==1){return this[r._sGetter]()}else{this[r._sMutator](e);return this}}};o.prototype.insertDependent=function(t,e){return this.insertAggregation("dependents",t,e,true)};o.prototype.addDependent=function(t){return this.addAggregation("dependents",t,true)};o.prototype.removeDependent=function(t){return this.removeAggregation("dependents",t,true)};o.prototype.removeAllDependents=function(){return this.removeAllAggregation("dependents",true)};o.prototype.destroyDependents=function(){return this.destroyAggregation("dependents",true)};o.prototype.rerender=function(){if(this.oParent){this.oParent.rerender()}};o.prototype.getUIArea=function(){return this.oParent?this.oParent.getUIArea():null};o.prototype.destroy=function(e){if(this.bIsDestroyed){return}o._updateFocusInfo(this);r.prototype.destroy.call(this,e);if(e!=="KeepDom"||this.getMetadata().isInstanceOf("sap.ui.core.PopupInterface")){this.$().remove()}else{t.sap.log.debug("DOM is not removed on destroy of "+this)}};o.prototype.fireEvent=function(e,i,n,o){if(this.hasListeners(e)){t.sap.interaction.notifyStepStart(this)}if(typeof i==="boolean"){o=n;n=i;i=null}i=i||{};i.id=i.id||this.getId();return r.prototype.fireEvent.call(this,e,i,n,o)};o.prototype.addDelegate=function(e,r,i,n){t.sap.assert(e,"oDelegate must be not null or undefined");if(!e){return this}this.removeDelegate(e);if(typeof r==="object"){n=i;i=r;r=false}if(typeof i==="boolean"){n=i;i=undefined}(r?this.aBeforeDelegates:this.aDelegates).push({oDelegate:e,bClone:!!n,vThis:i===this?true:i});return this};o.prototype.removeDelegate=function(t){var e;for(e=0;e<this.aDelegates.length;e++){if(this.aDelegates[e].oDelegate==t){this.aDelegates.splice(e,1);e--}}for(e=0;e<this.aBeforeDelegates.length;e++){if(this.aBeforeDelegates[e].oDelegate==t){this.aBeforeDelegates.splice(e,1);e--}}return this};o.prototype.addEventDelegate=function(t,e){return this.addDelegate(t,false,e,true)};o.prototype.removeEventDelegate=function(t){return this.removeDelegate(t)};o.prototype.getFocusDomRef=function(){return this.getDomRef()||null};o.prototype.focus=function(){t.sap.focus(this.getFocusDomRef())};o.prototype.getFocusInfo=function(){return{id:this.getId()}};o.prototype.applyFocusInfo=function(t){this.focus();return this};o.prototype._refreshTooltipBaseDelegate=function(t){var e=sap.ui.require("sap/ui/core/TooltipBase");if(e){var r=this.getTooltip();if(r instanceof e){this.removeDelegate(r)}if(t instanceof e){t._currentControl=this;this.addDelegate(t)}}};o.prototype.setTooltip=function(t){this._refreshTooltipBaseDelegate(t);this.setAggregation("tooltip",t);return this};o.prototype.getTooltip=function(){return this.getAggregation("tooltip")};o.runWithPreprocessors=r.runWithPreprocessors;o.prototype.getTooltip_AsString=function(){var t=this.getTooltip();if(typeof t==="string"||t instanceof String){return t}return undefined};o.prototype.getTooltip_Text=function(){var t=this.getTooltip();if(t&&typeof t.getText==="function"){return t.getText()}return t};(function(){var t=function(t,e){var r=t.getAggregation("customData");if(r){for(var i=0;i<r.length;i++){if(r[i].getKey()==e){return r[i]}}}return null};var e=function(e,r,i,n){if(i===null){var o=t(e,r);if(!o){return}var a=e.getAggregation("customData").length;if(a==1){e.destroyAggregation("customData",true)}else{e.removeAggregation("customData",o,true);o.destroy()}}else{var s=sap.ui.requireSync("sap/ui/core/CustomData");var o=t(e,r);if(o){o.setValue(i);o.setWriteToDom(n)}else{var o=new s({key:r,value:i,writeToDom:n});e.addAggregation("customData",o,true)}}};o.prototype.data=function(){var r=arguments.length;if(r==0){var i=this.getAggregation("customData"),n={};if(i){for(var o=0;o<i.length;o++){n[i[o].getKey()]=i[o].getValue()}}return n}else if(r==1){var a=arguments[0];if(a===null){this.destroyAggregation("customData",true);return this}else if(typeof a=="string"){var s=t(this,a);return s?s.getValue():null}else if(typeof a=="object"){for(var u in a){e(this,u,a[u])}return this}else{throw new Error("When data() is called with one argument, this argument must be a string, an object or null, but is "+typeof a+":"+a+" (on UI Element with ID '"+this.getId()+"')")}}else if(r==2){e(this,arguments[0],arguments[1]);return this}else if(r==3){e(this,arguments[0],arguments[1],arguments[2]);return this}else{throw new Error("data() may only be called with 0-3 arguments (on UI Element with ID '"+this.getId()+"')")}}})();o.prototype.clone=function(e,i){var n=r.prototype.clone.apply(this,arguments);for(var o=0;o<this.aDelegates.length;o++){if(this.aDelegates[o].bClone){n.aDelegates.push(this.aDelegates[o])}}for(var o=0;o<this.aBeforeDelegates.length;o++){if(this.aBeforeDelegates[o].bClone){n.aBeforeDelegates.push(this.aBeforeDelegates[o])}}if(this._sapui_declarativeSourceInfo){n._sapui_declarativeSourceInfo=t.extend({},this._sapui_declarativeSourceInfo)}return n};o.prototype.findElements=r.prototype.findAggregatedObjects;function a(e){var r=e.getParent();if(r){var i=t.Event("LayoutDataChange");i.srcControl=e;r._handleEvent(i)}}o.prototype.setLayoutData=function(t){this.setAggregation("layoutData",t,true);a(this);return this};o.prototype.destroyLayoutData=function(){this.destroyAggregation("layoutData",true);a(this);return this};o.prototype.bindElement=r.prototype.bindObject;o.prototype.unbindElement=r.prototype.unbindObject;o.prototype.getElementBinding=r.prototype.getObjectBinding;o.prototype._getFieldGroupIds=function(){var t;if(this.getMetadata().hasProperty("fieldGroupIds")){t=this.getFieldGroupIds()}if(!t||t.length==0){var e=this.getParent();if(e&&e._getFieldGroupIds){return e._getFieldGroupIds()}}return t||[]};o.prototype.getDomRefForSetting=function(t){var e=this.getMetadata().getAllSettings()[t];if(e&&e.selector){var r=this.getDomRef();if(r){r=r.parentNode;if(r&&r.querySelector){var i=e.selector.replace(/\{id\}/g,this.getId().replace(/(:|\.)/g,"\\$1"));return r.querySelector(i)}}}return null};o.prototype._getMediaContainerWidth=function(){if(typeof this._oContextualSettings==="undefined"){return undefined}return this._oContextualSettings.contextualWidth};o.prototype._getCurrentMediaContainerRange=function(t){var e=this._getMediaContainerWidth();t=t||n.media.RANGESETS.SAP_STANDARD;return n.media.getCurrentRange(t,e)};o.prototype._onContextualSettingsChanged=function(){var t=this._getMediaContainerWidth(),e=t!==undefined,r=e^!!this._bUsingContextualWidth,i=this._aContextualWidthListeners||[];if(r){if(e){i.forEach(function(t){n.media.detachHandler(t.callback,t.listener,t.name)})}else{i.forEach(function(t){n.media.attachHandler(t.callback,t.listener,t.name)})}this._bUsingContextualWidth=e}i.forEach(function(t){var e=this._getCurrentMediaContainerRange(t.name);if(e.from!==t.media.from){t.media=e;t.callback.call(t.listener||window,e)}},this)};o.prototype._attachMediaContainerWidthChange=function(t,e,r){r=r||n.media.RANGESETS.SAP_STANDARD;this._aContextualWidthListeners=this._aContextualWidthListeners||[];this._aContextualWidthListeners.push({callback:t,listener:e,name:r,media:this._getCurrentMediaContainerRange(r)});if(!this._bUsingContextualWidth){n.media.attachHandler(t,e,r)}};o.prototype._detachMediaContainerWidthChange=function(t,e,r){var i;r=r||n.media.RANGESETS.SAP_STANDARD;if(!this._aContextualWidthListeners){return}for(var o=0,a=this._aContextualWidthListeners.length;o<a;o++){i=this._aContextualWidthListeners[o];if(i.callback===t&&i.listener===e&&i.name===r){if(!this._bUsingContextualWidth){n.media.detachHandler(t,e,r)}this._aContextualWidthListeners.splice(o,1);break}}};return o});