/*
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./Delegate"],function(t,e){"use strict";var r=e.extend("sap.ui.core.util.serializer.delegate.HTML",{constructor:function(t,r){e.apply(this);this._fnGetControlId=t;this._fnGetEventHandlerName=r}});r.prototype.startAggregation=function(t,e){return'<div data-sap-ui-aggregation="'+e+'">'};r.prototype.endAggregation=function(t,e){return"</div>"};r.prototype.start=function(t,e,r){return"<div"};r.prototype.middle=function(e,r,a){var i=[];var n=this._fnGetControlId?this._fnGetControlId(e):e.getId();if(n.indexOf("__")!==0){i.push(this._createAttribute("id",n))}i.push(this._createAttribute("data-sap-ui-type",e.getMetadata()._sClassName));if(e.aCustomStyleClasses){var s=e.aCustomStyleClasses;var u=[];for(var o=0;o<s.length;o++){var l=s[o];if(!t.sap.startsWith(l,"sapM")&&!t.sap.startsWith(l,"sapUi")){u.push(l)}}if(u.length>0){i.push(this._createAttribute("class",u.join(" ")))}}if(this._fnGetEventHandlerName){var p=e.getMetadata().getAllEvents();for(var f in p){if(e.hasListeners(f)){var g=e.mEventRegistry[f];for(var o=0;o<g.length;o++){var d=this._fnGetEventHandlerName(g[o]);if(d){i.push(this._createAttribute("data-"+this._createHtmlAttributeName(f),d));break}}}}}var c=e.getMetadata().getAllAssociations();this._createAttributes(i,e,c,function(t,e){if(c[t].multiple){return e.join(" ")}return e},function(t,e){return e!==null&&typeof e!==undefined&&e!==""});var h=e.getMetadata().getAllProperties();var v=e.getMetadata().getPropertyDefaults();this._createAttributes(i,e,h,null,function(e,r){return!t.sap.equal(r,v[e])});var _=e.getMetadata().getAllAggregations();this._createAttributes(i,e,_,null,function(t,r){if(!e.getBindingInfo(t)&&(!r||typeof r!=="string")){return false}return true});i.push(">");return i.join("")};r.prototype.end=function(t,e,r){return"</div>"};r.prototype._createAttributes=function(t,e,r,a,i){for(var n in r){var s=r[n];var u=s._sGetter;if(e[u]){var o=e[u]();o=a?a(n,o):o;if(!e.getBindingInfo(n)){if(!i||i(n,o)){t.push(this._createAttribute("data-"+this._createHtmlAttributeName(n),o))}}else{t.push(this._createDataBindingAttribute(e,n,o))}}}};r.prototype._createDataBindingAttribute=function(t,e,r){var a=t.getBindingInfo(e);var i=null;var n=r;if(!a.bindingString){if(a.binding){var s=a.binding.getMetadata().getName();if(s==="sap.ui.model.PropertyBinding"||s==="sap.ui.model.resource.ResourcePropertyBinding"){i=a.binding.getValue()}}if(a.parts){a=a.parts[0]}var u=a.model;if(i===r||i===null){n="{"+(u?u+">"+a.path:a.path)+"}"}}else{n=a.bindingString}return this._createAttribute("data-"+this._createHtmlAttributeName(e),n)};r.prototype._createAttribute=function(t,e){return" "+t+'="'+e+'"'};r.prototype._createHtmlAttributeName=function(e){return t.sap.hyphen(e)};return r});