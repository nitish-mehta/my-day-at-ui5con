/*
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/EventProvider"],function(e,t){"use strict";var i=t.extend("sap.ui.core.util.serializer.Serializer",{constructor:function(e,i,n,r,a,s){t.apply(this);this._oRootControl=e;this._delegate=i;this._bSkipRoot=!!n;this._oWindow=r||window;this._fnSkipAggregations=a;this._fnSkipElement=s}});i.prototype.serialize=function(){return this._serializeRecursive(this._oRootControl,0)};i.prototype._serializeRecursive=function(t,i,n,r){e.sap.assert(typeof t!=="undefined","The control must not be undefined");var a=[];var s=!this._bSkipRoot||i!==0;if(s){var o=this._delegate.start(t,n,r);var g=this._delegate.middle(t,n,r);a.push(o+g)}var l=t.getMetadata().getAllAggregations();if(l){for(var h in l){if(this._fnSkipAggregations&&this._fnSkipAggregations(t,h)){continue}var u=[];var f=l[h];var p=t[f._sGetter]();if(t.getBindingPath(h)&&t.getBindingInfo(h).template){u.push(t.getBindingInfo(h).template)}else if(p&&p.length){for(var _=0;_<p.length;_++){var d=p[_];if(this._isObjectSerializable(d)){u.push(d)}}}else if(this._isObjectSerializable(p)){u.push(p)}if(u.length>0){if(s){a.push(this._delegate.startAggregation(t,h))}var c=this._isDefaultAggregation(t,h);for(var v=0;v<u.length;v++){a.push(this._serializeRecursive(u[v],i+1,h,c))}if(s){a.push(this._delegate.endAggregation(t,h))}}}}if(s){var S=this._delegate.end(t,n,r);a.push(S)}return a.join("")};i.prototype._isObjectSerializable=function(e){return e instanceof this._oWindow.sap.ui.core.Element&&!(this._fnSkipElement&&this._fnSkipElement(e))};i.prototype._isDefaultAggregation=function(e,t){return e.getMetadata().getDefaultAggregationName()===t};return i});