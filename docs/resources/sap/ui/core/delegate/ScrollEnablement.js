/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/Device","sap/ui/base/Object","sap/ui/core/ResizeHandler","jquery.sap.keycodes","jquery.sap.trace"],function(t,i,o,s){"use strict";var e=t;var l=o.extend("sap.ui.core.delegate.ScrollEnablement",{constructor:function(t,i,s){o.apply(this);this._oControl=t;this._oControl.addDelegate(this);this._sContentId=i;this._sContainerId=s.scrollContainerId;this._bHorizontal=!!s.horizontal;this._bVertical=!!s.vertical;this._scrollX=0;this._scrollY=0;this._scrollCoef=.9;n(this);if(this._init){this._init.apply(this,arguments)}},setHorizontal:function(t){this._bHorizontal=!!t;this._setOverflow&&this._setOverflow()},setVertical:function(t){this._bVertical=!!t;this._setOverflow&&this._setOverflow()},getHorizontal:function(){return this._bHorizontal},getVertical:function(){return this._bVertical},setBounce:function(t){},setPullDown:function(t){this._oPullDown=t;return this},setGrowingList:function(t,i){this._fnScrollLoadCallback=t;this._sScrollLoadDirection=i;return this},setIconTabBar:function(i,o,s){this._oIconTabBar=i;this._fnScrollEndCallback=t.proxy(o,i);this._fnScrollStartCallback=t.proxy(s,i);return this},scrollTo:function(t,i,o){this._scrollX=t;this._scrollY=i;this._scrollTo(t,i,o);return this},getChildPosition:function(i){var o=i instanceof t?i:e(i),s=o.position(),l=o.offsetParent(),r;while(!l.is(this._$Container)){r=l.position();s.top+=r.top;s.left+=r.left;l=l.offsetParent()}return s},scrollToElement:function(t,i,o){o=o||[0,0];if(!this._$Container[0].contains(t)||t.style.display==="none"||t.offsetParent.nodeName.toUpperCase()==="HTML"){return this}var s=e(t),l=this.getChildPosition(s),r=this.getScrollLeft()+l.left+o[0],n=this.getScrollTop()+l.top+o[1];if(this._bFlipX){r=this.getScrollLeft()-(l.left-this._$Container.width())-s.width()}this._scrollTo(r,n,i);return this},destroy:function(){if(this._exit){this._exit()}if(this._oControl){this._oControl.removeDelegate(this);this._oControl=undefined}},refresh:function(){if(this._refresh){this._refresh()}},_useDefaultScroll:function(t){return t.isContentEditable},onkeydown:function(i){if(this._useDefaultScroll(i.target)){return}var o=this._$Container[0];if(i.altKey&&this.getHorizontal()){switch(i.keyCode){case t.sap.KeyCodes.PAGE_UP:this._customScrollTo(this._scrollX-o.clientWidth,this._scrollY,i);break;case t.sap.KeyCodes.PAGE_DOWN:this._customScrollTo(this._scrollX+o.clientWidth,this._scrollY,i);break}}if(i.ctrlKey){switch(i.keyCode){case t.sap.KeyCodes.ARROW_UP:if(this.getVertical()){this._customScrollTo(this._scrollX,this._scrollY-o.clientHeight*this._scrollCoef,i)}break;case t.sap.KeyCodes.ARROW_DOWN:if(this.getVertical()){this._customScrollTo(this._scrollX,this._scrollY+o.clientHeight*this._scrollCoef,i)}break;case t.sap.KeyCodes.ARROW_LEFT:if(this.getHorizontal()){this._customScrollTo(this._scrollX-o.clientWidth,this._scrollY,i)}break;case t.sap.KeyCodes.ARROW_RIGHT:if(this.getHorizontal()){this._customScrollTo(this._scrollX+o.clientWidth,this._scrollY,i)}break;case t.sap.KeyCodes.HOME:if(this.getHorizontal()){this._customScrollTo(0,this._scrollY,i)}if(this.getVertical()){this._customScrollTo(this._scrollX,0,i)}break;case t.sap.KeyCodes.END:var s=o.scrollWidth-o.clientWidth;var e=o.scrollHeight-o.clientHeight;if(!this.getHorizontal()){e=this._scrollY}if(!this.getVertical()){s=this._scrollX}this._customScrollTo(s,e,i);break}}},_customScrollTo:function(t,i,o){var s=o.target.nodeName;if(s!="INPUT"&&s!="TEXTAREA"){o.preventDefault();o.setMarked();this._scrollTo(t,i)}}});var r={getScrollTop:function(){return this._scrollY||0},getScrollLeft:function(){return this._scrollX||0},getScrollHeight:function(){var t=this._$Container;return t&&t[0]?t[0].scrollHeight:0},getMaxScrollTop:function(){var t=this._$Container;return t&&t[0]?t[0].scrollHeight-t[0].clientHeight:-1},_cleanup:function(){if(this._sResizeListenerId){s.deregister(this._sResizeListenerId);this._sResizeListenerId=null}},_setOverflow:function(){var t=this._$Container;if(!t||!t[0]){return}if(i.os.ios){t.css("overflow-x",this._bHorizontal&&!this._bDragScroll?"scroll":"hidden").css("overflow-y",this._bVertical&&!this._bDragScroll?"scroll":"hidden").css("-webkit-overflow-scrolling","touch")}else{t.css("overflow-x",this._bHorizontal&&!this._bDragScroll?"auto":"hidden").css("overflow-y",this._bVertical&&!this._bDragScroll?"auto":"hidden")}},_refresh:function(){var t=this._$Container;if(!(t&&t.length)){return}if(this._oPullDown&&this._oPullDown._bTouchMode){var o=this._oPullDown.getDomRef();if(o){o.style.marginTop=this._oPullDown._iState==2?"":"-"+o.offsetHeight+"px"}}if(t.scrollTop()!=this._scrollY){t.scrollTop(this._scrollY)}if(!(this._oPullDown&&this._oPullDown._bTouchMode)&&!this._fnScrollLoadCallback&&!i.browser.msie){s.deregister(this._sResizeListenerId);this._sResizeListenerId=null}},_onScroll:function(){var i=this._$Container,o=i.scrollTop(),s=o-this._scrollY;t.sap.interaction.notifyStepStart(this._oControl);this._scrollX=i.scrollLeft();this._scrollY=o;if(this._fnScrollLoadCallback){if(this._sScrollLoadDirection=="Upwards"){if(s<0&&o<10){this._fnScrollLoadCallback()}}else if(s>=0&&i[0].scrollHeight-o-i[0].clientHeight<100){this._fnScrollLoadCallback()}}if(this._oIconTabBar&&this._fnScrollEndCallback){this._fnScrollEndCallback()}},_onStart:function(t){var i=this._$Container[0];if(!i){return}this._bDoDrag=this._bDragScroll;var o=t.touches?t.touches[0]:t;this._iX=o.pageX;this._iY=o.pageY;this._bPullDown=false;this._iDirection=""},_onTouchMove:function(t){var i=this._$Container[0];var o=t.touches?t.touches[0]:t;var s=o.pageX-this._iX;var e=o.pageY-this._iY;if(this._iDirection==""){if(s!=0||e!=0){this._iDirection=Math.abs(e)>Math.abs(s)?"v":"h"}if(this._oPullDown&&this._oPullDown._bTouchMode&&this._iDirection=="v"&&i.scrollTop<=1){if(e>Math.abs(s)){this._bPullDown=true}}}if(this._bPullDown===true){var l=this._oPullDown.getDomRef();var r=t.touches[0].pageY-this._iY-l.offsetHeight;if(r>20){r=20}l.style.marginTop=r+"px";this._oPullDown.doPull(r);t.preventDefault();this._bDoDrag=false}if(this._bDoDrag){var n=i.scrollLeft,h=i.scrollTop;if(this._bHorizontal){if(this._bFlipX){i.scrollLeft=n-this._iX+o.pageX}else{i.scrollLeft=n+this._iX-o.pageX}}if(this._bVertical){i.scrollTop=h+this._iY-o.pageY}if(i.scrollLeft!=n||i.scrollTop!=h){t.setMarked&&t.setMarked();t.preventDefault()}this._iX=o.pageX;this._iY=o.pageY;return}},_onEnd:function(i){t.sap.interaction.notifyEventStart(i);if(this._oPullDown&&this._oPullDown._bTouchMode){this._oPullDown.doScrollEnd();this._refresh()}if(this._bDragScroll&&this._iDirection){i.setMarked&&i.setMarked()}},_onMouseDown:function(t){if(this._bDragScroll&&t.button==0){this._bScrolling=true;this._onStart(t)}},_onMouseMove:function(t){if(this._bScrolling){var i=t.originalEvent||t;var o=i.buttons||i.which;if(o==1||t.pressure){var s=this._$Container[0];if(this._bHorizontal){if(this._bFlipX){s.scrollLeft=s.scrollLeft-this._iX+t.pageX}else{s.scrollLeft=s.scrollLeft+this._iX-t.pageX}}if(this._bVertical){s.scrollTop=s.scrollTop+this._iY-t.pageY}this._iX=t.pageX;this._iY=t.pageY}}},_onMouseUp:function(){if(this._bScrolling){this._bScrolling=false;this._onEnd()}},onBeforeRendering:function(){if(this._sResizeListenerId){s.deregister(this._sResizeListenerId);this._sResizeListenerId=null}var t=this._$Container;if(t){if(t.height()>0){this._scrollX=t.scrollLeft();this._scrollY=t.scrollTop()}t.off()}},onAfterRendering:function(){var o=this._$Container=this._sContainerId?e.sap.byId(this._sContainerId):e.sap.byId(this._sContentId).parent();var l=t.proxy(this._refresh,this);var r=o.is(":visible");this._setOverflow();if(this._scrollX!==0||this._scrollY!==0){this._scrollTo(this._scrollX,this._scrollY)}this._refresh();if(!r||i.browser.msie||this._oPullDown||this._fnScrollLoadCallback){this._sResizeListenerId=s.register(o[0],l)}o.on("scroll",this._onScroll.bind(this));var n=o[0];function h(t,i){t.split(" ").forEach(function(t){n&&n.addEventListener(t,i)})}function c(t){return t.pointerType=="touch"?this._onStart(t):this._onMouseDown(t)}function a(t){return t.pointerType=="touch"?this._onTouchMove(t):this._onMouseMove(t)}function _(t){return t.pointerType=="touch"?this._onEnd(t):this._onMouseUp(t)}if(i.support.pointer&&i.system.desktop){if(this._bDragScroll){h("pointerdown",c.bind(this));h("pointermove",a.bind(this));h("pointerup pointercancel pointerleave",_.bind(this))}}else if(i.support.touch){if(this._bDragScroll||this._oPullDown&&this._oPullDown._bTouchMode){o.on("touchcancel touchend",this._onEnd.bind(this)).on("touchstart",this._onStart.bind(this)).on("touchmove",this._onTouchMove.bind(this))}}else if(this._bDragScroll){o.on("mouseup mouseleave",this._onMouseUp.bind(this)).mousedown(this._onMouseDown.bind(this)).mousemove(this._onMouseMove.bind(this))}},_readActualScrollPosition:function(){if(this._$Container.width()>0){this._scrollX=this._$Container.scrollLeft()}if(this._$Container.height()>0){this._scrollY=this._$Container.scrollTop()}},_scrollTo:function(i,o,s){if(this._$Container.length>0){if(s>0){this._$Container.finish().animate({scrollTop:o,scrollLeft:i},s,t.proxy(this._readActualScrollPosition,this))}else{this._$Container.scrollTop(o);this._$Container.scrollLeft(i);this._readActualScrollPosition()}}}};function n(t){var o={_init:function(t,o,s){if(e.event&&e.event.special&&e.event.special.swipe&&e.event.special.swipe.scrollSupressionThreshold<120){e.event.special.swipe.scrollSupressionThreshold=120}e.extend(this,r);if(s.nonTouchScrolling===true){this._bDragScroll=true}if(sap.ui.getCore().getConfiguration().getRTL()){this._scrollX=9999;if(i.browser.msie||i.browser.edge){this._bFlipX=true}}},_exit:function(){if(this._cleanup){this._cleanup()}}};e.extend(t,o)}return l});