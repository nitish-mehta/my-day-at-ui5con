/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObject","./Control","./Component","./Core","./library","./ComponentContainerRenderer"],function(e,t,n,o,i,a){"use strict";var s=i.ComponentLifecycle;var r=t.extend("sap.ui.core.ComponentContainer",{metadata:{library:"sap.ui.core",properties:{name:{type:"string",defaultValue:null},url:{type:"sap.ui.core.URI",defaultValue:null},async:{type:"boolean",defaultValue:false},handleValidation:{type:"boolean",defaultValue:false},settings:{type:"object",defaultValue:null},propagateModel:{type:"boolean",defaultValue:false},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},lifecycle:{type:"sap.ui.core.ComponentLifecycle",defaultValue:s.Legacy},autoPrefixId:{type:"boolean",defaultValue:false},usage:{type:"string",defaultValue:null},manifest:{type:"any",defaultValue:null}},associations:{component:{type:"sap.ui.core.UIComponent",multiple:false}},events:{componentCreated:{parameters:{component:{type:"sap.ui.core.UIComponent"}}}},designtime:"sap/ui/core/designtime/ComponentContainer.designtime"}});function p(t,n,i,a){var s=typeof n==="string"?o.getComponent(n):n;var r=t.getComponentInstance();if(r!==s){if(r){r.setContainer(undefined);if(a){r.destroy()}else{t._propagateProperties(true,r,e._oEmptyPropagatedProperties,true)}}t.setAssociation("component",s,i);s=t.getComponentInstance();if(s){s.setContainer(t);t.propagateProperties(true)}}}r.prototype.getComponentInstance=function(){var e=this.getComponent();return e&&o.getComponent(e)};r.prototype.setComponent=function(e,t){p(this,e,t,this.getLifecycle()===s.Container||typeof this.getUsage()==="string"&&this.getUsage()&&this.getLifecycle()===s.Legacy);return this};r.prototype.applySettings=function(e,n){if(e){if(e.autoPrefixId===true&&e.settings&&e.settings.id){e.settings.id=this.getId()+"-"+e.settings.id}if(e.manifest==="true"||e.manifest==="false"){e.manifest=e.manifest==="true"}if(e.manifest&&e.async===undefined){e.async=true}}t.prototype.applySettings.apply(this,arguments)};function u(e){var t=e.getName();var n=e.getUsage();var o=e.getManifest();var i=e.getUrl();var a=e.getSettings();var s={name:t?t:undefined,usage:n?n:undefined,manifest:o!==null?o:false,async:e.getAsync(),url:i?i:undefined,handleValidation:e.getHandleValidation(),settings:a!==null?a:undefined};return s}r.prototype._createComponent=function(){var e=n.getOwnerComponentFor(this),t=u(this);if(!e){if(t.async){return n.create(t)}else{return sap.ui.component(t)}}else{return e._createComponent(t)}};r.prototype.onBeforeRendering=function(){var e=this.getComponentInstance(),t=this.getUsage(),n=this.getName(),o=this.getManifest();if(!this._oComponentPromise&&!e&&(t||n||o)){e=this._createComponent();if(e instanceof Promise){this._oComponentPromise=e;e.then(function(e){delete this._oComponentPromise;this.setComponent(e);this.fireComponentCreated({component:e})}.bind(this),function(e){delete this._oComponentPromise;jQuery.sap.log.error("Failed to load component for container "+this.getId()+". Reason: "+e)}.bind(this))}else{this.setComponent(e,true);this.fireComponentCreated({component:e})}}if(e&&e.onBeforeRendering){e.onBeforeRendering()}};r.prototype.onAfterRendering=function(){var e=this.getComponentInstance();if(e&&e.onAfterRendering){e.onAfterRendering()}};r.prototype.exit=function(){p(this,undefined,true,this.getLifecycle()!==s.Application)};r.prototype.propagateProperties=function(e){var n=this.getComponentInstance();if(n&&this.getPropagateModel()){this._propagateProperties(e,n);t.prototype.propagateProperties.apply(this,arguments)}};r.prototype._propagateContextualSettings=function(){var e=this.getComponentInstance();if(e){e._applyContextualSettings(this._getContextualSettings())}};return r});