/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/base/assert","../Device","./Control","./IconPool","./InvisibleText","./library","./IconRenderer","jquery.sap.keycodes"],function(t,e,o,r,s,i,n,a){"use strict";var l=n.IconColor;var u=r.extend("sap.ui.core.Icon",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.core",designtime:"sap/ui/core/designtime/Icon.designtime",properties:{src:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},size:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},color:{type:"string",group:"Appearance",defaultValue:null},hoverColor:{type:"string",group:"Appearance",defaultValue:null},activeColor:{type:"string",group:"Appearance",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},backgroundColor:{type:"string",group:"Appearance",defaultValue:null},hoverBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},activeBackgroundColor:{type:"string",group:"Appearance",defaultValue:null},decorative:{type:"boolean",group:"Accessibility",defaultValue:true},useIconTooltip:{type:"boolean",group:"Accessibility",defaultValue:true},alt:{type:"string",group:"Accessibility",defaultValue:null},noTabStop:{type:"boolean",group:"Accessibility",defaultValue:false}},aggregations:{_invisibleText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}}});u.prototype[o.support.touch?"ontouchstart":"onmousedown"]=function(t){if(this.hasListeners("press")){t.setMarked()}var e=this.getActiveColor(),o=this.getActiveBackgroundColor(),r;if(e||o){if(!t.targetTouches||t.targetTouches&&t.targetTouches.length===1){r=this.$();r.addClass("sapUiIconActive");if(e){this._addColorClass(e,"color")}if(o){this._addColorClass(o,"background-color")}}}};u.prototype[o.support.touch?"ontouchend":"onmouseup"]=function(t){if(!t.targetTouches||t.targetTouches&&t.targetTouches.length===0){this.$().removeClass("sapUiIconActive");this._restoreColors()}};u.prototype.onmouseover=function(){var t=this.getHoverColor(),e=this.getHoverBackgroundColor();if(t){this._addColorClass(t,"color")}if(e){this._addColorClass(e,"background-color")}};u.prototype.onmouseout=function(){this._restoreColors()};u.prototype[o.support.touch&&!o.system.desktop?"ontap":"onclick"]=function(t){if(this.hasListeners("press")){t.setMarked()}this.firePress({})};u.prototype.onkeydown=function(e){if(e.which===t.sap.KeyCodes.SPACE||e.which===t.sap.KeyCodes.ENTER){e.preventDefault();var o=this.$(),r=this.getActiveColor(),s=this.getActiveBackgroundColor();o.addClass("sapUiIconActive");if(r){this._addColorClass(r,"color")}if(s){this._addColorClass(s,"background-color")}}};u.prototype.onkeyup=function(e){if(e.which===t.sap.KeyCodes.SPACE||e.which===t.sap.KeyCodes.ENTER){this.$().removeClass("sapUiIconActive");this._restoreColors();this.firePress({})}};u.prototype._restoreColors=function(){this._addColorClass(this.getColor()||"","color");this._addColorClass(this.getBackgroundColor()||"","background-color")};u.prototype.setSrc=function(t){e(s.isIconURI(t),this+": Property 'src' (value: '"+t+"') should be a valid Icon URI (sap-icon://...)");var o=s.getIconInfo(t,undefined,"mixed"),r=this.$(),i,n,a,l,u;this.setProperty("src",t,!!o);if(o instanceof Promise){o.then(this.invalidate.bind(this))}else if(o&&r.length){r.css("font-family",o.fontFamily);r.attr("data-sap-ui-icon-content",o.content);r.toggleClass("sapUiIconMirrorInRTL",!o.suppressMirroring);n=this.getTooltip_AsString();l=this.getAriaLabelledBy();a=this.getUseIconTooltip();i=this._getIconLabel(o);if(n||a&&o.text){r.attr("title",n||o.text)}else{r.attr("title",null)}if(l.length===0){if(i){r.attr("aria-label",i)}else{r.attr("aria-label",null)}}else{u=this.getAggregation("_invisibleText");if(u){u.setText(i)}}}return this};u.prototype.setWidth=function(t){this.setProperty("width",t,true);this.$().css("width",t);return this};u.prototype.setHeight=function(t){this.setProperty("height",t,true);this.$().css({height:t,"line-height":t});return this};u.prototype.setSize=function(t){this.setProperty("size",t,true);this.$().css("font-size",t);return this};u.prototype.setColor=function(t){this.setProperty("color",t,true);this._addColorClass(t,"color");return this};u.prototype._addColorClass=function(e,o){var r=this.$(),s=this;var i="";if(o==="color"){i="sapUiIconColor"}else if(o==="background-color"){i="sapUiIconBGColor"}else{return}t.each(l,function(t,e){s.removeStyleClass(i+e)});if(e in l){r.css(o,"");this.addStyleClass(i+e)}else{r.css(o,e)}};u.prototype.setActiveColor=function(t){return this.setProperty("activeColor",t,true)};u.prototype.setHoverColor=function(t){return this.setProperty("hoverColor",t,true)};u.prototype.setBackgroundColor=function(t){this.setProperty("backgroundColor",t,true);this._addColorClass(t,"background-color");return this};u.prototype.setActiveBackgroundColor=function(t){return this.setProperty("activeBackgroundColor",t,true)};u.prototype.setHoverBackgroundColor=function(t){return this.setProperty("hoverBackgroundColor",t,true)};u.prototype.attachPress=function(){var t=Array.prototype.slice.apply(arguments);t.unshift("press");r.prototype.attachEvent.apply(this,t);if(this.hasListeners("press")){this.$().toggleClass("sapUiIconPointer",true).attr({role:"button",tabindex:this.getNoTabStop()?undefined:0})}return this};u.prototype.detachPress=function(){var t=Array.prototype.slice.apply(arguments);t.unshift("press");r.prototype.detachEvent.apply(this,t);if(!this.hasListeners("press")){this.$().toggleClass("sapUiIconPointer",false).attr({role:this.getDecorative()?"presentation":"img"}).removeAttr("tabindex")}return this};u.prototype._getOutputTitle=function(t){var e=this.getTooltip_AsString(),o=this.getUseIconTooltip();if(e||o&&t&&t.text){return e||t.text}};u.prototype._getIconLabel=function(t){var e=this.getAlt(),o=this.getTooltip_AsString(),r=this.getUseIconTooltip(),s=e||o||r&&t&&(t.text||t.name),i=this._getOutputTitle(t);if(s&&s!==i){return s}};u.prototype._createInvisibleText=function(t){var e=this.getAggregation("_invisibleText");if(!e){e=new i(this.getId()+"-label",{text:t});this.setAggregation("_invisibleText",e,true)}else{e.setProperty("text",t,true)}return e};u.prototype._getAccessibilityAttributes=function(t){var e=this.getAriaLabelledBy(),o={},r=this._getIconLabel(t),s;if(this.getDecorative()){o.role="presentation";o.hidden="true"}else{if(this.hasListeners("press")){o.role="button"}else{o.role="img"}}if(e.length>0){if(r){s=this._createInvisibleText(r);e.push(s.getId())}o.labelledby=e.join(" ")}else if(r){o.label=r}return o};u.prototype.getAccessibilityInfo=function(){if(this.getDecorative()){return null}var t=this.hasListeners("press");var e=s.getIconInfo(this.getSrc(),undefined,"sync");return{role:t?"button":"img",type:sap.ui.getCore().getLibraryResourceBundle("sap.ui.core").getText(t?"ACC_CTR_TYPE_BUTTON":"ACC_CTR_TYPE_IMAGE"),description:this.getAlt()||this.getTooltip_AsString()||(e?e.text||e.name:""),focusable:t}};return u});