/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/support/library"],function(e,t){"use strict";var a=t.Categories;var i=t.Severity;var n=t.Audiences;var o={id:"xmlViewWrongNamespace",audiences:[n.Application],categories:[a.Functionality],enabled:true,minversion:"-",title:"XML View is not configured with namespace 'sap.ui.core.mvc'",description:"For consistency and proper resource loading, the root node of an XML view must be configured with the namespace 'mvc'",resolution:"Define the XML view as '<core:View ...>' and configure the XML namepspace as 'xmlns:mvc=\"sap.ui.core.mvc\"'",resolutionurls:[{text:"Documentation: Namespaces in XML Views",href:"https://sapui5.hana.ondemand.com/#docs/guide/2421a2c9fa574b2e937461b5313671f0.html"}],check:function(e,t,a){var n=a.getElements().filter(function(e){return e.getMetadata().getName()==="sap.ui.core.mvc.XMLView"});n.forEach(function(t){if(t._xContent.namespaceURI!=="sap.ui.core.mvc"){var a=t.getViewName().split(".").pop();e.addIssue({severity:i.Medium,details:"The view '"+a+"' ("+t.getId()+") is configured with namespace '"+t._xContent.namespaceURI+"' instead of 'sap.ui.core.mvc'",context:{id:t.getId()}})}})}};var r={id:"xmlViewDefaultNamespace",audiences:[n.Control,n.Application],categories:[a.Performance],enabled:true,minversion:"-",title:"Default namespace missing in XML view",description:"If the default namespace is missing, the code is less readable and parsing performance may be slow",resolution:'Set the namespace of the control library that holds most of the controls you use as default namespace (e.g. xmlns="sap.m")',resolutionurls:[{text:"Documentation: Namespaces in XML Views",href:"https://sapui5.hana.ondemand.com/#docs/guide/2421a2c9fa574b2e937461b5313671f0.html"}],check:function(e,t,a){var n=a.getElements().filter(function(e){return e.getMetadata().getName()==="sap.ui.core.mvc.XMLView"});n.forEach(function(t){if(!t._xContent.attributes.getNamedItem("xmlns")){var a=t.getViewName().split(".").pop();e.addIssue({severity:i.Low,details:"The view '"+a+"' ("+t.getId()+") does not contain a default namespace",context:{id:t.getId()}})}})}};var s={id:"xmlViewLowerCaseControl",audiences:["Control","Application"],categories:["Performance"],enabled:true,minversion:"-",title:"Control tag in XML view starts with lower case",description:"Control tags with lower case cannot be loaded in Linux-based systems",resolution:"Start the Control tag with upper case",resolutionurls:[],check:function(t,a,n){var o=n.getElements().map(function(e){return Object.keys(e.getMetadata().getAllAggregations())});var r=o.reduce(function(e,t){return e.concat(t)}).filter(function(e,t,a){return a.indexOf(e)===t});var s=n.getElements().filter(function(e){return e.getMetadata().getName()==="sap.ui.core.mvc.XMLView"});s.forEach(function(a){var n=[];var o=function(e){n.push(e.localName);for(var t=0;t<e.children.length;t++){o(e.children[t])}};o(a._xContent);n=e.uniqueSort(n);n.forEach(function(e){var n=e.charAt(0);if(n.toLowerCase()===n&&!r.includes(e)){var o=a.getViewName().split(".").pop();t.addIssue({severity:i.High,details:"View '"+o+"' ("+a.getId()+") contains a Control tag that starts with lower case '"+e+"'",context:{id:a.getId()}})}})})}};var c={id:"xmlViewUnusedNamespaces",audiences:[n.Control,n.Application],categories:[a.Performance],enabled:true,minversion:"-",title:"Unused namespaces in XML view",description:"Namespaces that are declared but not used have a negative impact on performance (and may confuse readers of the code)",resolution:"Remove the unused namespaces from the view definition",resolutionurls:[{text:"Documentation: Namespaces in XML Views",href:"https://sapui5.hana.ondemand.com/#docs/guide/2421a2c9fa574b2e937461b5313671f0.html"}],check:function(t,a,n){var o=n.getElements().filter(function(e){return e.getMetadata().getName()==="sap.ui.core.mvc.XMLView"});o.forEach(function(a){for(var n=0;n<a._xContent.attributes.length;n++){var o=a._xContent.attributes.item(n).name;var r=a._xContent.attributes.item(n).localName;var s=a._xContent.attributes.item(n).value;if(o.match("xmlns:")&&r!=="xmlns:support"&&r!=="mvc"){for(var c=0;c<e(a._xContent).children().length;c++){var d=e(a._xContent).children()[c];var u=(new XMLSerializer).serializeToString(d);if(!u.match("<"+r+":")){var l=a.getViewName().split(".").pop();t.addIssue({severity:i.High,details:"View '"+l+"' ("+a.getId()+") contains an unused XML namespace '"+r+"' referencing library '"+s+"'",context:{id:a.getId()}})}}}}})}};var d={id:"deprecatedProperty",audiences:[n.Application],categories:[a.Functionality],enabled:true,minversion:"1.38",title:"Control is using deprecated property",description:"Using deprecated properties should be avoided, because they are not maintained anymore",resolution:"Refer to the API of the element which property should be used instead.",resolutionurls:[{text:"API Reference",href:"https://sapui5.hana.ondemand.com/#/api/deprecated"}],check:function(e,t,a){a.getElementsByClassName(sap.ui.core.Element).forEach(function(t){var a=t.getMetadata(),n=a.getAllProperties();for(var o in n){if(n[o].deprecated&&n[o].defaultValue!=t.getProperty(o)&&n[o].defaultValue!==null){e.addIssue({severity:i.Medium,details:"Deprecated property '"+o+"' is used for element '"+t.getId()+"'.",context:{id:t.getId()}})}}})}};var u={id:"deprecatedAggregation",audiences:[n.Application],categories:[a.Functionality],enabled:true,minversion:"1.38",title:"Control is using deprecated aggregation",description:"Using deprecated aggregation should be avoided, because they are not maintained anymore",resolution:"Refer to the API of the element which aggregation should be used instead.",resolutionurls:[{text:"API Reference",href:"https://sapui5.hana.ondemand.com/#/api/deprecated"}],check:function(t,a,n){n.getElementsByClassName(sap.ui.core.Element).forEach(function(a){var n=a.getMetadata(),o=n.getAllAggregations();for(var r in o){if(o[r].deprecated&&!e.isEmptyObject(a.getAggregation(r))){t.addIssue({severity:i.Medium,details:"Deprecated aggregation '"+r+"' is used for element '"+a.getId()+"'.",context:{id:a.getId()}})}}})}};var l={id:"deprecatedAssociation",audiences:[n.Application],categories:[a.Functionality],enabled:true,minversion:"1.38",title:"Control is using deprecated association",description:"Using deprecated association should be avoided, because they are not maintained anymore",resolution:"Refer to the API of the element which association should be used instead.",resolutionurls:[{text:"API Reference",href:"https://sapui5.hana.ondemand.com/#/api/deprecated"}],check:function(t,a,n){n.getElementsByClassName(sap.ui.core.Element).forEach(function(a){var n=a.getMetadata(),o=n.getAllAssociations();for(var r in o){if(o[r].deprecated&&!e.isEmptyObject(a.getAssociation(r))){t.addIssue({severity:i.Medium,details:"Deprecated association '"+r+"' is used for element '"+a.getId()+"'.",context:{id:a.getId()}})}}})}};var m={id:"deprecatedEvent",audiences:[n.Application],categories:[a.Functionality],enabled:true,minversion:"1.38",title:"Control is using deprecated event",description:"Using deprecated event should be avoided, because they are not maintained anymore",resolution:"Refer to the API of the element which event should be used instead.",resolutionurls:[{text:"API Reference",href:"https://sapui5.hana.ondemand.com/#/api/deprecated"}],check:function(e,t,a){a.getElementsByClassName(sap.ui.core.Element).forEach(function(t){var a=t.getMetadata(),n=a.getAllEvents();for(var o in n){if(n[o].deprecated&&t.mEventRegistry[o]&&t.mEventRegistry[o].length>0){e.addIssue({severity:i.Medium,details:"Deprecated event '"+o+"' is used for element '"+t.getId()+"'.",context:{id:t.getId()}})}}})}};return[o,r,s,c,d,u,l,m]},true);