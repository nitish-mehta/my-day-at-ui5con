/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/events/KeyCodes","sap/ui/dom/focus","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/Selectors"],function(e,a,t){"use strict";var n={};n.fastNavigationKey="sap-ui-fastnavgroup";n.handleF6GroupNavigation=function(r,i){function s(e){var a=t(e).closest('[data-sap-ui-customfastnavgroup="true"]');return a[0]}function u(e){var a=s(e);if(a){return a}var r=t(e).closest("[data-"+n.fastNavigationKey+'="true"]');return r[0]}function f(e,a,n){var r=t(e),i,s;if(n){i=t.merge(r.find("*"),t.merge(r.nextAll(),r.parents().nextAll()));s=i.find(":sapTabbable").addBack(":sapTabbable")}else{i=t.merge(r.prevAll(),r.parents().prevAll());s=t.merge(r.parents(":sapTabbable"),i.find(":sapTabbable").addBack(":sapTabbable"))}var s=t.unique(s);return s.filter(function(){return l(a,this)})}function o(e,a){var n=window.document.getElementById("sap-ui-static");if(!n){return e}var r=[];for(var i=0;i<a.length;i++){if(t.contains(n,a[i])){r.push(a[i])}}return e.filter(function(){if(r.length&&l(r,this)){return true}return!t.contains(n,this)})}function l(e,a){for(var n=0;n<e.length;n++){if(e[n]===a||t.contains(e[n],a)){return true}}return false}function d(e,a,n,r){var i,s;for(var f=a.length-1;f>=0;f--){i=u(a[f]);if(i!=n){if(r){n=i;r=false}else{s=t(a[f+1]);break}}}if(!s&&!r){s=e}return s}function p(e,n,r){if(!n||n.length==0){n=[document]}if(!l(n,e)){return}var i=u(e),p=o(t(n).find(":sapTabbable").addBack(":sapTabbable"),n),c=p.first(),v=o(f(e,n,r),n),g,b;if(r){for(var h=0;h<v.length;h++){g=u(v[h]);if(g!=i){b=t(v[h]);break}}if(!b||!b.length){b=c}}else{b=d(c,v,i,true);if(!b||!b.length){if(p.length==1){b=t(p[0])}else if(p.length>1){i=u(p.eq(-1));g=u(p.eq(-2));if(i!=g){b=p.eq(-1)}else{b=d(c,p,i,false)}}}}if(b&&b.length){var y=b[0],k=null,m=s(y);if(m&&m.id){var F=sap.ui.getCore().byId(m.id);if(F){k=t.Event("BeforeFastNavigationFocus");k.target=y;k.source=e;k.forward=r;F._handleEvent(k)}}if(!k||!k.isDefaultPrevented()){a(y)}}}if(r.type!="keydown"||r.keyCode!=e.F6||r.isMarked("sapui5_handledF6GroupNavigation")||r.isMarked()||r.isDefaultPrevented()){return}r.setMark("sapui5_handledF6GroupNavigation");r.setMarked();r.preventDefault();if(i&&i.skip){return}var c=i&&i.target?i.target:document.activeElement,v=null;if(i&&i.scope){v=Array.isArray(i.scope)?i.scope:[i.scope]}p(c,v,!r.shiftKey)};t(function(){t(document).on("keydown",function(e){n.handleF6GroupNavigation(e,null)})});return n});