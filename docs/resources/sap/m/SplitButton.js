/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","./Button","./ButtonRenderer","sap/ui/core/EnabledPropagator","sap/ui/core/IconPool","sap/ui/core/library","sap/ui/Device","sap/ui/core/InvisibleText","./SplitButtonRenderer"],function(t,e,o,i,r,n,s,a,p,l){"use strict";var u=s.TextDirection;var c=t.ButtonType;var f=e.extend("sap.m.SplitButton",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.m",properties:{text:{type:"string",group:"Misc",defaultValue:null},type:{type:"sap.m.ButtonType",group:"Appearance",defaultValue:c.Default},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Behavior",defaultValue:true},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},activeIcon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},iconDensityAware:{type:"boolean",group:"Misc",defaultValue:true},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:u.Inherit}},aggregations:{_textButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_arrowButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{},arrowPress:{}}}});r.call(f.prototype);f.prototype.exit=function(){if(this._oInvisibleTooltipInfoLabel){this._oInvisibleTooltipInfoLabel.destroy();this._oInvisibleTooltipInfoLabel=null}};f.prototype.onAfterRendering=function(){var t=this._getTextButton().$(),e=this._getArrowButton().$();t.attr("tabindex","-1");e.attr("tabindex","-1");t.removeAttr("title");e.removeAttr("title");t.removeAttr("aria-describedby");e.removeAttr("aria-describedby")};f.prototype._handleAction=function(t){if(t){this.fireArrowPress()}else{this.firePress()}};f.prototype.setArrowState=function(t){var e=this.getAggregation("_arrowButton");if(!e){return}if(t){e.$().addClass("sapMSBActive")}else{e.$().removeClass("sapMSBActive")}};f.prototype._getTextButton=function(){var t=this.getAggregation("_textButton");if(!t){t=new o({width:"100%",icon:this.getIcon(),text:this.getText(),press:this._handleAction.bind(this,false)}).addStyleClass("sapMSBText");if(a.browser.msie){t.addStyleClass("sapMSBTextIE")}this.setAggregation("_textButton",t)}return t};f.prototype._getArrowButton=function(){var t=this.getAggregation("_arrowButton");if(!t){t=new o({icon:"sap-icon://slim-arrow-down",press:this._handleAction.bind(this,true)}).addStyleClass("sapMSBArrow");this.setAggregation("_arrowButton",t)}return t};f.prototype.setTooltip=function(t){var o;e.prototype.setTooltip.apply(this,arguments);o=this.getTooltip_AsString();this.getTooltipInfoLabel(o);return this};f.prototype.setProperty=function(t,i,r){if(t==="type"&&(i===c.Up||i===c.Back||i===c.Unstyled)){return this}var n=e.prototype.setProperty.apply(this,arguments);if(t==="activeIcon"||t==="iconDensityAware"||t==="textDirection"){o.prototype.setProperty.apply(this._getTextButton(),arguments)}else if(t==="text"||t==="type"||t==="icon"){var s="set"+y(t);o.prototype[s].call(this._getTextButton(),i);if(t==="type"){o.prototype[s].call(this._getArrowButton(),i)}}return n};function y(t){return t.charAt(0).toUpperCase()+t.slice(1)}f.prototype.onsapenter=function(t){this._getTextButton().firePress()};f.prototype.onsapspace=function(t){this._getTextButton().firePress()};f.prototype.onsapup=function(t){this._getArrowButton().firePress()};f.prototype.onsapdown=function(t){this._getArrowButton().firePress()};f.prototype.onsapupmodifiers=function(t){this._getArrowButton().firePress()};f.prototype.onsapdownmodifiers=function(t){this._getArrowButton().firePress()};f.prototype.onsapshow=function(t){this._getArrowButton().firePress();t.preventDefault()};f.prototype.getButtonTypeAriaLabelId=function(){var t=this._getTextButton().getType();return i.getButtonTypeAriaLabelId(t)};f.prototype.getTooltipInfoLabel=function(t){if(!this._oInvisibleTooltipInfoLabel){this._oInvisibleTooltipInfoLabel=new p;this._oInvisibleTooltipInfoLabel.toStatic()}this._oInvisibleTooltipInfoLabel.setText(t);return this._oInvisibleTooltipInfoLabel};f.prototype.getTitleAttributeValue=function(){var t=this.getTooltip_AsString(),e=n.getIconInfo(this.getIcon()),o;if(t||e&&e.text&&!this.getText()){o=t||e.text}return o};f.prototype.getOverflowToolbarConfig=function(){var t={canOverflow:true,propsUnrelatedToSize:["enabled","type","icon","activeIcon"],autoCloseEvents:["press"]};return t};return f});