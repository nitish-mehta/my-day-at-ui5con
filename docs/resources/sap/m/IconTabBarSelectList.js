/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/delegate/ItemNavigation","./IconTabBarDragAndDropUtil","./IconTabBarSelectListRenderer","sap/ui/core/dnd/DragInfo","sap/ui/core/dnd/DropInfo"],function(e,t,i,o,r,a,n,s){"use strict";var p=i.extend("sap.m.IconTabBarSelectList",{metadata:{library:"sap.m",aggregations:{items:{type:"sap.m.IconTabFilter",multiple:true,singularName:"item",dnd:true}},events:{selectionChange:{parameters:{selectedItem:{type:"sap.m.IconTabFilter"}}}}}});p.prototype.init=function(){this._itemNavigation=new o;this._itemNavigation.setCycling(false);this.addEventDelegate(this._itemNavigation);this._itemNavigation.setPageSize(10)};p.prototype.exit=function(){if(this._itemNavigation){this._itemNavigation.destroy();this._itemNavigation=null}};p.prototype.onAfterRendering=function(){this._initItemNavigation()};p.prototype._setsDragAndConfiguration=function(){if(!this._iconTabHeader.getEnableTabReordering()&&this.getDragDropConfig().length){this.destroyDragDropConfig()}else if(this._iconTabHeader.getEnableTabReordering()&&!this.getDragDropConfig().length){r.setDragDropAggregations(this,n,s,"Vertical")}};p.prototype.onBeforeRendering=function(){if(!this._iconTabHeader){return}this._setsDragAndConfiguration()};p.prototype._initItemNavigation=function(){var e,t=this.getItems(),i=[];for(var o=0;o<t.length;o++){e=t[o];i.push(e.getDomRef())}this._itemNavigation.setRootDomRef(this.getDomRef());this._itemNavigation.setItemDomRefs(i)};p.prototype.getVisibleItems=function(){var e=this.getItems(),t=[],i;for(var o=0;o<e.length;o++){i=e[o];if(i.getVisible()){t.push(i)}}return t};p.prototype.setSelectedItem=function(e){if(this._selectedItem){this._deselectItem(this._selectedItem)}if(e){this._selectItem(e)}this._selectedItem=e};p.prototype.getSelectedItem=function(){return this._selectedItem};p.prototype._deselectItem=function(e){var t=e.$();if(t){t.removeClass("sapMITBSelectItemSelected");t.removeAttr("aria-selected")}};p.prototype._selectItem=function(e){var t=e.$();if(t){t.addClass("sapMITBSelectItemSelected");t.attr("aria-selected",true)}};p.prototype.ontap=function(t){var i=e(t.target);if(!i.hasClass("sapMITBSelectItem")){i=i.parent(".sapMITBSelectItem")}var o=sap.ui.getCore().byId(i[0].id);if(o&&o.getEnabled()){t.preventDefault();if(o!=this.getSelectedItem()){this._selectItem(o);this.fireSelectionChange({selectedItem:o})}}if(this._iconTabHeader){this._iconTabHeader._closeOverflow()}};p.prototype.onsapenter=p.prototype.ontap;p.prototype.onsapspace=p.prototype.ontap;p.prototype.checkIconOnly=function(e){var t,i=e.length;for(var o=0;o<i;o++){t=e[o];if(t.getText()||t.getCount()){return false}}return true};p.prototype._handleDragAndDrop=function(e){var t=e.getParameter("dropPosition"),i=e.getParameter("draggedControl"),o=e.getParameter("droppedControl"),a=i.getParent().getMetadata().getName()==="sap.m.IconTabHeader",n;if(a){n=r.getDraggedDroppedItemsFromList(this.getAggregation("items"),i,o);this._handleDropOfListAndHeaderItems(t,n.oDraggedControlFromList,n.oDroppedControlFromList,i,o._tabFilter)}else{this._handleDropOfListAndHeaderItems(t,i,o,i._tabFilter,o._tabFilter)}this._initItemNavigation();i.$().focus()};p.prototype._handleDropOfListAndHeaderItems=function(e,t,i,o,a,n){r.handleDrop(this,e,t,i,true);r.handleDrop(this._iconTabHeader,e,o,a,true);this._iconTabHeader._initItemNavigation()};p.prototype.ondragrearranging=function(e){if(!this._iconTabHeader.getEnableTabReordering()){return}var t=e.srcControl,i=e.keyCode;r.moveItem.call(this,t,i);this._initItemNavigation();t.$().focus();this._iconTabHeader._moveTab(t._tabFilter,i)};p.prototype.onsaphomemodifiers=p.prototype.ondragrearranging;p.prototype.onsapendmodifiers=p.prototype.ondragrearranging;p.prototype.onsapincreasemodifiers=p.prototype.ondragrearranging;p.prototype.onsapdecreasemodifiers=p.prototype.ondragrearranging;return p});