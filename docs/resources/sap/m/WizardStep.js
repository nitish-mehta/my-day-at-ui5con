/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./library","sap/ui/core/Control","jquery.sap.global","./WizardStepRenderer","./Button"],function(t,e,i,s,a){"use strict";var r=e.extend("sap.m.WizardStep",{metadata:{properties:{title:{type:"string",group:"appearance",defaultValue:""},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:""},validated:{type:"boolean",group:"Behavior",defaultValue:true},optional:{type:"boolean",group:"Appearance",defaultValue:false}},events:{complete:{parameters:{}},activate:{parameters:{}}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},_nextButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},associations:{subsequentSteps:{type:"sap.m.WizardStep",multiple:true,singularName:"subsequentStep"},nextStep:{type:"sap.m.WizardStep",multiple:false}}}});r.prototype.init=function(){this._resourceBundle=sap.ui.getCore().getLibraryResourceBundle("sap.m");this._oNextButton=new a({text:this._resourceBundle.getText("WIZARD_STEP")+2,type:"Emphasized",enabled:this.getValidated(),press:this._handleNextButtonPress.bind(this)}).addStyleClass("sapMWizardNextButton");this._oNextButton.addEventDelegate({onAfterRendering:function(){i.sap.delayedCall(0,this,function(){var t=this._oNextButton,e=t.getDomRef();if(t.getEnabled()){t.addStyleClass("sapMWizardNextButtonVisible");e&&e.removeAttribute("aria-hidden")}else{t.removeStyleClass("sapMWizardNextButtonVisible");e&&e.setAttribute("aria-hidden",true)}})}},this);this.setAggregation("_nextButton",this._oNextButton)};r.prototype.onBeforeRendering=function(){var t=this._getWizardParent()?this._getWizardParent().getShowNextButton():true;this._oNextButton.setProperty("visible",t,true)};r.prototype._handleNextButtonPress=function(){};r.prototype.setValidated=function(t){this.setProperty("validated",t,true);var e=this._getWizardParent();if(e===null){return this}if(t){e.validateStep(this)}else{e.invalidateStep(this)}return this};r.prototype.setNextStep=function(t){this.setAssociation("nextStep",t,true);var e=this._getWizardParent();if(e!==null){e._checkCircularReference(this._getNextStepReference());e._updateProgressNavigator()}return this};r.prototype.setVisible=function(t){this.setProperty("visible",t,true);i.sap.log.warning("Don't use the set visible method for wizard steps. If you need to show/hide steps based on some condition - use the branching property of the Wizard instead.");return this};r.prototype._isLeaf=function(){if(this.getNextStep()===null&&this.getSubsequentSteps().length===0){return true}return false};r.prototype._isBranched=function(){return this.getSubsequentSteps().length>1};r.prototype._getNextStepReference=function(){if(this.getNextStep()!==null){return sap.ui.getCore().byId(this.getNextStep())}if(this.getSubsequentSteps().length===1){return sap.ui.getCore().byId(this.getSubsequentSteps()[0])}return null};r.prototype._containsSubsequentStep=function(t){return this.getSubsequentSteps().some(function(e){return e===t})};r.prototype._getWizardParent=function(){var t=this.getParent();while(!(t instanceof sap.m.Wizard)){if(t===null){return null}t=t.getParent()}return t};r.prototype._markAsLast=function(){this.addStyleClass("sapMWizardLastActivatedStep")};r.prototype._unMarkAsLast=function(){this.removeStyleClass("sapMWizardLastActivatedStep")};r.prototype._activate=function(){if(this.hasStyleClass("sapMWizardStepActivated")){return}this._markAsLast();this.addStyleClass("sapMWizardStepActivated");this.fireActivate()};r.prototype._deactivate=function(){this.removeStyleClass("sapMWizardStepActivated")};r.prototype._complete=function(){this._unMarkAsLast();this.fireComplete()};return r});