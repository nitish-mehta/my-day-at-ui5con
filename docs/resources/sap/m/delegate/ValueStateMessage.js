/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/Device","sap/ui/base/Object","sap/ui/core/ValueStateSupport","sap/ui/core/Popup","sap/ui/core/library"],function(e,t,o,a,s,i){"use strict";var n=i.ValueState;var r=o.extend("sap.m.delegate.ValueState",{constructor:function(e){o.apply(this,arguments);this._oControl=e;this._oPopup=null}});r.prototype.open=function(){var o=this._oControl,a=this.getPopup(),i=this.createDom(),n=s.Dock,r=e(o.getDomRefForValueStateMessage());if(!o||!a||!i){return}a.setContent(i);a.close(0);if(a.getContent()){a.getContent().style.maxWidth=o.getDomRef().offsetWidth+"px"}else{a.getContent().style.maxWidth=""}a.open(this.getOpenDuration(),n.BeginTop,n.BeginBottom,o.getDomRefForValueStateMessage(),null,null,t.system.phone?true:s.CLOSE_ON_SCROLL);var p=e(i);if(r.offset().top<p.offset().top){p.addClass("sapMValueStateMessageBottom")}else{p.addClass("sapMValueStateMessageTop")}e(o.getFocusDomRef()).addAriaDescribedBy(this.getId())};r.prototype.close=function(){var t=this._oControl,o=this.getPopup();if(o){o.close(0)}if(t){e(t.getFocusDomRef()).removeAriaDescribedBy(this.getId())}};r.prototype.getId=function(){var e=this._oControl;if(!e){return""}return typeof e.getValueStateMessageId==="function"?e.getValueStateMessageId():e.getId()+"-message"};r.prototype.getOpenDuration=function(){var e=this._oControl;if(!e){return 0}return e.iOpenMessagePopupDuration===undefined?0:e.iOpenMessagePopupDuration};r.prototype.createPopup=function(t){t=t||this.getId();if(this._oPopup){return this._oPopup}this._oPopup=new s(document.createElement("span"),false,false,false);this._oPopup.attachClosed(function(){e.sap.byId(t).remove()});return this._oPopup};r.prototype.getPopup=function(){if(!this._oControl){return null}return this.createPopup()};r.prototype.createDom=function(){var e=this._oControl;if(!e){return null}var t=e.getValueState(),o=e.getValueStateText()||a.getAdditionalText(e),s="sapMValueStateMessage sapMValueStateMessage"+t,i=sap.ui.getCore().getLibraryResourceBundle("sap.m");if(t===n.Success||t===n.None){s="sapUiInvisibleText";o=""}var r=this.getId();var p=document.createElement("div");p.id=r;p.className=s;p.setAttribute("role","tooltip");p.setAttribute("aria-live","assertive");var u=document.createElement("span");u.id=r+"hidden";u.className="sapUiHidden";u.setAttribute("aria-hidden","true");if(t!==n.None){u.appendChild(document.createTextNode(i.getText("INPUTBASE_VALUE_STATE_"+t.toUpperCase())))}var l=document.createElement("span");l.id=r+"-text";l.setAttribute("aria-hidden","true");l.appendChild(document.createTextNode(o));p.appendChild(u);p.appendChild(l);return p};r.prototype.destroy=function(){if(this._oPopup){this._oPopup.destroy();this._oPopup=null}this._oControl=null};return r});