/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/m/Dialog","sap/m/BusyIndicator","sap/m/Label","sap/m/Button"],function(t,e,o,i,s,n,a,l,r){"use strict";var u=o.extend("sap.m.BusyDialog",{metadata:{library:"sap.m",properties:{text:{type:"string",group:"Appearance",defaultValue:""},title:{type:"string",group:"Appearance",defaultValue:""},customIcon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:""},customIconRotationSpeed:{type:"int",group:"Appearance",defaultValue:1e3},customIconDensityAware:{type:"boolean",defaultValue:true},customIconWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"44px"},customIconHeight:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"44px"},cancelButtonText:{type:"string",group:"Misc",defaultValue:""},showCancelButton:{type:"boolean",group:"Appearance",defaultValue:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{close:{parameters:{cancelPressed:{type:"boolean"}}}},designtime:"sap/m/designtime/BusyDialog.designtime"},renderer:function(t,e){}});u.prototype.init=function(){this._busyIndicator=new s(this.getId()+"-busyInd",{visible:true});function t(){if(sap.ui.getCore().getConfiguration().getAccessibility()){this._$content.attr("role","application")}}this._oDialog=new i(this.getId()+"-Dialog",{content:this._busyIndicator,showHeader:false,afterOpen:t,afterClose:this._fnCloseHandler.bind(this),initialFocus:this._busyIndicator}).addStyleClass("sapMBusyDialog");this._oDialog.close=function(){};this._oDialog.addEventDelegate({onBeforeRendering:function(){var t=this.getText(),e=this.getTitle(),o=this.getShowCancelButton()||this.getCancelButtonText();if(!t&&!e&&!o){this._oDialog.addStyleClass("sapMBusyDialog-Light")}else{this._oDialog.removeStyleClass("sapMBusyDialog-Light")}}},this);this._oDialog.oPopup.onsapescape=function(t){this.close(true)}.bind(this)};u.prototype.exit=function(){this._busyIndicator.destroy();this._busyIndicator=null;if(this._cancelButton){this._cancelButton.destroy();this._cancelButton=null}if(this._oLabel){this._oLabel.destroy();this._oLabel=null}if(this._oDialog){this._oDialog.destroy();this._oDialog=null}};u.prototype.open=function(){t.sap.log.debug("sap.m.BusyDialog.open called at "+(new Date).getTime());if(this.getAriaLabelledBy()&&!this._oDialog._$dialog){var e=this;this.getAriaLabelledBy().forEach(function(t){e._oDialog.addAriaLabelledBy(t)})}if(!document.body||!sap.ui.getCore().isInitialized()){setTimeout(function(){this.open()}.bind(this),50)}else{this._oDialog.open()}return this};u.prototype.close=function(t){this._isClosedFromUserInteraction=t;i.prototype.close.call(this._oDialog);return this};u.prototype._fnCloseHandler=function(){this.fireClose({cancelPressed:this._isClosedFromUserInteraction||false})};u.prototype.setTitle=function(t){this.setProperty("title",t,true);this._oDialog.setTitle(t).setShowHeader(!!t);return this};u.prototype.setTooltip=function(t){this._oDialog.setTooltip(t);return this};u.prototype.getTooltip=function(){this._oDialog.getTooltip();return this};u.prototype.setText=function(t){this.setProperty("text",t,true);if(!this._oLabel){if(t){this._oLabel=new n(this.getId()+"-TextLabel",{text:t}).addStyleClass("sapMBusyDialogLabel");this._oDialog.insertAggregation("content",this._oLabel,0);this._oDialog.addAriaLabelledBy(this._oLabel.getId())}}else{if(t){this._oLabel.setText(t).setVisible(true)}else{this._oLabel.setVisible(false)}}return this};u.prototype.setCustomIcon=function(t){this.setProperty("customIcon",t,true);this._busyIndicator.setCustomIcon(t);return this};u.prototype.setCustomIconRotationSpeed=function(t){this.setProperty("customIconRotationSpeed",t,true);this._busyIndicator.setCustomIconRotationSpeed(t);return this};u.prototype.setCustomIconDensityAware=function(t){this.setProperty("customIconDensityAware",t,true);this._busyIndicator.setCustomIconDensityAware(t);return this};u.prototype.setCustomIconWidth=function(t){this.setProperty("customIconWidth",t,true);this._busyIndicator.setCustomIconWidth(t);return this};u.prototype.setCustomIconHeight=function(t){this.setProperty("customIconHeight",t,true);this._busyIndicator.setCustomIconHeight(t);return this};u.prototype.setShowCancelButton=function(t){this.setProperty("showCancelButton",t,false);if(t){this._oDialog.setEndButton(this._getCancelButton())}else{this._destroyTheCancelButton()}return this};u.prototype.setCancelButtonText=function(t){this.setProperty("cancelButtonText",t,false);if(t){this._getCancelButton().setText(t);this._oDialog.setEndButton(this._getCancelButton())}else{this._destroyTheCancelButton()}return this};u.prototype.getDomRef=function(){return this._oDialog&&this._oDialog.getDomRef()};["addStyleClass","removeStyleClass","toggleStyleClass","hasStyleClass"].forEach(function(t){u.prototype[t]=function(){if(this._oDialog&&this._oDialog[t]){return this._oDialog[t].apply(this._oDialog,arguments)}}});u.prototype._destroyTheCancelButton=function(){this._oDialog.destroyEndButton();this._cancelButton=null};u.prototype._getCancelButton=function(){var t=this.getCancelButtonText();t=t?t:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("BUSYDIALOG_CANCELBUTTON_TEXT");return this._cancelButton?this._cancelButton:this._cancelButton=new a(this.getId()+"busyCancelBtn",{text:t,press:function(){this.close(true)}.bind(this)})};return u});