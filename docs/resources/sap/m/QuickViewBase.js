/*
 * ! UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","jquery.sap.dom"],function(e,t,a){"use strict";var r=a.extend("sap.m.QuickViewBase",{metadata:{library:"sap.m",properties:{},defaultAggregation:"pages",aggregations:{pages:{type:"sap.m.QuickViewPage",multiple:true,singularName:"page",bindable:"bindable"}},events:{navigate:{allowPreventDefault:true,parameters:{from:{type:"sap.ui.core.Control"},fromId:{type:"string"},to:{type:"sap.ui.core.Control"},toId:{type:"string"},firstTime:{type:"boolean"},isTo:{type:"boolean"},isBack:{type:"boolean"},isBackToTop:{type:"boolean"},isBackToPage:{type:"boolean"},direction:{type:"string"},navOrigin:{type:"sap.ui.core.Control"}}},afterNavigate:{parameters:{from:{type:"sap.ui.core.Control"},fromId:{type:"string"},to:{type:"sap.ui.core.Control"},toId:{type:"string"},firstTime:{type:"boolean"},isTo:{type:"boolean"},isBack:{type:"boolean"},isBackToTop:{type:"boolean"},isBackToPage:{type:"boolean"},direction:{type:"string"},isTopPage:{type:"boolean"},navOrigin:{type:"sap.ui.core.Control"}}}}}});r.prototype.navigateBack=function(){if(!this._oNavContainer.currentPageIsTopPage()){this._setNavOrigin(null);this._oNavContainer.back()}};r.prototype.getNavContainer=function(){return this._oNavContainer};r.prototype._initPages=function(){var e=this._oNavContainer;e.destroyPages();e.init();var t=this.getAggregation("pages");if(!t){return}var a=this.getId();for(var r=0;r<t.length;r++){var o=t[r];o._oPage=null;var i={hasBackButton:r>0,popover:this._oPopover,navContainer:e,quickViewId:a,quickView:this};o.setNavContext(i);var n=this._createPage(o);this._oNavContainer.addPage(n)}};r.prototype._processKeyboard=function(t){if(t.shiftKey&&t.which===e.sap.KeyCodes.ENTER){this.navigateBack();t.preventDefault()}};r.prototype._createPage=function(e){return e};r.prototype._navigate=function(t){var a=t.getParameter("to");var r=t.getParameter("from");var o=t.getParameter("toId");var i=t.getParameter("fromId");var n=e.sap.byId(i).index();var s=e.sap.byId(o).index();if(s==-1||s>n){a.addStyleClass("sapMNavItemOffset")}else{r.addStyleClass("sapMNavItemOffset")}r.$().parents(".sapMPanelContent").scrollTop(0);var p=t.getParameters();if(this._navOrigin){p.navOrigin=this._navOrigin}this.fireNavigate(p)};r.prototype._afterNavigate=function(t){var a=t.getParameter("to");var r=t.getParameter("from");var o=t.getParameter("toId");var i=t.getParameter("fromId");var n=e.sap.byId(i).index();var s=e.sap.byId(o).index();if(s>n){a.removeStyleClass("sapMNavItemOffset")}else{r.removeStyleClass("sapMNavItemOffset")}var p=t.getParameters();p.isTopPage=this._oNavContainer.currentPageIsTopPage();if(this._navOrigin){p.navOrigin=this._navOrigin}this.fireAfterNavigate(p);this._setLinkWidth();e.sap.delayedCall(0,this,this._restoreFocus)};r.prototype._restoreFocus=function(){var t=this._oNavContainer.getCurrentPage();var a=this._oNavContainer._mFocusObject[t.getId()];if(!a){var r=t.getContent();if(r&&r.length>1){a=r[1].$().firstFocusableDomRef()}}if(a){e.sap.focus(a)}};r.prototype._setLinkWidth=function(){};r.prototype._setNavOrigin=function(e){this._navOrigin=e};return r});