/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/library","./BusyIndicatorRenderer"],function(t,e,o,i,s){"use strict";var n=i.TextDirection;var r=o.extend("sap.m.BusyIndicator",{metadata:{library:"sap.m",properties:{text:{type:"string",group:"Data",defaultValue:""},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:n.Inherit},customIcon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:""},customIconRotationSpeed:{type:"int",group:"Appearance",defaultValue:1e3},customIconDensityAware:{type:"boolean",defaultValue:true},customIconWidth:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"44px"},customIconHeight:{type:"sap.ui.core.CSSSize",group:"Appearance",defaultValue:"44px"},size:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"1rem"},design:{type:"string",group:"Appearance",defaultValue:"auto"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}}}});r.prototype.init=function(){this.setBusyIndicatorDelay(0)};r.prototype.setText=function(t){this.setProperty("text",t,true);this._createLabel("setText",t);return this};r.prototype.setTextDirection=function(t){this.setProperty("textDirection",t,true);this._createLabel("setTextDirection",t);return this};r.prototype.setCustomIcon=function(t){this.setProperty("customIcon",t,false);this._createCustomIcon("setSrc",t);return this};r.prototype.setCustomIconRotationSpeed=function(t){if(isNaN(t)||t<0){t=0}if(t!==this.getCustomIconRotationSpeed()){this.setProperty("customIconRotationSpeed",t,true);this._setRotationSpeed()}return this};r.prototype.setCustomIconDensityAware=function(t){this.setProperty("customIconDensityAware",t,true);this._createCustomIcon("setDensityAware",t);return this};r.prototype.setCustomIconWidth=function(t){this.setProperty("customIconWidth",t,true);this._createCustomIcon("setWidth",t);return this};r.prototype.setCustomIconHeight=function(t){this.setProperty("customIconHeight",t,true);this._createCustomIcon("setHeight",t);return this};r.prototype.setSize=function(t){this.setProperty("size",t,true);var e=this.getDomRef();if(e){e.style.fontSize=t}return this};r.prototype.onBeforeRendering=function(){if(this.getCustomIcon()){this.setBusy(false)}else{this.setBusy(true,"busy-area")}};r.prototype.exit=function(){if(this._iconImage){this._iconImage.destroy();this._iconImage=null}if(this._busyLabel){this._busyLabel.destroy();this._busyLabel=null}};r.prototype._createCustomIcon=function(t,e){if(!this._iconImage){this._iconImage=new sap.m.Image(this.getId()+"-icon",{width:"44px",height:"44px"}).addStyleClass("sapMBsyIndIcon");this._iconImage.addEventDelegate({onAfterRendering:function(){this._setRotationSpeed()}},this)}this._iconImage[t](e);this._setRotationSpeed()};r.prototype._createLabel=function(t,e){if(!this._busyLabel){this._busyLabel=new sap.m.Label(this.getId()+"-label",{labelFor:this.getId(),textAlign:"Center"})}this._busyLabel[t](e)};r.prototype._setRotationSpeed=function(){if(!this._iconImage){return}if(t.support.cssAnimations){var e=this._iconImage.$();var o=this.getCustomIconRotationSpeed()+"ms";e.css("-webkit-animation-duration",o).css("animation-duration",o);e.css("display","none");setTimeout(function(){e.css("display","inline")},0)}else{this._rotateCustomIcon()}};r.prototype._rotateCustomIcon=function(){if(!this._iconImage){return}var e=this._iconImage.$();if(!e[0]||!e[0].offsetWidth){return}var o=this.getCustomIconRotationSpeed();if(!o){return}if(!this._fnRotateCustomIcon){this._fnRotateCustomIcon=t.proxy(this._rotateCustomIcon,this)}var i=this._fnRotateCustomIcon;if(!this._$CustomRotator){this._$CustomRotator=t({deg:0})}var s=this._$CustomRotator;if(s.running){return}s[0].deg=0;s.animate({deg:360},{duration:o,easing:"linear",step:function(t){s.running=true;e.css("-ms-transform","rotate("+t+"deg)")},complete:function(){s.running=false;window.setTimeout(i,10)}})};return r});