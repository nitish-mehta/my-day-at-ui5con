/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/base/Metadata","sap/m/library"],function(e,r,t){"use strict";var n=t.LinkConversion;var i=r.createClass("sap.m.FormattedTextAnchorGenerator",{});var o=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;()$]*[-A-Z0-9+&@#\/%=~_|])/gim;var a=/(www\.[^\s><]+(\b|$))/gim;var s="//";var c=/<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+(?!\/\s\*)>/gim;var u=/<a[^>]*>([^<]+)<\/a>/gim;var l=[c,u];i.generateAnchors=function(e,r,t){if(r===n.ProtocolOnly){e=i._createAnchors(e,o,t)}if(r===n.All){e=i._createAnchors(e,o,t);e=i._createAnchors(e,a,t,s)}return e};i._createPositionObject=function(e,r){return{iStartPos:e,iEndPos:e+r}};i._isNested=function(e,r){return e.iStartPos<r.iStartPos&&e.iEndPos>r.iEndPos};i._isAllowed=function(e,r){return e.some(function(e){return i._isNested(e,r)})};i._shouldBeProcessed=function(r,t,n){return e.sap.validateUrl(r)&&!i._isAllowed(n,t)};i._scanForEntitiesToSkip=function(e,r){var t=[],n;while((n=e.exec(r))!==null){t.push(i._createPositionObject(n.index,n[0].length))}return t};i._getEntitiesToSkipWhileSearchingForLinks=function(e){return l.map(function(r){return i._scanForEntitiesToSkip(r,e)}).reduce(function(e,r){return e.concat(r)})};i._createAnchors=function(e,r,t,n){var o=i._getEntitiesToSkipWhileSearchingForLinks(e),a;n=n||"";a=function(e){var r=i._createPositionObject(arguments[3],e.length);if(!i._shouldBeProcessed(e,r,o)){return e}return'<a href="'+n+e+'" target="'+t+'">'+e+"</a>"};return e.replace(r,a)};return i},false);