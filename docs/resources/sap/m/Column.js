/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Element","sap/ui/core/Renderer","sap/ui/core/library","sap/ui/Device"],function(e,t,i,r,n,s){"use strict";var a=t.PopinDisplay;var o=n.VerticalAlign;var p=n.TextAlign;var l=i.extend("sap.m.Column",{metadata:{library:"sap.m",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},hAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:p.Begin},vAlign:{type:"sap.ui.core.VerticalAlign",group:"Appearance",defaultValue:o.Inherit},styleClass:{type:"string",group:"Appearance",defaultValue:null},visible:{type:"boolean",group:"Appearance",defaultValue:true},minScreenWidth:{type:"string",group:"Behavior",defaultValue:null},demandPopin:{type:"boolean",group:"Behavior",defaultValue:false},popinHAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:p.Begin,deprecated:true},popinDisplay:{type:"sap.m.PopinDisplay",group:"Appearance",defaultValue:a.Block},mergeDuplicates:{type:"boolean",group:"Behavior",defaultValue:false},mergeFunctionName:{type:"string",group:"Misc",defaultValue:"getText"}},defaultAggregation:"header",aggregations:{header:{type:"sap.ui.core.Control",multiple:false},footer:{type:"sap.ui.core.Control",multiple:false}},designtime:"sap/m/designtime/Column.designtime"}});l.prototype._index=-1;l.prototype._screen="";l.prototype._media=null;l.prototype.exit=function(){this._clearMedia()};l.prototype._clearMedia=function(){if(this._media&&this._minWidth){this._detachMediaContainerWidthChange(this._notifyResize,this,this.getId());s.media.removeRangeSet(this.getId());this._media=null}};l.prototype._addMedia=function(){delete this._bShouldAddMedia;if(this._minWidth){s.media.initRangeSet(this.getId(),[parseFloat(this._minWidth)]);this._attachMediaContainerWidthChange(this._notifyResize,this,this.getId());this._media=this._getCurrentMediaContainerRange(this.getId());if(this._media){this._media.matches=!!this._media.from}}};l.prototype._notifyResize=function(t){if(this._media.from===t.from){return}this._media=t;this._media.matches=!!t.from;e.sap.delayedCall(0,this,function(){var e=this.getParent();this.fireEvent("media",this);if(e&&e.onColumnResize){e.onColumnResize(this)}})};l.prototype._validateMinWidth=function(e){if(!e){return}if(Object.prototype.toString.call(e)!="[object String]"){throw new Error('expected string for property "minScreenWidth" of '+this)}if(Object.keys(t.ScreenSizes).indexOf(e.toLowerCase())!=-1){return}if(!/^\d+(\.\d+)?(px|em|rem)$/i.test(e)){throw new Error('invalid CSS size("px", "em", "rem" required) or sap.m.ScreenSize enumeration for property "minScreenWidth" of '+this)}};l.prototype._isWidthPredefined=function(i){var r=this,n=i.replace(/[^a-z]/gi,""),s=parseFloat(t.BaseFontSize)||16;e.each(t.ScreenSizes,function(e,t){if(n!="px"){t/=s}if(t+n==i){r._minWidth=this+"px";r._screen=e;return false}});if(this._minWidth){return true}if(n=="px"){this._minWidth=i}else{this._minWidth=parseFloat(i)*s+"px"}};l.prototype.applyAlignTo=function(e,t){t=t||this.getHAlign();if(t===p.Initial||!e.getMetadata().getProperties().textAlign||e.getTextAlign()===t){return e}e.setProperty("textAlign",t,true);var i=e.getDomRef();t=this.getCssAlign(t);if(i&&t){i.style.textAlign=t}return e};l.prototype.getCssAlign=function(e){e=e||this.getHAlign();if(e===p.Begin||e===p.End||e===p.Initial){e=r.getTextAlign(e)}return e.toLowerCase()};l.prototype.getStyleClass=function(e){var t=this.getProperty("styleClass");if(!e){return t}if(this._screen&&(!this.getDemandPopin()||!window.matchMedia)){t+=" sapMSize-"+this._screen}else if(this._media&&!this._media.matches){t+=" sapMListTblNone"}return t.trim()};l.prototype.setIndex=function(e){this._index=+e};l.prototype.setOrder=function(e){this._order=+e};l.prototype.getOrder=function(){return this.hasOwnProperty("_order")?this._order:this.getInitialOrder()};l.prototype.setInitialOrder=function(e){this._initialOrder=+e};l.prototype.getInitialOrder=function(){if(this.hasOwnProperty("_initialOrder")){return this._initialOrder}var e=this.getParent();if(e&&e.indexOfColumn){return e.indexOfColumn(this)}return-1};l.prototype.setDisplay=function(e,t){if(!e||this._index<0){return}var i=this._index+1,r=this.getParent(),n=t?"table-cell":"none",s=e.querySelector("tr > th:nth-child("+i+")"),a=e.querySelectorAll("tr > td:nth-child("+i+")"),o=a.length;s.style.display=n;s.setAttribute("aria-hidden",!t);for(i=0;i<o;i++){a[i].style.display=n;a[i].setAttribute("aria-hidden",!t)}if(r&&r.setTableHeaderVisibility){setTimeout(function(){r.setTableHeaderVisibility(t)},0)}};l.prototype.setDisplayViaMedia=function(e){var t=this.getParent(),i=this._media&&this._media.matches;if(!this.getDemandPopin()&&this._screen&&t&&t.setTableHeaderVisibility){setTimeout(function(){t.setTableHeaderVisibility(i)},0)}else{this.setDisplay(e,i)}};l.prototype.setVisible=function(e){if(e==this.getVisible()){return this}var t=this.getParent(),i=t&&t.getTableDomRef&&t.getTableDomRef(),r=i&&this._index>=0;this.setProperty("visible",e,r);if(r){this.setDisplay(i,e)}return this};l.prototype.setMinScreenWidth=function(e){var i=this.getParent();if(e==this.getMinScreenWidth()){return this}this._validateMinWidth(e);this._clearMedia();this._minWidth=0;this._screen="";if(e){e=e.toLowerCase();var r=t.ScreenSizes[e];if(r){this._screen=e;this._minWidth=r+"px"}else{this._isWidthPredefined(e)}if(i&&i.isActive()){this._addMedia()}else{this._bShouldAddMedia=true}}return this.setProperty("minScreenWidth",e)};l.prototype.setDemandPopin=function(e){if(e==this.getDemandPopin()){return this}if(!this.getMinScreenWidth()){return this.setProperty("demandPopin",e,true)}return this.setProperty("demandPopin",e)};l.prototype.isPopin=function(){if(!this.getDemandPopin()){return false}if(this._media){return!this._media.matches}return false};l.prototype.isHidden=function(){if(this._media){return!this._media.matches}if(this._screen&&this._minWidth){return parseFloat(this._minWidth)>window.innerWidth}return false};l.prototype.setLastValue=function(e){if(this.getMergeDuplicates()){this._lastValue=e}return this};l.prototype.clearLastValue=function(){return this.setLastValue(NaN)};l.prototype.getLastValue=function(){return this._lastValue};l.prototype.onItemsRemoved=function(){this.clearLastValue()};return l});