/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/ValueStateSupport","sap/ui/core/library","./ProgressIndicatorRenderer"],function(e,t,a,r,i,s){"use strict";var u=i.TextDirection;var l=i.ValueState;var n=a.extend("sap.m.ProgressIndicator",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.m",properties:{enabled:{type:"boolean",group:"Behavior",defaultValue:true},state:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:l.None},displayValue:{type:"string",group:"Appearance",defaultValue:null},percentValue:{type:"float",group:"Data",defaultValue:0},showValue:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:u.Inherit},displayOnly:{type:"boolean",group:"Behavior",defaultValue:false}},designtime:"sap/m/designtime/ProgressIndicator.designtime"}});var o=sap.ui.getCore().getConfiguration().getAnimation();n.prototype.setPercentValue=function(t){var a=this,r,i,s=this.$(),u,l;t=this.validateProperty("percentValue",t);if(!p(t)){l=t;t=t>100?100:0;e.sap.log.warning(this+": percentValue ("+l+") is not correct! Setting the percentValue to "+t)}if(this.getPercentValue()!==t){i=this.getPercentValue()-t;this.setProperty("percentValue",t,true);if(!s.length){return this}["sapMPIValueMax","sapMPIValueMin","sapMPIValueNormal","sapMPIValueGreaterHalf"].forEach(function(e){s.removeClass(e)});s.addClass(this._getCSSClassByPercentValue(t));s.addClass("sapMPIAnimate").attr("aria-valuenow",t).attr("aria-valuetext",this._getAriaValueText({fPercent:t}));u=o?Math.abs(i)*20:0;r=this.$("bar");r.stop();r.animate({"flex-basis":t+"%"},u,"linear",function(){a._setText.apply(a);a.$().removeClass("sapMPIAnimate")})}return this};n.prototype._setText=function(){this.$().toggleClass("sapMPIValueGreaterHalf",this.getPercentValue()>50);return this};n.prototype.setDisplayValue=function(e){this.setProperty("displayValue",e,true);var t=this.$("textLeft");var a=this.$("textRight");t.text(e);a.text(e);this.$().attr("aria-valuetext",this._getAriaValueText({sText:e}));return this};n.prototype.setDisplayOnly=function(e){this.setProperty("displayOnly",e,true);if(this.getDomRef()){this.$().toggleClass("sapMPIDisplayOnly",e)}return this};n.prototype._getCSSClassByPercentValue=function(e){if(e===100){return"sapMPIValueMax sapMPIValueGreaterHalf"}if(e===0){return"sapMPIValueMin"}if(e<=50){return"sapMPIValueNormal"}return"sapMPIValueNormal sapMPIValueGreaterHalf"};n.prototype._getAriaValueText=function(e){e.sText=e.sText||this.getDisplayValue();e.fPercent=e.fPercent||this.getPercentValue();e.sStateText=e.sStateText||this._getStateText();var t=e.sText||e.fPercent+"%";if(e.sStateText){t+=" "+e.sStateText}return t};n.prototype._getStateText=function(){return r.getAdditionalText(this.getState())};n.prototype.getAccessibilityInfo=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.m");return{role:"progressbar",type:e.getText("ACC_CTR_TYPE_PROGRESS"),description:e.getText("ACC_CTR_STATE_PROGRESS",[this.getPercentValue()]),focusable:this.getEnabled(),enabled:this.getEnabled()}};function p(e){return e>=0&&e<=100}return n});