/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/EnabledPropagator","sap/ui/core/delegate/ItemNavigation","sap/ui/core/IconPool","sap/ui/core/delegate/ScrollEnablement","./IconTabBarSelectList","./Button","./ResponsivePopover","./IconTabFilter","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ui/core/Icon","./IconTabBarDragAndDropUtil","sap/ui/core/dnd/DragInfo","sap/ui/core/dnd/DropInfo","./IconTabHeaderRenderer"],function(e,t,o,i,r,s,a,n,l,h,c,p,f,g,d,u,_,I){"use strict";var m=t.touch;var v=t.ImageHelper;var S=t.PlacementType;var y=t.ButtonType;var b=t.BackgroundDesign;var T=t.IconTabHeaderMode;var w=t.IconTabDensityMode;var C=o.extend("sap.m.IconTabHeader",{metadata:{library:"sap.m",properties:{showSelection:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},selectedKey:{type:"string",group:"Data",defaultValue:null},visible:{type:"boolean",group:"Behavior",defaultValue:true},mode:{type:"sap.m.IconTabHeaderMode",group:"Appearance",defaultValue:T.Standard},showOverflowSelectList:{type:"boolean",group:"Appearance",defaultValue:false},backgroundDesign:{type:"sap.m.BackgroundDesign",group:"Appearance",defaultValue:b.Solid},enableTabReordering:{type:"boolean",group:"Behavior",defaultValue:false},tabDensityMode:{type:"sap.m.IconTabDensityMode",group:"Appearance",defaultValue:w.Cozy}},aggregations:{items:{type:"sap.m.IconTab",multiple:true,singularName:"item",dnd:{draggable:true,droppable:true,layout:"Horizontal"}}},events:{select:{parameters:{item:{type:"sap.m.IconTabFilter"},key:{type:"string"}}}}}});i.apply(C.prototype,[true]);C.SCROLL_STEP=264;C.prototype.init=function(){this._bPreviousScrollForward=false;this._bPreviousScrollBack=false;this._iCurrentScrollLeft=0;this.startScrollX=0;this.startTouchX=0;this._scrollable=null;this._aTabKeys=[];this._oItemNavigation=(new r).setCycling(false);this._oItemNavigation.attachEvent(r.Events.FocusLeave,this._onItemNavigationFocusLeave,this);this._oItemNavigation.attachEvent(r.Events.AfterFocus,this._onItemNavigationAfterFocus,this);this._oItemNavigation.setDisabledModifiers({sapnext:["alt","meta"],sapprevious:["alt","meta"]});this.addDelegate(this._oItemNavigation);this._oScroller=new a(this,this.getId()+"-head",{horizontal:true,vertical:false,nonTouchScrolling:true})};C.prototype.isTouchScrollingDisabled=function(){return this.getShowOverflowSelectList()&&this.getParent().getMetadata().getName()=="sap.tnt.ToolHeader"};C.prototype._getSelectList=function(){var e=this;if(!this._oSelectList){this._oSelectList=new n({selectionChange:function(t){var o=t.getParameter("selectedItem");e.setSelectedItem(o._tabFilter)}});this._oSelectList._iconTabHeader=this}return this._oSelectList};C.prototype._getOverflowButton=function(){if(!this._oOverflowButton){this._oOverflowButton=new l({id:this.getId()+"-overflow",icon:"sap-icon://slim-arrow-down",type:y.Transparent,press:this._overflowButtonPress.bind(this)})}return this._oOverflowButton};C.prototype._overflowButtonPress=function(e){if(!this._oPopover){this._oPopover=new h({showArrow:false,showHeader:false,placement:S.Vertical,offsetX:0,offsetY:0}).addStyleClass("sapMITBPopover");if(p.system.phone){this._oPopover._oControl.addButton(this._createPopoverCloseButton())}this.addDependent(this._oPopover)}var t=this._getSelectList();this._setSelectListItems();this._oPopover.removeAllContent();this._oPopover.addContent(t);this._oPopover.setInitialFocus(t.getSelectedItem());this._oPopover.openBy(this._getOverflowButton())};C.prototype._createPopoverCloseButton=function(){var e=this;var t=sap.ui.getCore().getLibraryResourceBundle("sap.m");return new l({text:t.getText("SELECT_CANCEL_BUTTON"),press:function(){e._closeOverflow()}})};C.prototype._closeOverflow=function(){if(!p.system.desktop){this._oPopover.close()}if(this.oSelectedItem){this.oSelectedItem.$().focus()}};C.prototype._setSelectListItems=function(){if(!this.getShowOverflowSelectList()){return}var e,t,o=this._getSelectList(),i=this.getTabFilters();o.destroyItems();for(var r=0;r<i.length;r++){t=i[r];e=t.clone();e._tabFilter=t;o.addItem(e);if(t==this.oSelectedItem){o.setSelectedItem(e)}}};C.prototype._findSelectItem=function(e){var t=this._getSelectList(),o=t.getItems(),i;for(var r=0;r<o.length;r++){i=o[r];if(i._tabFilter==e){return i}}};C.prototype._onItemNavigationFocusLeave=function(){if(!this.oSelectedItem){return}var e=this.getItems();var t=-1;var o;for(var i=0;i<e.length;i++){o=e[i];if(o instanceof c==false){continue}t++;if(this.oSelectedItem==o){break}}this._oItemNavigation.setFocusedIndex(t)};C.prototype._onItemNavigationAfterFocus=function(e){var t=this.getDomRef("head"),o=e.getParameter("index"),i=e.getParameter("event");if(i.keyCode===undefined){return}this._iCurrentScrollLeft=t.scrollLeft;this._checkOverflow();if(o!==null&&o!==undefined){this._scrollIntoView(this.getTabFilters()[o],0)}};C.prototype.getTabFilters=function(){var e=this.getItems();var t=[];e.forEach(function(e){if(e instanceof c){t.push(e)}});return t};C.prototype.exit=function(){if(this._oArrowLeft){this._oArrowLeft.destroy()}if(this._oArrowRight){this._oArrowRight.destroy()}if(this._oItemNavigation){this.removeDelegate(this._oItemNavigation);this._oItemNavigation.destroy();delete this._oItemNavigation}if(this._oScroller){this._oScroller.destroy();this._oScroller=null}if(this._sResizeListenerId){f.deregister(this._sResizeListenerId);this._sResizeListenerId=null}if(this._aTabKeys){this._aTabKeys=null}if(this._oPopover){this._oPopover.destroy();this._oPopover=null}if(this._oOverflowButton){this._oOverflowButton.removeEventDelegate(this._onDragOverEventDelegate);this._oOverflowButton.destroy();this._oOverflowButton=null}};C.prototype._handlesOnDragOver=function(){if(!this._oPopover||!this._oPopover.isOpen()){this._overflowButtonPress()}};C.prototype._setsDragAndDropConfigurations=function(){var e=this._getOverflowButton();if(!this.getEnableTabReordering()&&this.getDragDropConfig().length){this.destroyDragDropConfig()}else if(this.getEnableTabReordering()&&!this.getDragDropConfig().length){e.addEventDelegate(this._onDragOverEventDelegate);d.setDragDropAggregations(this,u,_,"Horizontal")}};C.prototype.onBeforeRendering=function(){var e=this.getItems(),t=this.getSelectedKey(),o=0,i=this.getParent(),r=i instanceof sap.m.IconTabBar,s=i&&i.getMetadata().getName()=="sap.tnt.ToolHeader";this._bRtl=sap.ui.getCore().getConfiguration().getRTL();this._onDragOverEventDelegate={ondragover:this._handlesOnDragOver.bind(this)};if(this._sResizeListenerId){f.deregister(this._sResizeListenerId);this._sResizeListenerId=null}if(e.length>0){if(!this.oSelectedItem||t&&t!==this.oSelectedItem._getNonEmptyKey()){if(t){for(;o<e.length;o++){if(!(e[o]instanceof sap.m.IconTabSeparator)&&e[o]._getNonEmptyKey()===t){this.oSelectedItem=e[o];break}}}if(!this.oSelectedItem&&(r||!t)){for(o=0;o<e.length;o++){if(!(e[o]instanceof sap.m.IconTabSeparator)&&e[o].getVisible()){this.oSelectedItem=e[o];break}}}}if(!s&&this.oSelectedItem&&!this.oSelectedItem.getVisible()){for(o=0;o<e.length;o++){if(!(e[o]instanceof sap.m.IconTabSeparator)&&e[o].getVisible()){this.oSelectedItem=e[o];break}}}if(this.oSelectedItem){this.setProperty("selectedKey",this.oSelectedItem._getNonEmptyKey(),true)}}this._isTouchScrollingDisabled=this.isTouchScrollingDisabled();this._oScroller.setHorizontal(!this._isTouchScrollingDisabled&&(!this.getEnableTabReordering()||!p.system.desktop));this._setsDragAndDropConfigurations();if(this._sResizeListenerNoFlexboxSupportId){f.deregister(this._sResizeListenerNoFlexboxSupportId);this._sResizeListenerNoFlexboxSupportId=null}};C.prototype.setSelectedKey=function(e){var t=this.getTabFilters(),o=0,i=this.getParent(),r=i instanceof sap.m.IconTabBar,s;if(t.length>0){e=e||t[0]._getNonEmptyKey()}if(this.$().length){for(;o<t.length;o++){if(t[o]._getNonEmptyKey()===e){this.setSelectedItem(t[o],true);s=true;break}}if(!s&&!r&&e){this.setSelectedItem(null)}}this.setProperty("selectedKey",e,true);return this};C.prototype.setSelectedItem=function(e,t){if(!e){if(this.oSelectedItem){this.oSelectedItem.$().removeClass("sapMITBSelected");this.oSelectedItem=null}return this}if(!e.getEnabled()){return this}if(this.getShowOverflowSelectList()){var o=this._findSelectItem(e);if(o){this._getSelectList().setSelectedItem(o)}}var i=this.getParent();var r=i instanceof sap.m.IconTabBar;var s=false;if(e.getContent().length===0&&this.oSelectedItem&&this.oSelectedItem.getContent().length===0){s=true}if(this.oSelectedItem&&this.oSelectedItem.getVisible()&&(!t&&r&&i.getExpandable()||this.oSelectedItem!==e)){this.oSelectedItem.$().removeClass("sapMITBSelected").attr("aria-selected",false).removeAttr("aria-expanded")}if(e.getVisible()){if(this.oSelectedItem===e){if(!t&&r&&i.getExpandable()){i._toggleExpandCollapse()}}else{if(r){i.$("content").attr("aria-labelledby",e.sId)}this.oSelectedItem=e;this.setProperty("selectedKey",this.oSelectedItem._getNonEmptyKey(),true);if(!r){this.oSelectedItem.$().addClass("sapMITBSelected").attr({"aria-selected":true})}if(r&&(i.getExpandable()||i.getExpanded())){this.oSelectedItem.$().addClass("sapMITBSelected").attr({"aria-selected":true});var a=this.oSelectedItem.getContent();if(a.length>0){i._rerenderContent(a)}else{if(!s){i._rerenderContent(i.getContent())}}if(!t&&i.getExpandable()&&!i.getExpanded()){i._toggleExpandCollapse(true)}}}if(this.oSelectedItem.$().length>0){this._scrollIntoView(e,500)}else{this._scrollAfterRendering=true}}this.oSelectedItem=e;var n=this.oSelectedItem._getNonEmptyKey();this.setProperty("selectedKey",n,true);if(r){i.setProperty("selectedKey",n,true)}if(!t){if(r){i.fireSelect({selectedItem:this.oSelectedItem,selectedKey:n,item:this.oSelectedItem,key:n})}else{this.fireSelect({selectedItem:this.oSelectedItem,selectedKey:n,item:this.oSelectedItem,key:n})}}return this};C.prototype.getVisibleTabFilters=function(){var e=this.getTabFilters(),t=[],o;for(var i=0;i<e.length;i++){o=e[i];if(o.getVisible()){t.push(o)}}return t};C.prototype._getFirstVisibleItem=function(e){for(var t=0;t<e.length;t++){if(e[t].getVisible()){return e[t]}}return null};C.prototype._initItemNavigation=function(){var t=this,o=this.getDomRef("head"),i=this.getItems(),s=[],a=-1;i.forEach(function(o){if(o instanceof c){var i=t.getFocusDomRef(o);e(i).attr("tabindex","-1");s.push(i);if(o===t.oSelectedItem){a=s.indexOf(i)}}});if(!this._oItemNavigation){this._oItemNavigation=new r;this._oItemNavigation.attachEvent(r.Events.FocusLeave,this._onItemNavigationFocusLeave,this);this._oItemNavigation.attachEvent(r.Events.AfterFocus,this._onItemNavigationAfterFocus,this);this.addDelegate(this._oItemNavigation)}this._oItemNavigation.setRootDomRef(o);this._oItemNavigation.setItemDomRefs(s);this._oItemNavigation.setSelectedIndex(a)};C.prototype.onThemeChanged=function(){this._applyTabDensityMode()};C.prototype._applyTabDensityMode=function(){var e=this.getTabDensityMode();this.$().removeClass("sapUiSizeCompact");switch(e){case w.Compact:this.$().addClass("sapUiSizeCompact");break;case w.Inherit:if(this.$().closest(".sapUiSizeCompact").length){this.$().addClass("sapUiSizeCompact")}break}};C.prototype.onAfterRendering=function(){this._applyTabDensityMode();if(this._oScroller){this._oScroller.setIconTabBar(this,e.proxy(this._afterIscroll,this),e.proxy(this._scrollPreparation,this))}var t=this.getParent();var o=t instanceof sap.m.IconTabBar;if(this.oSelectedItem&&(!o||o&&t.getExpanded())){this.oSelectedItem.$().addClass("sapMITBSelected").attr({"aria-selected":true})}e.sap.delayedCall(350,this,"_checkOverflow");if(this.oSelectedItem){this._scrollIntoView(this.oSelectedItem,500)}this._initItemNavigation();if(this.getShowOverflowSelectList()){this.$("overflow").attr("tabindex",-1)}this._sResizeListenerId=f.register(this.getDomRef(),e.proxy(this._fnResize,this));if(!e.support.newFlexBoxLayout&&o&&t.getStretchContentHeight()){this._sResizeListenerNoFlexboxSupportId=f.register(t.getDomRef(),e.proxy(this._fnResizeNoFlexboxSupport,this));this._fnResizeNoFlexboxSupport()}this._bCheckIfIntoView=true};C.prototype.destroyItems=function(){this.oSelectedItem=null;this._aTabKeys=[];this.destroyAggregation("items")};C.prototype.addItem=function(t){if(!(t instanceof sap.m.IconTabSeparator)){var o=t.getKey();if(this._aTabKeys.indexOf(o)!==-1){e.sap.log.warning("sap.m.IconTabHeader: duplicate key '"+o+"' inside the IconTabFilter. Please use unique keys.")}this._aTabKeys.push(o)}this.addAggregation("items",t)};C.prototype.insertItem=function(t,o){if(!(t instanceof sap.m.IconTabSeparator)){var i=t.getKey();if(this._aTabKeys.indexOf(i)!==-1){e.sap.log.warning("sap.m.IconTabHeader: duplicate key '"+i+"' inside the IconTabFilter. Please use unique keys.")}this._aTabKeys.push(i)}this.insertAggregation("items",t,o)};C.prototype.removeAllItems=function(){this._aTabKeys=[];return this.removeAllAggregation("items")};C.prototype.removeItem=function(e){e=this.removeAggregation("items",e);if(e&&!(e instanceof sap.m.IconTabSeparator)){var t=e.getKey();this._aTabKeys.splice(this._aTabKeys.indexOf(t),1)}return e};C.prototype.updateAggregation=function(){this.oSelectedItem=null;return o.prototype.updateAggregation.apply(this,arguments)};C.prototype.removeAggregation=function(t,i,r){var s=this.getTabFilters();var a=o.prototype.removeAggregation.apply(this,arguments);if(r){return a}if(a&&a==this.oSelectedItem&&t=="items"){var n=e.inArray(a,s);s=this.getTabFilters();n=Math.max(0,Math.min(n,s.length-1));var l=s[n];if(l){this.setSelectedItem(l,true)}else{var h=this.getParent();if(h instanceof sap.m.IconTabBar&&h.getExpanded()){h.$("content").children().remove()}}}return a};C.prototype.removeAllAggregation=function(e,t){if(e=="items"){var i=this.getParent();if(i instanceof sap.m.IconTabBar&&i.getExpanded()){i.$("content").children().remove()}}return o.prototype.removeAllAggregation.apply(this,arguments)};C.prototype._getDisplayText=function(e){var t=e.getText();if(this.isInlineMode()){var o=e.getCount();if(o){if(this._bRtl){t="("+o+") "+t}else{t+=" ("+o+")"}}}return t};C.prototype.isInlineMode=function(){return this._bTextOnly&&this.getMode()==T.Inline};C.prototype._checkTextOnly=function(e){if(e.length>0){for(var t=0;t<e.length;t++){if(!(e[t]instanceof sap.m.IconTabSeparator)){if(e[t].getIcon()){this._bTextOnly=false;return false}}}}this._bTextOnly=true;return true};C.prototype._checkNoText=function(e){if(e.length>0){for(var t=0;t<e.length;t++){if(!(e[t]instanceof sap.m.IconTabSeparator)){if(e[t].getText().length>0){return false}}}}return true};C.prototype._checkInLine=function(e){var t;if(e.length>0){for(var o=0;o<e.length;o++){t=e[o];if(!(t instanceof sap.m.IconTabSeparator)){if(t.getIcon()||t.getCount()){this._bInLine=false;return false}}}}this._bInLine=true;return true};C.prototype._checkScrolling=function(e){var t=this.$();var o=false;var i=this.getDomRef("scrollContainer");var r=this.getDomRef("head");if(r&&i){if(r.offsetWidth>i.offsetWidth){o=true}}if(this._scrollable!==o){t.toggleClass("sapMITBScrollable",o);t.toggleClass("sapMITBNotScrollable",!o);this._scrollable=o}this._setTabsVisibility();return o};C.prototype._getScrollingArrow=function(e){var t=s.getIconURI("slim-arrow-"+e);var o={src:t,useIconTooltip:false};var i=this._bTextOnly?"TextOnly":"";var r="sapMITBArrowScrollLeft"+i;var a="sapMITBArrowScrollRight"+i;var n=["sapMITBArrowScroll",r];var l=["sapMITBArrowScroll",a];if(this._bInLine){n.push("sapMITBArrowScrollLeftInLine");l.push("sapMITBArrowScrollRightInLine")}if(e==="left"){if(!this._oArrowLeft){this._oArrowLeft=v.getImageControl(this.getId()+"-arrowScrollLeft",this._oArrowLeft,this,o,n)}return this._oArrowLeft}if(e==="right"){if(!this._oArrowRight){this._oArrowRight=v.getImageControl(this.getId()+"-arrowScrollRight",this._oArrowRight,this,o,l)}return this._oArrowRight}};C.prototype._checkOverflow=function(){var e=this.getDomRef("head");var t=this.$();if(this._checkScrolling(e)&&e){var o=false;var i=false;var r=this.getDomRef("scrollContainer");var s=this.getDomRef("head");if(this._oScroller.getScrollLeft()>0){o=true}if(this._oScroller.getScrollLeft()+r.offsetWidth<s.offsetWidth){i=true}if(i!=this._bPreviousScrollForward||o!=this._bPreviousScrollBack){this._bPreviousScrollForward=i;this._bPreviousScrollBack=o;t.toggleClass("sapMITBScrollBack",o);t.toggleClass("sapMITBNoScrollBack",!o);t.toggleClass("sapMITBScrollForward",i);t.toggleClass("sapMITBNoScrollForward",!i)}}else{this._bPreviousScrollForward=false;this._bPreviousScrollBack=false}};C.prototype._handleActivation=function(t){var o=t.target.id,i=t.srcControl,r,s=e(t.target);if(i instanceof l){return}var a=e.sap.byId(o);if(e.inArray(this.$("content")[0],a.parents())>-1){}else{if(o){var n=this.getId();t.preventDefault();if(o==n+"-arrowScrollLeft"&&p.system.desktop){var h=this._oScroller.getScrollLeft()-C.SCROLL_STEP;if(h<0){h=0}this._scrollPreparation();e.sap.delayedCall(0,this._oScroller,"scrollTo",[h,0,500]);e.sap.delayedCall(500,this,"_afterIscroll")}else if(o==n+"-arrowScrollRight"&&p.system.desktop){var h=this._oScroller.getScrollLeft()+C.SCROLL_STEP;var c=this.$("scrollContainer").width();var f=this.$("head").width();if(h>f-c){h=f-c}this._scrollPreparation();e.sap.delayedCall(0,this._oScroller,"scrollTo",[h,0,500]);e.sap.delayedCall(500,this,"_afterIscroll")}else{if(s.hasClass("sapMITBFilterIcon")||s.hasClass("sapMITBCount")||s.hasClass("sapMITBText")||s.hasClass("sapMITBTab")||s.hasClass("sapMITBContentArrow")||s.hasClass("sapMITBSep")||s.hasClass("sapMITBSepIcon")){r=t.srcControl.getId().replace(/-icon$/,"");i=sap.ui.getCore().byId(r);if(i.getMetadata().isInstanceOf("sap.m.IconTab")&&!(i instanceof sap.m.IconTabSeparator)){this.setSelectedItem(i)}}else if(i.getMetadata().isInstanceOf("sap.m.IconTab")&&!(i instanceof sap.m.IconTabSeparator)){this.setSelectedItem(i)}}}else{if(i.getMetadata().isInstanceOf("sap.m.IconTab")&&!(i instanceof sap.m.IconTabSeparator)){this.setSelectedItem(i)}}}};C.prototype._scrollIntoView=function(t,o){var i=t.$(),r,s,a;if(i.length>0){var n=this.$("head");var l=n.innerWidth()-n.width();var h=i.outerWidth(true);var c=i.position().left-l/2;r=this._oScroller.getScrollLeft();a=this.$("scrollContainer").width();s=0;if(c-r<0||c-r>a-h){if(c-r<0){s+=c}else{s+=Math.min(c,c+h-a);s=Math.round(s)}this._scrollPreparation();this._iCurrentScrollLeft=s;e.sap.delayedCall(0,this._oScroller,"scrollTo",[s,0,o]);e.sap.delayedCall(o,this,"_afterIscroll")}}return this};C.prototype._scroll=function(t,o){this._scrollPreparation();var i=this.getDomRef("head");var r=i.scrollLeft;var s=p.browser.msie||p.browser.edge;if(!s&&this._bRtl){t=-t}var a=r+t;e(i).stop(true,true).animate({scrollLeft:a},o,e.proxy(this._adjustAndShowArrow,this));this._iCurrentScrollLeft=a};C.prototype._adjustAndShowArrow=function(){this._$bar&&this._$bar.toggleClass("sapMITBScrolling",false);this._$bar=null;if(p.system.desktop){this._checkOverflow()}};C.prototype._scrollPreparation=function(){if(!this._$bar){this._$bar=this.$().toggleClass("sapMITBScrolling",true)}};C.prototype._afterIscroll=function(){this._checkOverflow();this._adjustAndShowArrow();this._setTabsVisibility()};C.prototype._fnResize=function(){this._checkOverflow();if(this.oSelectedItem&&this._bCheckIfIntoView){this._scrollIntoView(this.oSelectedItem,0);if(!this._isTouchScrollingDisabled){this._bCheckIfIntoView=false}}this._setTabsVisibility()};C.prototype._fnResizeNoFlexboxSupport=function(){var e=this.getParent().$("containerContent"),t=e.outerHeight(true)-e.height();e.height(this.getParent().$().height()-e.position().top-t)};C.prototype._setTabsVisibility=function(){if(!this._isTouchScrollingDisabled){return}var e=this.getItems(),t,o,i,r;for(r=0;r<e.length;r++){t=e[r];o=t.$();if(!o.hasClass("sapMITBSelected")&&!this._isTabIntoView(o)){o.addClass("sapMITBFilterHidden")}else{i=true;o.removeClass("sapMITBFilterHidden")}}if(!i){for(r=0;r<e.length;r++){t=e[r];o=t.$();if(this._isTabIntoView(o,true)){o.removeClass("sapMITBFilterHidden");break}}}this._moveVisibleTabs()};C.prototype._isTabIntoView=function(e,t){if(!e.length){return false}var o=this._oScroller.getScrollLeft(),i=this.$("scrollContainer").width(),r=this.$("head"),s=r.innerWidth()-r.width(),a=e.css("padding-left"),n=e.width()+parseFloat(a),l=Math.ceil(e.position().left-s/2);if(l-o<0||!t&&l+n-o>i){return false}return true};C.prototype._moveVisibleTabs=function(){if(!this._oScroller){return}var e=this._oScroller.getScrollLeft(),t=this.$("head"),o=t.innerWidth()-t.width(),i=this.$().find(".sapMITBFilter:not(.sapMITBFilterHidden)").first(),r,s;if(!i.length){return}s=i.position().left-o/2;if(!this._bRtl&&s-e>2){r=e-s;t.css("transform","translate("+r+"px)")}else{t.css("transform","")}return true};C.prototype.onExit=function(){if(this._sResizeListenerNoFlexboxSupportId){f.deregister(this._sResizeListenerNoFlexboxSupportId);this._sResizeListenerNoFlexboxSupportId=null}};C.prototype.getFocusDomRef=function(e){var t=e||this.oSelectedItem;if(!t){return null}return t.getDomRef()};C.prototype.applyFocusInfo=function(t){if(t.focusDomRef){e(t.focusDomRef).focus()}};C.prototype.ontouchstart=function(t){var o=t.targetTouches[0];this._iActiveTouch=o.identifier;this._iTouchStartPageX=o.pageX;this._iTouchStartPageY=o.pageY;this._iTouchDragX=0;this._iTouchDragY=0;var i=e(t.target);if(i.hasClass("sapMITBArrowScroll")){t.preventDefault()}};C.prototype.ontouchmove=function(e){if(this._iActiveTouch===undefined){return}var t=m.find(e.changedTouches,this._iActiveTouch);if(!t||t.pageX===this._iTouchStartPageX){return}this._iTouchDragX+=Math.abs(this._iTouchStartPageX-t.pageX);this._iTouchDragY+=Math.abs(this._iTouchStartPageY-t.pageY);this._iTouchStartPageX=t.pageX;this._iTouchStartPageY=t.pageY};C.prototype.ontouchend=function(e){if(this._iActiveTouch===undefined){return}var t=p.system.desktop?5:15;if(this._scrollable&&this._iTouchDragX>t||this._iTouchDragY>t){return}var o=0;var i=1;var r;if(e.which===r||e.which===o||e.which===i){this._handleActivation(e)}this._iActiveTouch=undefined};C.prototype.ontouchcancel=C.prototype.ontouchend;C.prototype.onsapselect=function(e){this._handleActivation(e)};C.prototype._handleDragAndDrop=function(e){var t=e.getParameter("dropPosition"),o=e.getParameter("draggedControl"),i=e.getParameter("droppedControl"),r=o.getParent().getMetadata().getName()==="sap.m.IconTabBarSelectList";if(r){this._handleDragAndDropBetweenHeaderAndList(t,i,o)}else{d.handleDrop(this,t,o,i,false)}this._initItemNavigation();o.$().focus()};C.prototype._handleDragAndDropBetweenHeaderAndList=function(e,t,o){var i=this._getSelectList(),r=d.getDraggedDroppedItemsFromList(i.getAggregation("items"),o,t);if(!r){return}d.handleDrop(this,e,o._tabFilter,t,false);d.handleDrop(i,e,o,r.oDroppedControlFromList,false);i._initItemNavigation()};C.prototype._moveTab=function(e,t){var o=d.moveItem.call(this,e,t);this._initItemNavigation();if(o){this._scrollIntoView(e,0)}};C.prototype.ondragrearranging=function(e){if(!this.getEnableTabReordering()){return}var t=e.srcControl;this._moveTab(t,e.keyCode);t.$().focus()};C.prototype.onsaphomemodifiers=C.prototype.ondragrearranging;C.prototype.onsapendmodifiers=C.prototype.ondragrearranging;C.prototype.onsapincreasemodifiers=C.prototype.ondragrearranging;C.prototype.onsapdecreasemodifiers=C.prototype.ondragrearranging;return C});