/*!
 * UI development toolkit for HTML5 (OpenUI5)
 * (c) Copyright 2009-2018 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Control","sap/ui/base/ManagedObjectObserver","./PlanningCalendarRow","./library","sap/ui/unified/library","sap/ui/unified/calendar/CalendarUtils","sap/ui/unified/calendar/CalendarDate","sap/ui/unified/DateRange","sap/ui/unified/CalendarDateInterval","sap/ui/unified/CalendarWeekInterval","sap/ui/unified/CalendarOneMonthInterval","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/m/Select","sap/m/Button","sap/m/Toolbar","sap/m/Table","sap/m/Column","./PlanningCalendarRenderer","jquery.sap.events"],function(e,t,a,i,n,s,r,o,l,h,g,p,d,u,c,f,v,m,_,w,y){"use strict";var S=s.CalendarDayType;var D=n.ListMode;var C=n.ToolbarDesign;var I=n.ButtonType;var T=n.PlanningCalendarBuiltInView;var b=n.ScreenSize;var A=s.CalendarAppointmentVisualization;var k=s.GroupAppointmentsMode;var M=s.CalendarIntervalType;var R=t.extend("sap.m.PlanningCalendar",{metadata:{library:"sap.m",properties:{startDate:{type:"object",group:"Data"},viewKey:{type:"string",group:"Appearance",defaultValue:M.Hour},singleSelection:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},showIntervalHeaders:{type:"boolean",group:"Appearance",defaultValue:true},showEmptyIntervalHeaders:{type:"boolean",group:"Appearance",defaultValue:true},showRowHeaders:{type:"boolean",group:"Appearance",defaultValue:true},noDataText:{type:"string",group:"Misc",defaultValue:null},groupAppointmentsMode:{type:"sap.ui.unified.GroupAppointmentsMode",group:"Appearance",defaultValue:k.Collapsed},appointmentsReducedHeight:{type:"boolean",group:"Appearance",defaultValue:false},appointmentsVisualization:{type:"sap.ui.unified.CalendarAppointmentVisualization",group:"Appearance",defaultValue:A.Standard},minDate:{type:"object",group:"Misc",defaultValue:null},maxDate:{type:"object",group:"Misc",defaultValue:null},showDayNamesLine:{type:"boolean",group:"Appearance",defaultValue:false},showWeekNumbers:{type:"boolean",group:"Appearance",defaultValue:false},builtInViews:{type:"string[]",group:"Appearance",defaultValue:[]},stickyHeader:{type:"boolean",group:"Appearance",defaultValue:false}},aggregations:{rows:{type:"sap.m.PlanningCalendarRow",multiple:true,singularName:"row"},views:{type:"sap.m.PlanningCalendarView",multiple:true,singularName:"view"},specialDates:{type:"sap.ui.unified.DateTypeRange",multiple:true,singularName:"specialDate"},toolbarContent:{type:"sap.ui.core.Control",multiple:true,singularName:"toolbarContent"},table:{type:"sap.m.Table",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},legend:{type:"sap.ui.unified.CalendarLegend",multiple:false}},events:{appointmentSelect:{parameters:{appointment:{type:"sap.ui.unified.CalendarAppointment"},appointments:{type:"sap.ui.unified.CalendarAppointment[]"},multiSelect:{type:"boolean"},domRefId:{type:"string"}}},intervalSelect:{parameters:{startDate:{type:"object"},endDate:{type:"object"},subInterval:{type:"boolean"},row:{type:"sap.m.PlanningCalendarRow"}}},rowSelectionChange:{parameters:{rows:{type:"sap.m.PlanningCalendarRow[]"}}},startDateChange:{},viewChange:{},rowHeaderClick:{row:{type:"sap.m.PlanningCalendarRow"}}},designtime:"sap/m/designtime/PlanningCalendar.designtime"},constructor:function(e,a){t.prototype.constructor.apply(this,arguments);if(typeof e!=="string"){a=e}if(a&&typeof a.customAppointmentsSorterCallback==="function"){this._fnCustomSortedAppointments=a.customAppointmentsSorterCallback}}});var V=["_oTimeInterval","_oDateInterval","_oMonthInterval","_oWeekInterval","_oOneMonthInterval"],P={};P[M.Day]={sInstanceName:"_oDateInterval",sIdSuffix:"-DateInt",oClass:h};P[M.Week]={sInstanceName:"_oWeekInterval",sIdSuffix:"-WeekInt",oClass:g};P[M.OneMonth]={sInstanceName:"_oOneMonthInterval",sIdSuffix:"-OneMonthInt",oClass:p};var E=b.Desktop;var H=[T.Hour,T.Day,T.Month,T.Week,T.OneMonth];var N=t.extend("CalendarHeader",{metadata:{aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},allCheckBox:{type:"sap.m.CheckBox",multiple:false}}},renderer:function(e,t){e.write("<div");e.writeControlData(t);e.addClass("sapMPlanCalHead");e.writeClasses();e.write(">");var a=t.getToolbar();if(a){e.renderControl(a)}var i=t.getAllCheckBox();if(i){e.renderControl(i)}e.write("</div>")}});R.prototype.init=function(){this._iBreakPointTablet=d.media._predefinedRangeSets[d.media.RANGESETS.SAP_STANDARD_EXTENDED].points[0];this._iBreakPointDesktop=d.media._predefinedRangeSets[d.media.RANGESETS.SAP_STANDARD_EXTENDED].points[1];this._iBreakPointLargeDesktop=d.media._predefinedRangeSets[d.media.RANGESETS.SAP_STANDARD_EXTENDED].points[2];if(d.system.phone||e("html").hasClass("sapUiMedia-Std-Phone")){this._iSize=0;this._iSizeScreen=0}else if(d.system.tablet||e("html").hasClass("sapUiMedia-Std-Tablet")){this._iSize=1;this._iSizeScreen=1}else{this._iSize=2;this._iSizeScreen=2}this._oRB=sap.ui.getCore().getLibraryResourceBundle("sap.m");var t=this.getId();this._oIntervalTypeSelect=new f(t+"-IntType",{maxWidth:"15rem",ariaLabelledBy:t+"-SelDescr"});this._oIntervalTypeSelect.attachEvent("change",B,this);this._oTodayButton=new v(t+"-Today",{text:this._oRB.getText("PLANNINGCALENDAR_TODAY"),type:I.Transparent});this._oTodayButton.attachEvent("press",this._handleTodayPress,this);this._oHeaderToolbar=new m(t+"-HeaderToolbar",{design:C.Transparent,content:[this._oIntervalTypeSelect,this._oTodayButton]});this._oCalendarHeader=new N(t+"-CalHead",{toolbar:this._oHeaderToolbar});this._oInfoToolbar=new m(t+"-InfoToolbar",{height:"auto",design:C.Transparent,content:[this._oCalendarHeader,this._oTimeInterval]});var a=new _(t+"-Table",{sticky:[],infoToolbar:this._oInfoToolbar,mode:D.SingleSelectMaster,columns:[new w({styleClass:"sapMPlanCalRowHead"}),new w({width:"80%",styleClass:"sapMPlanCalAppRow",minScreenWidth:E,demandPopin:true})],ariaLabelledBy:t+"-Descr"});a.attachEvent("selectionChange",K,this);a.addDelegate({onBeforeRendering:function(){if(this._rowHeaderClickEvent){this._rowHeaderClickEvent.off()}},onAfterRendering:function(){this._rowHeaderClickEvent=a.$().find(".sapMPlanCalRowHead > div.sapMLIB").click(function(t){var a=e(t.currentTarget).control(0),i=sap.ui.getCore().byId(a.getAssociation("parentRow"));this.fireRowHeaderClick({row:i})}.bind(this))}},false,this);this.setAggregation("table",a,true);this.setStartDate(new Date);this._resizeProxy=e.proxy(W,this);this._fnCustomSortedAppointments=undefined};R.prototype.exit=function(){if(this._sResizeListener){u.deregister(this._sResizeListener);this._sResizeListener=undefined}d.orientation.detachHandler(this._updateStickyHeader,this);if(this._sUpdateCurrentTime){e.sap.clearDelayedCall(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}var t=this.getAggregation("table");t.removeAllItems();V.forEach(function(e){if(this[e]){this[e]._oPlanningCalendar=undefined;this[e].destroy();this[e]=undefined}},this);if(this._oViews){for(var a in this._oViews){this._oViews[a].destroy()}}if(this._oSelectAllCheckBox){this._oSelectAllCheckBox.destroy()}if(this.getToolbarContent().length==0&&this._oToolbar){this._oToolbar.destroy();this._oToolbar=undefined}if(this._rowHeaderClickEvent){this._rowHeaderClickEvent.off();this._rowHeaderClickEvent=null}};R.prototype.onBeforeRendering=function(){this._bBeforeRendering=true;if(!this._oTimeInterval&&!this._oDateInterval&&!this._oMonthInterval&&!this._oWeekInterval&&!this._oOneMonthInterval||this._bCheckView){this.setViewKey(this.getViewKey());this._bCheckView=undefined}F.call(this);if(this._sUpdateCurrentTime){e.sap.clearDelayedCall(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}this._updateTodayButtonState();d.orientation.detachHandler(this._updateStickyHeader,this);this._bBeforeRendering=undefined};R.prototype._updateTodayButtonState=function(){if(this._oTodayButton){this._oTodayButton.setEnabled(!this._dateMatchesVisibleRange(new Date,this.getViewKey()))}};R.prototype._dateMatchesVisibleRange=function(e,t){var a=this._getView(t,!this._bBeforeRendering);if(!a){return false}var i=a.getIntervalType(),n=P[i],s=n?this[n.sInstanceName]:null,r=false;if(s&&s._dateMatchesVisibleRange){r=s._dateMatchesVisibleRange(e)}return r};R.prototype.onAfterRendering=function(e){e.size={width:this.getDomRef().offsetWidth};W.call(this,e,true);if(!this._sResizeListener){this._sResizeListener=u.register(this,this._resizeProxy)}if(d.system.phone&&this.getStickyHeader()){d.orientation.attachHandler(this._updateStickyHeader,this)}this._updateCurrentTimeVisualization(false)};R.prototype.setStartDate=function(t){var a,i;if(!t){t=new Date}else{r._checkJSDateObject(t)}if(this.getViewKey()===T.Week){a=r.getFirstDateOfWeek(r._createUniversalUTCDate(t,undefined,true));t.setTime(r._createLocalDate(a,true).getTime())}if(this.getViewKey()===T.OneMonth){i=r.getFirstDateOfMonth(r._createUniversalUTCDate(t,undefined,true));t.setTime(r._createLocalDate(i,true).getTime())}if(e.sap.equal(t,this.getStartDate())){this._updateTodayButtonState();return this}var n=t.getFullYear();r._checkYearInValidRange(n);var s=this.getMinDate();if(s&&s.getTime()>t.getTime()){e.sap.log.warning("StartDate < minDate -> StartDate set to minDate",this);t=new Date(s.getTime())}else{var o=this.getMaxDate();if(o&&o.getTime()<t.getTime()){e.sap.log.warning("StartDate > maxDate -> StartDate set to minDate",this);if(s){t=new Date(s.getTime())}else{t=new Date(1,0,1);t.setFullYear(1)}}}this.setProperty("startDate",t,true);V.forEach(function(e){if(this[e]){this[e].setStartDate(new Date(t.getTime()))}},this);this._setRowsStartDate(new Date(t.getTime()));if(this.getViewKey()===T.Week||this.getViewKey()===T.OneMonth){this._updateTodayButtonState()}if(this.getDomRef()){this._updateCurrentTimeVisualization(false)}return this};R.prototype.setMinDate=function(t){if(e.sap.equal(t,this.getMinDate())){return this}var a=this.getMaxDate();if(t){r._checkJSDateObject(t);var i=t.getFullYear();r._checkYearInValidRange(i);this.setProperty("minDate",t,true);this._bNoStartDateChange=true;V.forEach(function(e){if(this[e]){this[e].setMinDate(new Date(t.getTime()))}},this);if(a&&a.getTime()<t.getTime()){e.sap.log.warning("minDate > maxDate -> maxDate set to end of the month",this);a=new Date(t.getTime());a.setMonth(a.getMonth()+1,0);a.setHours(23);a.setMinutes(59);a.setSeconds(59);a.setMilliseconds(0);this.setMaxDate(a)}this._bNoStartDateChange=undefined;var n=this.getStartDate();if(n&&n.getTime()<t.getTime()){e.sap.log.warning("StartDate < minDate -> StartDate set to minDate",this);n=new Date(t.getTime());this.setStartDate(n)}}else{this.setProperty("minDate",undefined,true);V.forEach(function(e){if(this[e]){this[e].setMinDate()}},this)}var s=new Date;if(t&&s.getTime()<t.getTime()){this._oTodayButton.setVisible(false)}else if(!a||s.getTime()<a.getTime()){this._oTodayButton.setVisible(true)}return this};R.prototype.setMaxDate=function(t){if(e.sap.equal(t,this.getMaxDate())){return this}var a=this.getMinDate();if(t){r._checkJSDateObject(t);var i=t.getFullYear();r._checkYearInValidRange(i);this.setProperty("maxDate",t,true);this._bNoStartDateChange=true;V.forEach(function(e){if(this[e]){this[e].setMaxDate(new Date(t.getTime()))}},this);if(a&&a.getTime()>t.getTime()){e.sap.log.warning("maxDate < minDate -> maxDate set to begin of the month",this);a=new Date(t.getTime());a.setDate(1);a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);this.setMinDate(a)}this._bNoStartDateChange=undefined;var n=this.getStartDate();if(n&&n.getTime()>t.getTime()){e.sap.log.warning("StartDate > maxDate -> StartDate set to minDate",this);if(a){n=new Date(a.getTime())}else{n=new Date(1,0,1);n.setFullYear(1)}this.setStartDate(n)}}else{this.setProperty("maxDate",undefined,true);V.forEach(function(e){if(this[e]){this[e].setMaxDate()}},this)}var s=new Date;if(t&&s.getTime()>t.getTime()){this._oTodayButton.setVisible(false)}else if(!a||s.getTime()>a.getTime()){this._oTodayButton.setVisible(true)}return this};R.prototype.setViewKey=function(e){var t,a,i,n=this.getViewKey(),s;this.setProperty("viewKey",e,true);this._oIntervalTypeSelect.setSelectedKey(e);if(this._oInfoToolbar.getContent().length>1){this._oInfoToolbar.removeContent(1)}if(e===T.Week||e===T.OneMonth){a=this.getStartDate();this.setStartDate(new Date(a.getTime()));if(a.getTime()!==this.getStartDate().getTime()){this.fireStartDateChange()}}var r=this.getStartDate();var l=this.getMinDate();var h=this.getMaxDate();var g=this._getView(e,!this._bBeforeRendering);if(!g){this._bCheckView=true;this.invalidate()}else{var p=g.getIntervalType();var d=this._getIntervals(g);this._bCheckView=false;switch(p){case M.Hour:if(!this._oTimeInterval){this._oTimeInterval=new sap.ui.unified.CalendarTimeInterval(this.getId()+"-TimeInt",{startDate:new Date(r.getTime()),items:d,pickerPopup:true,legend:this.getLegend()});this._oTimeInterval.attachEvent("startDateChange",this._handleStartDateChange,this);this._oTimeInterval.attachEvent("select",this._handleCalendarSelect,this);this._oTimeInterval._oPlanningCalendar=this;this._oTimeInterval.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()};if(l){this._oTimeInterval.setMinDate(new Date(l.getTime()))}if(h){this._oTimeInterval.setMaxDate(new Date(h.getTime()))}}else if(this._oTimeInterval.getItems()!=d){this._oTimeInterval.setItems(d)}this._oInfoToolbar.addContent(this._oTimeInterval);break;case M.Day:case M.Week:case M.OneMonth:i=P[p];t=this[i.sInstanceName];if(!t){t=new i.oClass(this.getId()+i.sIdSuffix,{startDate:new Date(r.getTime()),days:d,showDayNamesLine:this.getShowDayNamesLine(),pickerPopup:true,legend:this.getLegend(),showWeekNumbers:this.getShowWeekNumbers()});t.attachEvent("startDateChange",this._handleStartDateChange,this);t.attachEvent("select",this._handleCalendarSelect,this);if(e===T.OneMonth){t._setRowsStartDate=this._setRowsStartDate.bind(this)}t._oPlanningCalendar=this;t.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()};if(l){t.setMinDate(new Date(l.getTime()))}if(h){t.setMaxDate(new Date(h.getTime()))}}else if(t.getDays()!==d){t.setDays(d)}this._oInfoToolbar.addContent(t);this[i.sInstanceName]=t;break;case M.Month:if(!this._oMonthInterval){this._oMonthInterval=new sap.ui.unified.CalendarMonthInterval(this.getId()+"-MonthInt",{startDate:new Date(r.getTime()),months:d,pickerPopup:true,legend:this.getLegend()});this._oMonthInterval.attachEvent("startDateChange",this._handleStartDateChange,this);this._oMonthInterval.attachEvent("select",this._handleCalendarSelect,this);this._oMonthInterval._oPlanningCalendar=this;this._oMonthInterval.getSpecialDates=function(){return this._oPlanningCalendar.getSpecialDates()};if(l){this._oMonthInterval.setMinDate(new Date(l.getTime()))}if(h){this._oMonthInterval.setMaxDate(new Date(h.getTime()))}}else if(this._oMonthInterval.setMonths()!=d){this._oMonthInterval.setMonths(d)}this._oInfoToolbar.addContent(this._oMonthInterval);break;default:throw new Error("Unknown IntervalType: "+p+"; "+this)}var u=this.getRows();for(var c=0;c<u.length;c++){var f=u[c];var v=f.getCalendarRow();v.setIntervalType(p);v.setIntervals(d);v.setShowSubIntervals(g.getShowSubIntervals())}if(this.getDomRef()){this._updateCurrentTimeVisualization(false);L.call(this,this.getShowWeekNumbers(),this._viewAllowsWeekNumbers(e));O.call(this,this.getShowDayNamesLine(),!!t)}}if(this._oOneMonthInterval&&e===T.OneMonth){this._oOneMonthInterval._setDisplayMode(this._iSize);this._oOneMonthInterval._adjustSelectedDate(o.fromLocalJSDate(a));if(this._iSize<2){this._setRowsStartDate(a)}}else if(this._oOneMonthInterval&&n===T.OneMonth&&this._oOneMonthInterval.getSelectedDates().length){s=this._oOneMonthInterval.getSelectedDates()[0].getStartDate();if(s){this.setStartDate(s)}}this._updateTodayButtonState();return this};R.prototype._viewAllowsWeekNumbers=function(e){var t=this._getView(e).getIntervalType(),a=P[t];return!!a&&!!a.oClass.prototype.setShowWeekNumbers};R.prototype._viewAllowsDayNamesLine=function(e){var t=this._getView(e).getIntervalType(),a=P[t];return!!a&&!!a.oClass.prototype.setShowDayNamesLine};R.prototype._getIntervalInstanceByViewKey=function(e){var t=this._getView(e).getIntervalType(),a=P[t],i;if(a){i=this[a.sInstanceName]}return i};R.prototype.setShowWeekNumbers=function(e){this.setProperty("showWeekNumbers",e,true);this._getViews().forEach(function(t){var a=t.getKey(),i=this._viewAllowsWeekNumbers(a),n=this._getIntervalInstanceByViewKey(a);if(n&&i){this._getIntervalInstanceByViewKey(a).setShowWeekNumbers(e)}if(this.getDomRef()&&this.getViewKey()===a){L.call(this,e,i)}},this);return this};R.prototype.setShowIntervalHeaders=function(e){this.setProperty("showIntervalHeaders",e,true);var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];i.getCalendarRow().setShowIntervalHeaders(e)}return this};R.prototype.setShowEmptyIntervalHeaders=function(e){this.setProperty("showEmptyIntervalHeaders",e,true);var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];i.getCalendarRow().setShowEmptyIntervalHeaders(e)}return this};R.prototype.setGroupAppointmentsMode=function(e){this.setProperty("groupAppointmentsMode",e,true);var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];i.getCalendarRow().setGroupAppointmentsMode(e)}return this};R.prototype.setAppointmentsReducedHeight=function(e){this.setProperty("appointmentsReducedHeight",e,true);var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];i.getCalendarRow().setAppointmentsReducedHeight(e)}return this};R.prototype.setAppointmentsVisualization=function(e){this.setProperty("appointmentsVisualization",e,true);var t=this.getRows();for(var a=0;a<t.length;a++){var i=t[a];i.getCalendarRow().setAppointmentsVisualization(e)}return this};R.prototype.setShowRowHeaders=function(e){this.setProperty("showRowHeaders",e,true);var t=this.getAggregation("table");t.getColumns()[0].setVisible(e);this._toggleAppointmentsColumnPopinState(e);this.$().toggleClass("sapMPlanCalNoHead",!e);q.call(this);Q.call(this);return this};R.prototype.setShowDayNamesLine=function(e){var t,a,i,n=!!this.getDomRef(),s=this.getViewKey();for(t in P){a=P[t].sInstanceName;if(this[a]){i=this[a];i.setShowDayNamesLine(e);if(n&&t===s){O.call(this,e,true)}}}return this.setProperty("showDayNamesLine",e,false)};R.prototype.setStickyHeader=function(e){if(this.getStickyHeader()===e){return this}this.setProperty("stickyHeader",e,true);if(d.system.phone){if(e){d.orientation.attachHandler(this._updateStickyHeader,this)}else{d.orientation.detachHandler(this._updateStickyHeader,this)}}this._updateStickyHeader();return this};R.prototype._updateStickyHeader=function(){var e=[],t=this.getStickyHeader(),a=this.getViewKey()===T.OneMonth&&this._iSize<2,i=t&&!d.system.phone&&!a,n=t&&!(d.system.phone&&d.orientation.landscape)&&!a;if(this._oToolbar&&i){e.push(sap.m.Sticky.HeaderToolbar)}if(this._oInfoToolbar&&n){e.push(sap.m.Sticky.InfoToolbar)}this.getAggregation("table").setSticky(e)};R.prototype.addRow=function(e){this.addAggregation("rows",e,true);e.attachEvent("_change",X,this);var t=this.getAggregation("table");t.addItem(e.getColumnListItem());var a=e.getCalendarRow();a.setStartDate(this.getStartDate());a.setShowIntervalHeaders(this.getShowIntervalHeaders());a.setShowEmptyIntervalHeaders(this.getShowEmptyIntervalHeaders());a.setGroupAppointmentsMode(this.getGroupAppointmentsMode());a.setAppointmentsReducedHeight(this.getAppointmentsReducedHeight());a.setLegend(this.getLegend());a.setAppointmentsVisualization(this.getAppointmentsVisualization());a.attachEvent("select",z,this);a.attachEvent("startDateChange",this._handleStartDateChange,this);a.attachEvent("leaveRow",$,this);a.attachEvent("intervalSelect",x,this);J.call(this);if(Z.call(this)){var i=this.getViewKey();var n=this._getView(i);var s=n.getIntervalType();var r=this._getIntervals(n);a.setIntervalType(s);a.setIntervals(r);a.setShowSubIntervals(n.getShowSubIntervals())}Q.call(this);if(this._fnCustomSortedAppointments){a._setCustomAppointmentsSorterCallback(this._fnCustomSortedAppointments)}return this};R.prototype.insertRow=function(e,t){this.insertAggregation("rows",e,t);e.attachEvent("_change",X,this);var a=this.getAggregation("table");a.insertItem(e.getColumnListItem(),t,true);var i=e.getCalendarRow();i.setStartDate(this.getStartDate());i.setShowIntervalHeaders(this.getShowIntervalHeaders());i.setShowEmptyIntervalHeaders(this.getShowEmptyIntervalHeaders());i.setGroupAppointmentsMode(this.getGroupAppointmentsMode());i.setAppointmentsReducedHeight(this.getAppointmentsReducedHeight());i.setLegend(this.getLegend());i.setAppointmentsVisualization(this.getAppointmentsVisualization());i.attachEvent("select",z,this);i.attachEvent("startDateChange",this._handleStartDateChange,this);i.attachEvent("leaveRow",$,this);i.attachEvent("intervalSelect",x,this);if(this._fnCustomSortedAppointments){i._setCustomAppointmentsSorterCallback(this._fnCustomSortedAppointments)}J.call(this);if(Z.call(this)){var n=this.getViewKey();var s=this._getView(n);var r=s.getIntervalType();var o=this._getIntervals(s);i.setIntervalType(r);i.setIntervals(o);i.setShowSubIntervals(s.getShowSubIntervals())}Q.call(this);return this};R.prototype.removeRow=function(e){var t=this.removeAggregation("rows",e,true);t.detachEvent("_change",X,this);var a=this.getAggregation("table");a.removeItem(t.getColumnListItem(),true);var i=t.getCalendarRow();i.detachEvent("select",z,this);i.detachEvent("startDateChange",this._handleStartDateChange,this);i.detachEvent("leaveRow",$,this);i.detachEvent("intervalSelect",x,this);if(this._fnCustomSortedAppointments){i._fnCustomSortedAppointments=undefined}J.call(this);Q.call(this);return t};R.prototype.removeAllRows=function(){var e=this.removeAllAggregation("rows",true);var t=this.getAggregation("table");t.removeAllItems(true);for(var a=0;a<e.length;a++){var i=e[a];i.detachEvent("_change",X,this);var n=i.getCalendarRow();n.detachEvent("select",z,this);n.detachEvent("startDateChange",this._handleStartDateChange,this);n.detachEvent("leaveRow",$,this);n.detachEvent("intervalSelect",x,this);if(this._fnCustomSortedAppointments){n._fnCustomSortedAppointments=undefined}}J.call(this);Q.call(this);return e};R.prototype.destroyRows=function(){var e=this.destroyAggregation("rows",true);var t=this.getAggregation("table");t.destroyItems(true);J.call(this);Q.call(this);return e};R.prototype.addToolbarContent=function(e){this.addAggregation("toolbarContent",e,true);U.call(this);return this};R.prototype.insertToolbarContent=function(e,t){this.insertAggregation("toolbarContent",e,t);U.call(this);return this};R.prototype.removeToolbarContent=function(e){var t=this.removeAggregation("toolbarContent",e,true);U.call(this);return t};R.prototype.removeAllToolbarContent=function(){var e=this.removeAllAggregation("toolbarContent",true);U.call(this);return e};R.prototype.destroyToolbarContent=function(){var e=this.destroyAggregation("toolbarContent",true);U.call(this);return e};R.prototype.indexOfContent=function(e){return this.indexOfToolbarContent(e)};R.prototype.setSingleSelection=function(e){this.setProperty("singleSelection",e,true);q.call(this);Q.call(this);if(e){this.selectAllRows(false)}else{J.call(this)}this.$().toggleClass("sapMPlanCalMultiSel",!e);return this};R.prototype.setNoDataText=function(e){this.setProperty("noDataText",e,true);var t=this.getAggregation("table");t.setNoDataText(e);return this};R.prototype.setLegend=function(e){this.setAssociation("legend",e,true);var t=this.getRows(),i=this.getLegend()&&sap.ui.getCore().byId(this.getLegend()),n;for(var s=0;s<t.length;s++){var r=t[s];r.getCalendarRow().setLegend(e)}V.forEach(function(t){if(this[t]){this[t].setLegend(e)}},this);if(i){n=new a(function(e){this.invalidate()}.bind(this));n.observe(i,{destroy:true})}return this};R.prototype.addAriaLabelledBy=function(e){this.addAssociation("ariaLabelledBy",e,true);var t=this.getAggregation("table");t.addAriaLabelledBy(e);return this};R.prototype.removeAriaLabelledBy=function(e){this.removeAssociation("ariaLabelledBy",e,true);var t=this.getAggregation("table");t.removeAriaLabelledBy(e);return this};R.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);var e=this.getAggregation("table");e.removeAllAriaLabelledBy();e.addAriaLabelledBy(this.getId()+"-Descr");return this};R.prototype.invalidate=function(e){var a=e&&e instanceof l;if(!this._bIsBeingDestroyed&&(this._bDateRangeChanged||a)){if(this.getDomRef()){var i=this.getViewKey();var n=this._getView(i);var s=n.getIntervalType();switch(s){case M.Hour:if(this._oTimeInterval){this._oTimeInterval.invalidate(arguments)}break;case M.Day:if(this._oDateInterval){this._oDateInterval.invalidate(arguments)}break;case M.Month:if(this._oMonthInterval){this._oMonthInterval.invalidate(arguments)}break;case M.OneMonth:if(this._oOneMonthInterval){this._oOneMonthInterval.invalidate(arguments)}break;case M.Week:if(this._oWeekInterval){this._oWeekInterval.invalidate(arguments)}break;default:throw new Error("Unknown IntervalType: "+s+"; "+this)}}this._bDateRangeChanged=undefined}else{if(e&&e instanceof sap.m.PlanningCalendarView){this._bCheckView=true}t.prototype.invalidate.apply(this,arguments)}};R.prototype.addSpecialDate=function(e){this._bDateRangeChanged=true;if(e.getType()===S.NonWorking){this.getAggregation("rows").forEach(function(t){t.addAggregation("_nonWorkingDates",this._buildPCRowDateRange(e))},this)}return t.prototype.addAggregation.call(this,"specialDates",e)};R.prototype.insertSpecialDate=function(e,a){this._bDateRangeChanged=true;if(e.getType()===S.NonWorking){this.getAggregation("rows").forEach(function(t){t.insertAggregation("_nonWorkingDates",this._buildPCRowDateRange(e),a)},this)}return t.prototype.insertAggregation.call(this,"specialDates",e,a)};R.prototype.removeSpecialDate=function(a){var n;if(typeof a==="string"){a=sap.ui.getCore().byId(a)}this._bDateRangeChanged=true;if(a&&a.getType()===S.NonWorking){this.getAggregation("rows").forEach(function(t){if(t.getAggregation("_nonWorkingDates")){n=t.getAggregation("_nonWorkingDates").filter(function(e){return e.data(i.PC_FOREIGN_KEY_NAME)===a.getId()});if(n.length){e.sap.assert(n.length==1,"Inconsistency between PlanningCalendar "+"special date instance and PlanningCalendar nonWorkingDates instance. For PC instance "+"there are more than one("+n.length+") nonWorkingDates in PlanningCalendarRow ");t.removeAggregation("_nonWorkingDates",n[0])}}})}return t.prototype.removeAggregation.call(this,"specialDates",a)};R.prototype.removeAllSpecialDates=function(){this._bDateRangeChanged=true;if(this.getAggregation("rows")){this.getAggregation("rows").forEach(function(e){e.removeAllAggregation("_nonWorkingDates")})}return this.removeAllAggregation("specialDates")};R.prototype.destroySpecialDates=function(){this._bDateRangeChanged=true;this.getAggregation("rows").forEach(function(e){e.destroyAggregation("_nonWorkingDates")});return this.destroyAggregation("specialDates")};R.prototype.removeAllViews=function(){this._bCheckView=true;var e=this.removeAllAggregation("views"),t=this.getBuiltInViews();if(t.length){this.setViewKey(t[0])}else{this.setViewKey(H[0])}return e};R.prototype.destroyViews=function(){this._bCheckView=true;var e=this.destroyAggregation("views"),t=this.getBuiltInViews();if(t.length){this.setViewKey(t[0])}else{this.setViewKey(H[0])}return e};R.prototype.getSelectedRows=function(){return this.getRows().filter(function(e){return e.getSelected()})};R.prototype.selectAllRows=function(e){var t=this.getRows();if(!(e&&this.getSingleSelection())){for(var a=0;a<t.length;a++){var i=t[a];i.setSelected(e)}if(this._oSelectAllCheckBox){this._oSelectAllCheckBox.setSelected(e)}}return this};R.prototype.onsaphomemodifiers=function(t){if((t.metaKey||t.ctrlKey)&&!t.altKey&&!t.shiftKey){var a=this.getRows();var i=a[0];var n=new e.Event("saphome");n._bPlanningCalendar=true;i.getCalendarRow().onsaphome(n);t.preventDefault();t.stopPropagation()}};R.prototype.onsapendmodifiers=function(t){if((t.metaKey||t.ctrlKey)&&!t.altKey&&!t.shiftKey){var a=this.getRows();var i=a[a.length-1];var n=new e.Event("sapend");n._bPlanningCalendar=true;i.getCalendarRow().onsapend(n);t.preventDefault();t.stopPropagation()}};R.prototype.setBuiltInViews=function(e){this.setProperty("builtInViews",e);this.setViewKey(this._getViews()[0].getKey());return this};R.prototype.removeView=function(e){var t=this.removeAggregation("views",e);if(!this.getViews().length){this.setViewKey(this._getViews()[0].getKey())}return t};R.prototype._getIntervals=function(e){var t=0;switch(this._iSize){case 0:t=e.getIntervalsS();break;case 1:t=e.getIntervalsM();break;default:t=e.getIntervalsL();break}return t};R.prototype._getView=function(e,t){var a=this._getViews();var i;for(var n=0;n<a.length;n++){i=a[n];if(i.getKey()!=e){i=undefined}else{break}}if(!i&&!t){throw new Error("PlanningCalendarView with key "+e+"not assigned "+this)}return i};R.prototype._changeStartDate=function(e){if(this._bNoStartDateChange){return}this.setStartDate(new Date(e.getTime()));this.fireStartDateChange()};R.prototype._updateCurrentTimeVisualization=function(t){if(this._sUpdateCurrentTime){e.sap.clearDelayedCall(this._sUpdateCurrentTime);this._sUpdateCurrentTime=undefined}if(t){var a=this.getRows();for(var i=0;i<a.length;i++){var n=a[i];n.getCalendarRow().updateCurrentTimeVisualization()}}var s=new Date;var r=this.getStartDate();var o=this.getViewKey();var l=this._getView(o);var h=l.getIntervalType();var g=this._getIntervals(l);var p=0;var d=0;var u=0;switch(h){case M.Hour:p=6e4;d=r.getTime()-36e5;u=r.getTime()+g*36e5;break;case M.Day:case M.Week:case M.OneMonth:p=18e5;d=r.getTime()-36e5;u=r.getTime()+g*864e5;break;default:p=-1;break}if(s.getTime()<=u&&s.getTime()>=d&&p>0){this._sUpdateCurrentTime=e.sap.delayedCall(p,this,"_updateCurrentTimeVisualization",[true])}};function B(e){this.setViewKey(e.getParameter("selectedItem").getKey());this.fireViewChange()}R.prototype._handleTodayPress=function(e){var t=new Date,a,i=this.getViewKey();if(i===T.OneMonth){a=r.getFirstDateOfMonth(r._createUniversalUTCDate(t,undefined,true));this._oOneMonthInterval._adjustSelectedDate(o.fromLocalJSDate(t),false);t=r._createLocalDate(a,true)}if(i===T.Week){a=this.getStartDate();t.setHours(a.getHours());t.setMinutes(a.getMinutes());t.setSeconds(a.getSeconds())}this.setStartDate(t);this.fireStartDateChange()};R.prototype._handleStartDateChange=function(e){var t=e.oSource.getStartDate();this._changeStartDate(t)};R.prototype._handleCalendarSelect=function(e){var t=e.oSource.getSelectedDates();var a=new Date(t[0].getStartDate());var i=r._createUniversalUTCDate(a,undefined,true);var n=this.getViewKey();var s=this._getView(n);var l=s.getIntervalType();if(l!==M.OneMonth||this._iSize>1){t[0].setStartDate()}switch(l){case M.Hour:i.setUTCHours(i.getUTCHours()+1);break;case M.Day:case M.Week:i.setUTCDate(i.getUTCDate()+1);break;case M.OneMonth:if(this._iSize<2){var h=new Date(a.getTime());if(r.monthsDiffer(this.getStartDate(),a)){this.setStartDate(a)}this._setRowsStartDate(h);this._oOneMonthInterval.getAggregation("month")[0]._focusDate(o.fromLocalJSDate(h),true)}else if(r._isNextMonth(a,this.getStartDate())){this._oOneMonthInterval._handleNext();return}i.setUTCDate(i.getUTCDate()+1);break;case M.Month:i.setUTCMonth(i.getUTCMonth()+1);break;default:throw new Error("Unknown IntervalType: "+l+"; "+this)}i.setUTCMilliseconds(i.getUTCMilliseconds()-1);i=r._createLocalDate(i,true);this.fireIntervalSelect({startDate:a,endDate:i,subInterval:false,row:undefined})};R.prototype._buildPCRowDateRange=function(e){var t=new l;if(e.getStartDate()){t.setStartDate(new Date(e.getStartDate().getTime()))}if(e.getEndDate()){t.setEndDate(new Date(e.getEndDate().getTime()))}t.data(i.PC_FOREIGN_KEY_NAME,e.getId());return t};function x(e){var t=e.getParameter("startDate");var a=this.getViewKey();var i=this._getView(a);var n=i.getIntervalType();if(n===M.OneMonth&&r._isNextMonth(t,this.getStartDate())){this._oOneMonthInterval._handleNext();return}var s=e.getParameter("endDate");var o=e.getParameter("subInterval");var l=e.oSource._oPlanningCalendarRow;this.fireIntervalSelect({startDate:t,endDate:s,subInterval:o,row:l})}R.prototype._applyContextualSettings=function(){return t.prototype._applyContextualSettings.call(this,{contextualWidth:this.$().width()})};function L(e,t){this.$().toggleClass("sapMPlanCalWithWeekNumbers",e&&t)}function O(e,t){this.$().toggleClass("sapMPlanCalWithDayNamesLine",e&&t)}function W(e,t){this._applyContextualSettings();if(e.size.width<=0){return}var a=this.getRows();var i;var n=0;var s=this._iSize;G.call(this,e.size.width);if(s!=this._iSize){j.call(this,this._iSize);var r=this.getViewKey();var o=this._getView(r);var l=o.getIntervalType();var h=this._getIntervals(o);for(n=0;n<a.length;n++){i=a[n];var g=i.getCalendarRow();if(h!=g.getIntervals()){g.setIntervals(h)}else{g.handleResize()}}switch(l){case M.Hour:if(this._oTimeInterval&&this._oTimeInterval.getItems()!=h){this._oTimeInterval.setItems(h)}break;case M.Day:if(this._oDateInterval&&this._oDateInterval.getDays()!=h){this._oDateInterval.setDays(h)}break;case M.Month:if(this._oMonthInterval&&this._oMonthInterval.getMonths()!=h){this._oMonthInterval.setMonths(h)}break;case M.Week:if(this._oWeekInterval&&this._oWeekInterval.getDays()!=h){this._oWeekInterval.setDays(h)}break;case M.OneMonth:if(this._oOneMonthInterval&&this._oOneMonthInterval.getDays()!=h){this._oOneMonthInterval.setDays(h);if(this._iSize>1){this._setRowsStartDate(new Date(this.getStartDate().getTime()))}}break;default:throw new Error("Unknown IntervalType: "+l+"; "+this)}q.call(this)}else if(!t){for(n=0;n<a.length;n++){i=a[n];i.getCalendarRow().handleResize()}}if(this._oOneMonthInterval){this._oOneMonthInterval._setDisplayMode(this._iSize)}if(this.getStickyHeader()){this._updateStickyHeader()}}function z(e){var t=e.getParameter("appointment"),a=e.getParameter("multiSelect"),i=e.getParameter("appointments"),n=e.getParameter("domRefId"),s,r,o,l,h,g,p,d;if(!a){r=this.getRows();for(p=0;p<r.length;p++){o=r[p];l=o.getCalendarRow();if(e.oSource!=l){h=o.getAppointments();for(d=0;d<h.length;d++){g=h[d];g.setSelected(false)}}}}s={appointment:t,appointments:i,multiSelect:a,domRefId:n};this.fireAppointmentSelect(s)}R.prototype._setRowsStartDate=function(e){var t=this.getRows(),a,i;for(i=0;i<t.length;i++){a=t[i];a.getCalendarRow().setStartDate(e)}};R.prototype._toggleAppointmentsColumnPopinState=function(e){var t=this.getAggregation("table"),a=t.getColumns()[1];a.setDemandPopin(e);a.setMinScreenWidth(e?E:"")};R.prototype._getViews=function(){var t=this.getViews(),a=this.getBuiltInViews(),i,n=[],s=T,r=M;if(!this._oViews){this._oViews={}}if(a.length){n=a}else{n=t.length?[]:H}i=n.map(function(t){switch(t){case s.Hour:return this._oViews[s.Hour]||(this._oViews[s.Hour]=new sap.m.PlanningCalendarView(this.getId()+"-HourView",{key:s.Hour,intervalType:r.Hour,description:this._oRB.getText("PLANNINGCALENDAR_HOURS"),intervalsS:6,intervalsM:6,intervalsL:12}));case s.Day:return this._oViews[s.Day]||(this._oViews[s.Day]=new sap.m.PlanningCalendarView(this.getId()+"-DayView",{key:s.Day,intervalType:r.Day,description:this._oRB.getText("PLANNINGCALENDAR_DAYS"),intervalsS:7,intervalsM:7,intervalsL:14}));case s.Month:return this._oViews[s.Month]||(this._oViews[s.Month]=new sap.m.PlanningCalendarView(this.getId()+"-MonthView",{key:s.Month,intervalType:r.Month,description:this._oRB.getText("PLANNINGCALENDAR_MONTHS"),intervalsS:3,intervalsM:6,intervalsL:12}));case s.Week:return this._oViews[s.Week]||(this._oViews[s.Week]=new sap.m.PlanningCalendarView(this.getId()+"-WeekView",{key:s.Week,intervalType:r.Week,description:this._oRB.getText("PLANNINGCALENDAR_WEEK"),intervalsS:7,intervalsM:7,intervalsL:7}));case s.OneMonth:return this._oViews[s.OneMonth]||(this._oViews[s.OneMonth]=new sap.m.PlanningCalendarView(this.getId()+"-OneMonthView",{key:s.OneMonth,intervalType:r.OneMonth,description:this._oRB.getText("PLANNINGCALENDAR_ONE_MONTH"),intervalsS:1,intervalsM:1,intervalsL:31}));default:e.sap.log.error("Cannot get PlanningCalendar views. Invalid view key "+t);break}},this);for(var o in this._oViews){if(n.indexOf(o)<0){this._oViews[o].destroy();delete this._oViews[o]}}if(t.length){i=i.concat(t)}return i};R.prototype.getSelectedAppointments=function(){var e=[];this.getRows().filter(function(t){e.push.apply(e,t.getCalendarRow().aSelectedAppointments)});return e};R.prototype.setCustomAppointmentsSorterCallback=function(t){if(typeof t==="function"||t===null||t===undefined){this.getRows().forEach(function(e){var a=e.getCalendarRow();a._setCustomAppointmentsSorterCallback(t)});this._fnCustomSortedAppointments=t}else{e.sap.log.warning("Your custom sort function won't be used, but the old one will be preserved.",this)}return this};R.prototype.getCustomAppointmentsSorterCallback=function(){return this._fnCustomSortedAppointments};R.prototype._onRowDeselectAppointment=function(){var e=this.getRows();for(var t=0;t<e.length;t++){var a=e[t].getCalendarRow().aSelectedAppointments;for(var i=0;i<a.length;i++){var n=sap.ui.getCore().byId(a[i]);if(n){n.setProperty("selected",false,true);n.$().removeClass("sapUiCalendarAppSel")}}e[t].getCalendarRow().aSelectedAppointments=[]}};function K(e){var t=[];var a=this.getRows();for(var i=0;i<a.length;i++){var n=a[i];var s=n.getColumnListItem();var r=s.getSelected();if(n.getSelected()!=r){n.setProperty("selected",r,true);t.push(n)}}if(!this.getSingleSelection()){J.call(this)}if(t.length>0){this.fireRowSelectionChange({rows:t})}}function U(){var e=this.getAggregation("table");if(this.getToolbarContent().length>0){if(!this._oToolbar){this._oToolbar=new sap.m.OverflowToolbar(this.getId()+"-Toolbar",{design:C.Transpaent});this._oToolbar._oPlanningCalendar=this;this._oToolbar.getContent=function(){return this._oPlanningCalendar.getToolbarContent()}}if(!e.getHeaderToolbar()){e.setHeaderToolbar(this._oToolbar)}}else if(e.getHeaderToolbar()){e.setHeaderToolbar()}this._oToolbar.invalidate()}function G(t){if(t<this._iBreakPointTablet){this._iSize=0}else if(t<this._iBreakPointDesktop){this._iSize=1}else{this._iSize=2}if(e("html").hasClass("sapUiMedia-Std-Phone")){this._iSizeScreen=0}else if(e("html").hasClass("sapUiMedia-Std-Tablet")){this._iSizeScreen=1}else{this._iSizeScreen=2}}function j(e){var t="sapMSize"+e,a=this.$(),i,n;if(a){for(i=0;i<3;i++){n="sapMSize"+i;if(n===t){a.addClass(n)}else{a.removeClass(n)}}}}function F(){var e=this._getViews();this._oIntervalTypeSelect.destroyItems();var t;var a;for(t=0;t<e.length;t++){var i=e[t];a=new c(this.getId()+"-"+t,{key:i.getKey(),text:i.getDescription(),tooltip:i.getTooltip()});this._oIntervalTypeSelect.addItem(a)}this._oIntervalTypeSelect.setVisible(!(e.length===1))}function Y(e){var t=e.getParameter("selected");var a=this.getRows();if(t){a=this.getRows().filter(function(e){return!e.getSelected()})}this.selectAllRows(t);this.fireRowSelectionChange({rows:a})}function $(t){var a=t.oSource;var i=t.getParameter("type");var n=this.getRows();var s;var r;var o;var l;var h=0;var g=0;var p;for(h=0;h<n.length;h++){s=n[h];if(s.getCalendarRow()==a){g=h;break}}switch(i){case"sapup":o=a.getFocusedAppointment();l=o.getStartDate();if(g>0){g--}r=n[g];r.getCalendarRow().focusNearestAppointment(l);break;case"sapdown":o=a.getFocusedAppointment();l=o.getStartDate();if(g<n.length-1){g++}r=n[g];r.getCalendarRow().focusNearestAppointment(l);break;case"saphome":if(g>0){r=n[0];p=new e.Event(i);p._bPlanningCalendar=true;r.getCalendarRow().onsaphome(p)}break;case"sapend":if(g<n.length-1){r=n[n.length-1];p=new e.Event(i);p._bPlanningCalendar=true;r.getCalendarRow().onsapend(p)}break;default:break}}function J(){if(this._oSelectAllCheckBox){var e=this.getRows();var t=this.getSelectedRows();if(e.length==t.length&&t.length>0){this._oSelectAllCheckBox.setSelected(true)}else{this._oSelectAllCheckBox.setSelected(false)}}}function q(){if(this.getSingleSelection()){if(this._oCalendarHeader.getAllCheckBox()){this._oCalendarHeader.setAllCheckBox()}else if(this._oInfoToolbar.getContent().length>2){this._oInfoToolbar.removeContent(this._oSelectAllCheckBox)}}else{if(!this._oSelectAllCheckBox){this._oSelectAllCheckBox=new sap.m.CheckBox(this.getId()+"-All",{text:this._oRB.getText("COLUMNSPANEL_SELECT_ALL")});this._oSelectAllCheckBox.attachEvent("select",Y,this)}if(this._iSizeScreen<2||!this.getShowRowHeaders()){var e=this._oInfoToolbar.indexOfContent(this._oSelectAllCheckBox);if(this._iSizeScreen<2){if(e<this._oInfoToolbar.getContent().length-1){this._oInfoToolbar.addContent(this._oSelectAllCheckBox)}}else if(e<0||e>1){if(e>1){this._oInfoToolbar.removeContent(this._oSelectAllCheckBox)}this._oInfoToolbar.insertContent(this._oSelectAllCheckBox,1)}}else{this._oCalendarHeader.setAllCheckBox(this._oSelectAllCheckBox)}}}function X(e){if(e.getParameter("name")=="selected"){J.call(this)}}function Q(){var e=this.getAggregation("table");var t=e.getMode();var a;if(this.getSingleSelection()){if(!this.getShowRowHeaders()&&this.getRows().length==1){a=D.None}else{a=D.SingleSelectMaster}}else{a=D.MultiSelect}if(t!=a){e.setMode(a)}}function Z(){return this._oTimeInterval||this._oDateInterval||this._oMonthInterval||this._oWeekInterval||this._oOneMonthInterval}return R});